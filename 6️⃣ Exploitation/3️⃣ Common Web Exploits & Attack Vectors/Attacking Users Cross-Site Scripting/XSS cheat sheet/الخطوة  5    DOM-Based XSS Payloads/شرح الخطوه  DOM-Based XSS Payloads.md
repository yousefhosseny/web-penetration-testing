بناءً على طلبك لشرح **الحقن المعتمدة على DOM-Based XSS (DOM-Based XSS Payloads)** باستخدام نفس طريقة الشرح المقدمة (التي تتضمن أقسامًا مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا لهذه الخطوة في اختبار ثغرات Cross-Site Scripting (XSS). سأغطي جميع المحاولات الممكنة لاستغلال ثغرات DOM-Based XSS، مع التركيز على التلاعب بكائنات DOM (Document Object Model) ومصادر الإدخال الخطرة (مثل `location.hash`، `document.location`)، وتقسيمها إلى فئات (مثل الحقن عبر URL، الحقن عبر السمات، والحقن عبر دوال JavaScript). سيتم تضمين المحتوى في علامة `<xaiArtifact>` كما هو مطلوب، مع معرف جديد لأن هذا طلب مستقل يركز على خطوة محددة. سأحافظ على الشرح باللغة العربية بأسلوب واضح ومنظم، متجنبًا تنسيق Markdown خارج العلامة بناءً على طلبك السابق.

---

## فهم الخطوة: الحقن المعتمدة على DOM-Based XSS (DOM-Based XSS Payloads)

### ما المقصود؟
الحقن المعتمدة على DOM-Based XSS هي شيفرات JavaScript تُستخدم لاستغلال ثغرات Cross-Site Scripting التي تحدث داخل Document Object Model (DOM) للصفحة، دون الحاجة إلى تفاعل مع الخادم. على عكس XSS المنعكس أو المخزن، لا تعتمد هذه الثغرات على إرسال الإدخال إلى الخادم، بل على معالجة الإدخال مباشرة في المتصفح عبر JavaScript (مثل قراءة `location.hash` أو `document.location` واستخدامها في DOM). تُستهدف مصادر إدخال مثل معلمات URL، الهاش (#)، أو بيانات العميل لتنفيذ شيفرات JavaScript ضارة.

### لماذا يعمل؟
- **معالجة العميل**: التطبيقات التي تستخدم JavaScript لمعالجة الإدخالات (مثل `location.search`، `document.referrer`) دون تنظيفها تكون عرضة للتلاعب.
- **مرونة DOM**: يسمح DOM بالتعديل الديناميكي للصفحة (مثل كتابة نصوص عبر `innerHTML` أو تشغيل شيفرة عبر `eval`)، مما يتيح تنفيذ JavaScript من مصادر غير موثوقة.
- **ضعف الفلاتر**: فلاتر الخادم لا تؤثر على DOM-Based XSS لأن الثغرة تحدث في المتصفح، والعديد من المطورين يتجاهلون تنظيف إدخالات العميل.
- **مصادر إدخال خطرة**: مصادر مثل `location.hash`، `document.location`، أو `window.name` تُستخدم غالبًا دون التحقق، مما يسمح بحقن شيفرات JavaScript.
- **استجابات واضحة**: الحقن تُنتج استجابات ملحوظة (مثل تنبيهات، تسجيلات في وحدة التحكم، أو تغييرات بصرية)، مما يؤكد وجود الثغرة.

### كيف يتم الاستغلال؟
- يتم التلاعب بمصادر إدخال العميل (مثل إضافة شيفرة JavaScript إلى `location.hash` أو `location.search`) التي تُستخدم مباشرة في DOM.
- تُستخدم دوال أو خصائص JavaScript خطرة (مثل `innerHTML`، `eval`، `document.write`) لتنفيذ الشيفرة.
- يتم مراقبة استجابة التطبيق في المتصفح لتأكيد التنفيذ:
  - **نجاح (True)**: ظهور تنبيه، تسجيل رسالة في وحدة التحكم، تغيير عنوان الصفحة، أو تغيير بصري.
  - **فشل (False)**: لا يحدث شيء أو عدم ظهور الشيفرة في DOM.
- تُكيَّف الحقن بناءً على المصدر (مثل URL أو سمات العنصر) والدالة المستخدمة (مثل `eval` أو `setTimeout`).

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يعتمد على JavaScript لمعالجة معلمات URL أو الهاش (#). على سبيل المثال، الموقع يأخذ قيمة من `location.hash` (مثل `example.com/#input`) ويستخدمها لتحديث محتوى الصفحة عبر `innerHTML`. حاولت إدخال حقنة مثل `example.com/#<script>alert('XSS')</script>`، لكنها فشلت لأن الوسم تم تصفيته. لاحظت أن إدخال شيفرة مثل `example.com/#javascript:alert('XSS')` أو `example.com/#" onload="alert(1)` يُنتج استجابات مختلفة، مما يشير إلى وجود ثغرة DOM-Based XSS. الآن، تريد استخدام حقن تستهدف DOM لتأكيد الثغرة عن طريق تنفيذ JavaScript عبر مصادر إدخال العميل.

---
