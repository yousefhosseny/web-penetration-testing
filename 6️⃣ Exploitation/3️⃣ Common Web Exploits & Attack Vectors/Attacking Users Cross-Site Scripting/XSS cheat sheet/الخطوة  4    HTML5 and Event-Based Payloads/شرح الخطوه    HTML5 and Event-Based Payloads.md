بناءً على طلبك لشرح **الحقن المعتمدة على HTML5 والأحداث (HTML5 and Event-Based Payloads)** باستخدام نفس طريقة الشرح المقدمة (التي تتضمن أقسامًا مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا لهذه الخطوة في اختبار ثغرات Cross-Site Scripting (XSS). سأغطي جميع المحاولات الممكنة لاستخدام وسوم HTML5 وسمات الأحداث لتنفيذ شيفرات JavaScript، مع تقسيمها إلى فئات (مثل وسوم HTML5، الأحداث التفاعلية، وأحداث الوسائط). سيتم تضمين المحتوى في علامة `<xaiArtifact>` كما هو مطلوب، مع معرف جديد لأن هذا طلب مستقل يركز على خطوة محددة. سأحافظ على الشرح باللغة العربية بأسلوب واضح ومنظم، متجنبًا تنسيق Markdown خارج العلامة بناءً على طلبك السابق.

---

## فهم الخطوة: الحقن المعتمدة على HTML5 والأحداث (HTML5 and Event-Based Payloads)

### ما المقصود؟
الحقن المعتمدة على HTML5 والأحداث هي شيفرات Cross-Site Scripting (XSS) تستغل وسوم HTML5 (مثل `<svg>`، `<video>`، `<details>`) وسمات الأحداث (مثل `onload`، `onerror`، `onclick`) لتنفيذ JavaScript في متصفح المستخدم. تُستخدم هذه الحقن عندما تحظر فلاتر الحماية الوسوم التقليدية (مثل `<script>`) أو تتطلب التطبيقات سياقات تفاعلية (مثل النقر أو تحميل عنصر). تهدف إلى تأكيد وجود ثغرة XSS عن طريق تنفيذ شيفرات بسيطة أو معقدة في سياقات **XSS المنعكس**، **XSS المخزن**، أو **XSS القائم على DOM**.

### لماذا يعمل؟
- **دعم HTML5**: المتصفحات الحديثة تدعم مجموعة واسعة من وسوم HTML5 (مثل `<svg>`، `<video>`، `<canvas>`) التي تسمح بتنفيذ JavaScript عبر الأحداث.
- **تنوع الأحداث**: سمات الأحداث مثل `onload`، `onerror`، `onclick`، و`onmouseover` توفر طرقًا متعددة لتشغيل JavaScript استجابةً لتفاعلات المستخدم أو أخطاء التحميل.
- **ضعف الفلاتر**: العديد من فلاتر الحماية تركز على حظر `<script>` أو دوال مثل `alert`، لكنها تتجاهل وسوم HTML5 أو أحداث غير شائعة (مثل `ontoggle` أو `onloadstart`).
- **تفسير المتصفح**: المتصفحات تُنفذ شيفرات JavaScript المضمنة في سمات الأحداث أو ضمن وسوم HTML5 دون تمييز، مما يسمح باستغلال نقاط الإدخال غير المحمية.
- **استجابات واضحة**: الحقن تُنتج استجابات ملحوظة (مثل تنبيهات، تسجيلات في وحدة التحكم، أو تغييرات بصرية)، مما يؤكد وجود الثغرة.

### كيف يتم الاستغلال؟
- يتم إدخال شيفرة JavaScript ضمن وسوم HTML5 أو سمات أحداث في نقاط إدخال التطبيق (مثل معلمات URL، حقول نماذج، أو تعليقات) التي تُعرض أو تُنفذ دون تنظيف.
- تُستخدم وسوم مثل `<svg>`، `<video>`، أو `<details>` مع أحداث مثل `onload`، `onerror`، أو `onclick` لتشغيل الشيفرة.
- يتم مراقبة استجابة التطبيق لتأكيد التنفيذ:
  - **نجاح (True)**: ظهور تنبيه، تسجيل رسالة في وحدة التحكم، تغيير عنوان الصفحة، أو تغيير بصري.
  - **فشل (False)**: لا يحدث شيء، أو يظهر خطأ (مثل رمز حالة HTTP 403).
- تُكيَّف الحقن للسياق (مثل أحداث تفاعلية تتطلب نقر المستخدم أو أحداث تلقائية مثل `onload`).

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يحتوي على حقل بحث أو نموذج تعليقات. حاولت استخدام حقن أساسية مثل `<script>alert('XSS')</script>`، لكنها فشلت بسبب فلتر يحظر `<script>`. لاحظت أن إدخال وسوم HTML5 مثل `<svg onload=alert(1)>` أو أحداث مثل `<img src=x onerror=alert('XSS')>` يُنتج استجابات مختلفة، مما يشير إلى وجود ثغرة XSS محتملة. الآن، تريد استخدام وسوم HTML5 وسمات الأحداث لتأكيد الثغرة عن طريق تنفيذ JavaScript عبر سياقات تفاعلية أو تلقائية، مثل تحميل عنصر أو نقر المستخدم.

---
