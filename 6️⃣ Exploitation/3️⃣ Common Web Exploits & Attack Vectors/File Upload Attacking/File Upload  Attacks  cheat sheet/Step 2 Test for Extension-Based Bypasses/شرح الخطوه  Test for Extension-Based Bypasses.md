بناءً على طلبك لشرح خطوة **Test for Extension-Based Bypasses** في اختبار هجمات تحميل الملفات (File Upload Attacks) باستخدام نفس طريقة الشرح المستخدمة في المثال (مع أقسام مثل "ما المقصود؟"، "لماذا يعمل؟"، "كيف يتم الاستغلال؟"، والخطوات العملية)، سأقدم شرحًا مفصلاً ومنظمًا باللغة العربية. سأغطي جميع المحاولات الممكنة لتجاوز قيود الامتدادات في تحميل الملفات، مع تقديم الأوامر والأمثلة لكل تقنية. سيتم تضمين المحتوى ذي الصلة في علامة `<xaiArtifact>` بمعرف جديد، مع الحفاظ على التنسيق المطلوب وتجنب استخدام Markdown خارج العلامة.

---

## فهم الخطوة: اختبار تجاوز قيود الامتدادات (Test for Extension-Based Bypasses)

### ما المقصود؟
اختبار تجاوز قيود الامتدادات هو عملية محاولة تحميل ملفات تحتوي على شيفرات قابلة للتنفيذ (مثل ويب شيل PHP أو ASP) على الرغم من قيود الخادم التي تمنع امتدادات معينة (مثل `.php` أو `.asp`). الهدف هو خداع الخادم لقبول ملفات بامتدادات تبدو غير ضارة (مثل `.jpg` أو `.png`) ولكنها تُنفذ كشيفرة خبيثة. تُستخدم هذه التقنية في اختبار أمن التطبيقات للتحقق من وجود ثغرات في آلية تحميل الملفات.

### لماذا يعمل؟
- **التحقق الضعيف من الامتدادات**: بعض الخوادم تتحقق فقط من الامتداد الأخير في اسم الملف (مثل `.jpg` في `shell.php.jpg`) أو لا تتحقق من الاسم الكامل.
- **إعدادات خاطئة في الخادم**: على سبيل المثال، في خوادم Apache، قد يتم تنفيذ الملفات التي تحتوي على `.php` في أي جزء من الاسم بسبب إعدادات mod_php.
- **حساسية الأحرف**: التحقق من الامتدادات قد يكون حساسًا لحالة الأحرف (case-sensitive)، مما يسمح باستخدام `.pHp` بدلاً من `.php`.
- **عيوب معالجة الملفات**: تقنيات مثل إدخال بايت فارغ (null byte) أو أحرف خاصة قد تتجاوز وظائف معالجة الملفات مثل `pathinfo()` في PHP.
- **عدم تنظيف الأسماء**: بعض الخوادم لا تتعامل بشكل صحيح مع الأحرف الخاصة (مثل النقاط المتعددة أو الفراغات)، مما يسمح بتجاوز القيود.

### كيف يتم الاستغلال؟
- يتم إنشاء ملف ويب شيل (مثل ملف PHP يحتوي على شيفرة تنفيذ الأوامر).
- يتم تعديل اسم الملف باستخدام تقنيات مثل الامتدادات المزدوجة، الأحرف الخاصة، أو البايت الفارغ ليبدو كملف مسموح به.
- يتم تحميل الملف باستخدام واجهة تحميل الملفات في التطبيق، مع تعديل الطلبات (باستخدام Burp Suite مثلاً) إذا لزم الأمر.
- يتم اختبار ما إذا كان الملف يمكن تنفيذه عبر الوصول إليه (مثل `http://<target>/Uploads/shell.php?cmd=whoami`).
- إذا نجحت التقنية، يمكن تنفيذ أوامر خبيثة على الخادم، مما قد يؤدي إلى التحكم الكامل به.

### السناريو
لنفترض أنك تختبر موقعًا إلكترونيًا يسمح بتحميل الصور فقط (مثل `.jpg`، `.png`، `.gif`). تريد تحميل ويب شيل PHP (مثل `shell.php`) يسمح بتنفيذ أوامر مثل `whoami`. تبدأ بمحاولة تحميل `shell.php` مباشرة، ولكن الموقع يرفضه لأن الامتداد غير مسموح. ثم تجرب تقنيات مثل إضافة امتداد `.jpg` (مثل `shell.php.jpg`) أو استخدام أحرف خاصة (مثل `shell.php%00.jpg`) لخداع الخادم. إذا نجحت إحدى المحاولات وتم تنفيذ الملف، تكون قد أكدت وجود ثغرة تحميل ملفات.

---
