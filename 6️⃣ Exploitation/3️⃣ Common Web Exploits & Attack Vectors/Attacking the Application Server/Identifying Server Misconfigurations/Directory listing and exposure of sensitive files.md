تمام، هشرحلك القسم ده عن "عرض الدليل وفضح الملفات الحساسة" (Directory Listing and Exposure of Sensitive Files) بعمق وعملي مع أكواد وأوامر، وبعد كل جزء هاديك خلاصة Pentest بالعامية المصرية، وفي الآخر هاديك سيناريوهات الاستغلال الممكنة.

---

### **1. عرض الدليل (Directory Listing)**
#### **شرح عملي:**
عرض الدليل هو لما الخادم (زي Apache أو Nginx) بيسمحلك تشوف كل الملفات والمجلدات في مسار معين لو ما حددتش ملف معين (زي `index.html`). ده بيحصل لو الخادم مهيأ غلط أو الـ "Autoindex" مفعل، وممكن يفضح ملفات المفروض تبقى مخفية.

- **مثال:** لو فتحت `http://example.com/files/` وما لقيتش صفحة رئيسية، الخادم ممكن يعرضلك لستة بكل الملفات زي `backup.zip` أو `config.php`.

#### **كود عملي (Nginx مع Directory Listing):**
- ملف تهيئة Nginx:
```
server {
    listen 80;
    server_name example.com;

    location /files {
        root /var/www;
        autoindex on; # تفعيل عرض الدليل
    }
}
```
- لو حطيت ملفات في `/var/www/files` زي `secret.txt` و`db_backup.sql`، وفتحت `http://example.com/files/`، هتشوف لستة كده:
```
Index of /files
- secret.txt
- db_backup.sql
```
- لو `autoindex off` (الافتراضي الآمن)، هيرجعلك 403 Forbidden.

#### **كود عملي (Apache):**
- في Apache، لو ملف `.htaccess` مش بيمنع العرض أو الـ `Options Indexes` مفعل في `httpd.conf`:
```
Options +Indexes
```
- افتح `http://example.com/files/` وهتلاقي الملفات متعرضة.

#### **خلاصة Pentest بالعامية:**
"لو لقيت سيرفر بيطلعلك لستة ملفات، ابدأ دوّر على حاجات زي `backup` أو `config` أو أي حاجة بامتداد `.sql` و`.php`. جرب كمان تضيف `/` في آخر أي مسار تشوف لو بيفضح حاجة!"

---

### **2. فضح الملفات الحساسة (Exposure of Sensitive Files)**
#### **شرح عملي:**
الملفات الحساسة هي ملفات زي ملفات الإعدادات (`config.php`)، النسخ الاحتياطية (`backup.tar.gz`)، أو ملفات النظام (`/etc/passwd`) اللي المفروض ما تبقاش متاحة للعامة. لو الخادم مش محمي كويس أو فيه ثغرة Path Traversal، ممكن توصل ليها.

- **أمثلة شائعة:**
  - `.env` (فيه متغيرات زي كلمات سر قاعدة البيانات).
  - `web.config` (في IIS، فيه إعدادات حساسة).
  - `id_rsa` (مفتاح SSH خاص).

#### **كود عملي (مثال عرض ملف حساس في PHP):**
- لو موقع PHP مش بيحمي المسارات، وفيه ملف `config.php`:
```php
<?php
$db_user = "root";
$db_pass = "secret123";
?>
```
- جرب تفتح `http://example.com/config.php`، لو ظهر الكود كده، يبقى السيرفر بيفضح الملفات!

#### **أمر عملي (Path Traversal):**
- جرب في المتصفح أو بـ `curl`:
```bash
curl http://example.com/files/../etc/passwd
```
- لو رجعلك محتوى `/etc/passwd` (في لينكس)، يبقى فيه ثغرة Path Traversal بتسمحلك تطلع برا المسار الأصلي.

#### **خلاصة Pentest بالعامية:**
"جرب تضيف `../` كتير في الرابط (زي `../../config.php`) وشوف لو بيطلعلك حاجة. أو ابحث عن ملفات معروفة زي `.env` و`wp-config.php` (لو ووردبريس) ولو لقيتها، هتلاقي فيها كنوز زي باسوردات!"

---

### **3. تأثير المشكلة وكيفية اكتشافها**
#### **شرح عملي:**
- **التأثير:** لو الخادم بيعرض دليل أو ملفات حساسة، ممكن المهاجم يلاقي بيانات زي كلمات سر، مفاتيح API، أو حتى يفهم هيكل النظام ويخطط لهجوم أكبر.
- **الاكتشاف:** بتستخدم أدوات زي DirBuster أو Gobuster تبعت طلبات لمسارات شائعة، أو تسكن يدوي بـ `curl` وتشوف الردود.

#### **أمر عملي (اكتشاف بـ Gobuster):**
```bash
gobuster dir -u http://example.com/ -w /usr/share/wordlists/dirb/common.txt
```
- هيجرب مسارات زي `/admin`، `/backup`، `/files`، ويرجعلك اللي شغال (كود 200) أو ممنوع (403).

#### **أمر عملي (فحص يدوي):**
```bash
curl -I http://example.com/.env
```
- لو رجعلك `200 OK`، يبقى الملف موجود وممكن تحمله!

#### **خلاصة Pentest بالعامية:**
"استخدم أداة زي Gobuster تبحثلك عن الملفات والمسارات، أو جرب حاجات يدوي زي `/backup.zip` و`/config`. لو السيرفر بيرجع 200 على حاجة حساسة، يبقى خدت الجون الأولاني!"

---

### **سيناريوهات الاستغلال الممكنة (Exploitation Scenarios):**
1. **Directory Listing:**
   - **Backup Files:** لو لقيت `backup.tar.gz` أو `db_backup.sql`، حملها وافتحها تشوف فيها بيانات زي جداول قاعدة البيانات.
   - **Source Code:** لو لقيت `index.php` أو `app.js`، اقراه تشوف فيه أي أسرار (زي API Keys).

2. **Sensitive Files Exposure:**
   - **Config Files:** لو وصلت لـ `.env` أو `web.config`، خد الباسوردات وجربها على خدمات تانية (زي MySQL أو SSH).
   - **System Files:** لو لقيت `/etc/passwd` بـ Path Traversal، اعرف المستخدمين الموجودين وابدأ هجوم Brute Force.
   - **SSH Keys:** لو لقيت `/home/user/.ssh/id_rsa`، استخدمه تتصل بالسيرفر بـ:
     ```bash
     ssh -i id_rsa user@<IP>
     ```

3. **مشترك:**
   - **Path Traversal:** جرب `http://example.com/files/../../../../etc/shadow` (في لينكس) أو `../../Windows/system32/config/sam` (في ويندوز) تسحب ملفات النظام.
   - **Guessing:** جرب مسارات شائعة زي `/admin/config.php` أو `/uploads/backup.zip` بناءً على نوع الموقع (مثلاً ووردبريس أو Joomla).
   - **Automation:** استخدم أداة زي wfuzz أو Burp Suite تكتشف الملفات دي بسرعة:
     ```bash
     wfuzz -c -z file,/usr/share/wordlists/dirb/common.txt --hc 404 http://example.com/FUZZ
     ```

---

لو عايز تفاصيل أكتر عن أي سيناريو أو كود استغلال معين، قوللي وأنا أفصلك!