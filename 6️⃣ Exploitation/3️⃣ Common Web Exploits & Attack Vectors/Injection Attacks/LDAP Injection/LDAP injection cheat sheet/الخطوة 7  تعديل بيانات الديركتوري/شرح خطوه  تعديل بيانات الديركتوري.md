
## فهم الخطوة: تعديل بيانات الديركتوري (الخطوة 7)
### ما المقصود؟
في سياق **الخطوة 7**، يُفترض أنك قد مررت بالخطوات السابقة لثغرة LDAP Injection، مثل:
1. اكتشاف وجود الثغرة.
2. الاستغلال الأعمى لتخمين البيانات.
3. اكتشاف الخصائص الصالحة (مثل `uid`, `userPassword`).
4. جمع المعلومات عن المستخدمين أو الكائنات.
5. أتمتة الاختبار.
6. استغلال `userPassword` (تأكيد كلمات المرور، كسر التشفير، اختبار الخدمات).

الآن، في **الخطوة 7**، تركز على **تعديل بيانات الديركتوري**، وهذا يعني التلاعب بالكائنات أو الخصائص في خادم LDAP، مثل:
- **تغيير بيانات المستخدمين**: تعديل كلمات المرور، عناوين البريد، أو الخصائص الأخرى (مثل `mail`, `cn`).
- **إضافة حسابات جديدة**: إنشاء مستخدمين جدد (مثل حساب إداري) للوصول لاحقًا.
- **حذف كائنات**: إزالة مستخدمين أو مجموعات من الديركتوري.
- **تغيير صلاحيات**: تعديل عضوية المجموعات (مثل إضافة مستخدم إلى مجموعة إدارية).

### لماذا هي مهمة؟
- **تحقيق وصول دائم (Persistence)**: إضافة حساب جديد يضمن وصولك إلى النظام حتى بعد إصلاح الثغرة.
- **توسيع الهجوم**: تغيير بيانات المستخدمين (مثل كلمة مرور إداري) يتيح الوصول إلى أنظمة أخرى.
- **تعطيل النظام**: حذف مستخدمين أو تغيير بيانات حساسة قد يؤثر على عمل التطبيق.
- **إثبات التأثير**: في اختبار الاختراق القانوني، تعديل الديركتوري يبرز خطورة الثغرة، حيث يُظهر القدرة على التلاعب بالبيانات الحساسة.

### كيف يتم الاستغلال؟
تعديل بيانات الديركتوري في LDAP Injection يعتمد على:
- **استغلال واجهات التطبيق**: إذا كان التطبيق يسمح بإرسال أوامر تعديل (Modify) إلى LDAP عبر حقول إدخال غير مصفاة.
- **استخدام بيانات اعتماد مسروقة**: إذا حصلت على بيانات اعتماد إدارية (مثل `administrator:MYKE` من الخطوة 6)، يمكنك استخدامها للوصول إلى واجهات إدارة LDAP (مثل phpLDAPadmin) أو أدوات مثل `ldapmodify`.
- **التلاعب بالاستعلامات**: إرسال استعلامات LDAP تؤدي إلى تغييرات غير مقصودة في الديركتوري.
- **أتمتة العملية**: استخدام سكربتات لإرسال طلبات تعديل أو إنشاء كائنات تلقائيًا.

### السناريو
لنفترض أنك تختبر موقعًا (`http://example.com`) يحتوي على نموذج تسجيل دخول أو واجهة إدارة تتفاعل مع خادم LDAP. أكدت وجود ثغرة LDAP Injection من خلال استجابات مختلفة لمدخلات مثل `*` أو `admin*`. في الخطوات السابقة، استخلصت كلمة مرور إدارية (`administrator:MYKE`)، وحددت خصائص مثل `userPassword`, `mail`, و`memberOf`. الآن، في **الخطوة 7**، تريد:
- **تغيير كلمة مرور** مستخدم موجود (مثل `user1`).
- **إضافة حساب جديد** (مثل `hacker` مع صلاحيات إدارية).
- **حذف مستخدم** أو كائن غير ضروري.
- **تعديل صلاحيات** (مثل إضافة `user1` إلى مجموعة إدارية).

---
