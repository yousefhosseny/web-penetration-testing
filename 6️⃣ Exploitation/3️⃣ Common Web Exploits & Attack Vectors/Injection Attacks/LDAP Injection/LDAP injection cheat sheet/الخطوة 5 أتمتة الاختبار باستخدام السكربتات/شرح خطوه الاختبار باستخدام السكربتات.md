لتعميق فهمك في **الخطوة الخامسة من استغلال ثغرة LDAP Injection**، وهي **أتمتة الاختبار باستخدام السكربتات**، سأشرح السناريو بشكل مفصل باللغة العربية. سأوضح كيف تعمل هذه الخطوة، لماذا هي مهمة، وجميع المحاولات الممكنة التي يمكنك استخدامها لأتمتة اكتشاف الخصائص الصالحة (Valid Attributes) والاستغلال الأعمى (Blind Exploitation) باستخدام سكربتات. سأقدم شرحًا واضحًا وشاملًا مع أمثلة عملية للسكربتات، وملخصًا لجميع المحاولات التي يمكنك تجربتها، مع التركيز على تطبيقها في اختبار موقع ويب.

---

## فهم الخطوة: أتمتة الاختبار باستخدام السكربتات
### ما المقصود؟
أتمتة الاختبار تعني استخدام سكربتات برمجية (مثل Python أو Ruby) لإرسال طلبات HTTP تحتوي على استعلامات LDAP بشكل تلقائي، وتحليل استجابات التطبيق لتحديد الخصائص الصالحة أو استخلاص بيانات حساسة (مثل كلمات المرور). الهدف هو تسريع عملية الاختبار مقارنة بالاختبار اليدوي، خاصة عند التعامل مع قوائم طويلة من الخصائص أو تخمين قيم حرفًا بحرفًا.

### لماذا هي مهمة؟
- **الاختبار اليدوي بطيء**: اختبار كل خاصية (مثل `uid`, `cn`, `userPassword`) أو تخمين كلمة مرور حرفًا بحرفًا يدويًا باستخدام Burp Suite يستغرق وقتًا طويلاً.
- **الكفاءة**: السكربتات تتيح إرسال مئات أو آلاف الطلبات في ثوانٍ، مع تحليل الاستجابات تلقائيًا.
- **التكرار**: السكربتات تُستخدم ل:
  - **اكتشاف الخصائص الصالحة**: اختبار قائمة خصائص (مثل `uid`, `cn`, `sn`) لمعرفة أيها مدعوم.
  - **الاستغلال الأعمى**: تخمين قيمة خاصية (مثل `userPassword`) حرفًا بحرفًا بناءً على استجابات التطبيق.
- **الدقة**: السكربتات تقلل من الأخطاء البشرية وتضمن اختبار جميع الاحتمالات.

### كيف يتم الأتمتة؟
- تكتب سكربتًا (عادةً بلغة Python أو Ruby) يقوم بما يلي:
  - إرسال طلبات HTTP (GET أو POST) تحتوي على استعلامات LDAP إلى الموقع.
  - تحليل استجابات التطبيق لتحديد ما إذا كان الاستعلام ناجحًا (مثل وجود نص معين أو رمز حالة HTTP معين).
  - تخزين النتائج (مثل الخصائص الصالحة أو القيمة المستخلصة).
- تستخدم ملف قاموس (Dictionary) يحتوي على قائمة بالخصائص أو الأحرف لاختبارها.
- تراقب الطلبات باستخدام أداة وكيل (مثل Burp Suite) للتأكد من أن السكربت يعمل بشكل صحيح.

### السناريو
لنفترض أنك تختبر موقعًا يحتوي على نموذج تسجيل دخول أو نموذج بحث يتفاعل مع خادم LDAP. لاحظت أن إدخال قيم مثل `*` أو `admin*` يؤدي إلى استجابات مختلفة، مما يؤكد وجود ثغرة LDAP Injection. حاولت يدويًا اختبار الخصائص (مثل `uid`, `cn`) أو الاستغلال الأعمى، لكن العملية بطيئة. الآن، تريد أتمتة العملية باستخدام سكربتات ل:
- **اكتشاف الخصائص الصالحة**: معرفة أي الخصائص (مثل `userPassword`, `mail`) مدعومة.
- **الاستغلال الأعمى**: استخلاص قيمة خاصية (مثل كلمة مرور مستخدم `administrator`) حرفًا بحرفًا.

---

