لتعميق فهمك في **الخطوة الثالثة من استغلال ثغرة LDAP Injection**، وهي **اكتشاف الخصائص الصالحة (Valid LDAP Attributes)**، سأشرح السناريو بشكل مفصل باللغة العربية. سأوضح كيف تعمل هذه الخطوة، لماذا هي مهمة، وجميع المحاولات الممكنة التي يمكنك استخدامها لتحديد الخصائص (Attributes) التي يدعمها خادم LDAP (مثل `uid`, `cn`, `sn`, `userPassword`). سأقدم شرحًا واضحًا وشاملًا مع أمثلة عملية، وملخصًا لجميع الاستعلامات التي يمكنك تجربتها، مع التركيز على كيفية تطبيقها في اختبار موقع ويب.

---

## فهم الخطوة: اكتشاف الخصائص الصالحة (Valid LDAP Attributes)
### ما المقصود؟
اكتشاف الخصائص الصالحة يعني تحديد أسماء الخصائص (Attributes) التي يستخدمها خادم LDAP في الدليل (مثل `uid`, `cn`, `sn`, `userPassword`, `mail`). هذه الخصائص هي حقول البيانات المرتبطة بكائنات الدليل (مثل المستخدمين أو المجموعات). معرفة الخصائص الصالحة يساعدك في:
- صياغة هجمات LDAP Injection أكثر دقة (مثل استهداف `userPassword` لاستخلاص كلمات المرور).
- فهم هيكلية الدليل (مثل ما إذا كان يحتوي على `mail` أو `givenName`).
- تحديد الخصائص التي يمكن استخدامها في الاستغلال الأعمى أو تجاوز التحقق من الهوية.

### لماذا هي مهمة؟
- خوادم LDAP تستخدم خصائص قياسية (مثل `uid` لاسم المستخدم، `userPassword` لكلمة المرور)، ولكن قد تختلف الخصائص حسب التكوين.
- إذا حاولت استغلال خاصية غير موجودة (مثل `xyz`), سيعيد التطبيق خطأ أو يتجاهل الاستعلام، مما يجعل الهجوم غير فعال.
- معرفة الخصائص الصالحة تمكّنك من:
  - تحديد الخصائص التي يمكن استهدافها في الاستغلال الأعمى (مثل تخمين قيمة `userPassword`).
  - استخدام الخصائص في استعلامات لتجاوز التحقق (مثل استخدام `cn` بدلاً من `uid`).

### كيف يتم الاكتشاف؟
- تقوم بإدخال استعلامات LDAP تحتوي على أسماء خصائص محتملة مع علامة بدل (`*`) في حقل إدخال (مثل حقل اسم المستخدم أو البحث).
- مثال: إدخال `*)(userPassword=*)` يختبر ما إذا كانت خاصية `userPassword` موجودة.
- تراقب استجابة التطبيق:
  - **إذا كانت الاستجابة إيجابية** (مثل صفحة مختلفة، عدم ظهور خطأ، أو نتيجة بحث)، فالخاصية صالحة.
  - **إذا كانت الاستجابة سلبية** (مثل خطأ "Invalid credentials" أو صفحة فارغة)، فالخاصية غير صالحة.
- تكرر العملية مع قائمة من الخصائص الشائعة.

### السناريو
لنفترض أنك تختبر موقعًا يحتوي على نموذج تسجيل دخول أو نموذج بحث يتفاعل مع خادم LDAP. لاحظت أن إدخال قيم مثل `*` أو `admin*` يؤدي إلى استجابات مختلفة، مما يؤكد وجود ثغرة LDAP Injection. الآن، تريد معرفة الخصائص التي يدعمها الخادم (مثل `userPassword`, `cn`, `mail`) لاستخدامها في هجمات لاحقة (مثل الاستغلال الأعمى أو تجاوز التحقق). تستخدم هذه الخطوة لاختبار الخصائص واحدة تلو الأخرى.

---

