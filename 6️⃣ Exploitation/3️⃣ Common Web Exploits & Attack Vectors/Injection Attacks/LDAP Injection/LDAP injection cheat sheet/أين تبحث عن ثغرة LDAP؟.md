
## أين تبحث عن ثغرة LDAP؟
بمجرد أن تشك في أن التطبيق يستخدم LDAP، تحتاج إلى تحديد النقاط التي يمكنك من خلالها اختبار الثغرة. هذه هي الأماكن الشائعة التي يجب التركيز عليها:

#### 1. **نماذج تسجيل الدخول (Login Forms)**:
   - الحقول: اسم المستخدم (Username) وكلمة المرور (Password).
   - السبب: هذه الحقول غالبًا تُستخدم لبناء استعلامات LDAP للتحقق من هوية المستخدم (مثل `(&(uid=USER)(userPassword=PASS))`).
   - كيفية الاختبار: أدخل قيمًا مثل `admin*` أو `*)(uid=*)` في حقل اسم المستخدم وتحقق من الاستجابة.

#### 2. **نماذج البحث (Search Forms)**:
   - الحقول: حقول البحث عن المستخدمين أو الموظفين (مثل "ابحث عن موظف باسم...").
   - السبب: هذه الحقول قد تُستخدم لاستعلامات LDAP للبحث في الدليل (مثل `(cn=*SEARCH_TERM*)`).
   - كيفية الاختبار: أدخل قيمًا مثل `*` أو `admin)(cn=*` ولاحظ إذا أعاد الموقع نتائج غير متوقعة أو أخطاء.

#### 3. **معايير URL (Query Parameters)**:
   - الحقول: معايير في عنوان URL مثل `?search=admin` أو `?user=guest`.
   - السبب: بعض التطبيقات تمرر مدخلات المستخدم عبر URL إلى استعلامات LDAP.
   - كيفية الاختبار: عدّل المعايير بإضافة أحرف مثل `*` أو `)` (مثل `?search=admin*`) وتحقق من الاستجابة.

#### 4. **حقول إدخال أخرى**:
   - الحقول: أي حقل يقبل مدخلات مستخدم ويتفاعل مع قاعدة بيانات أو دليل (مثل حقول التسجيل أو تحديث الملف الشخصي).
   - السبب: قد تستخدم هذه الحقول LDAP لتحديث أو استرجاع بيانات المستخدم.
   - كيفية الاختبار: جرب إدخال قيم مثل `*)(cn=*` وتحقق من استجابة الموقع.

#### 5. **واجهات برمجة التطبيقات (APIs)**:
   - الحقول: نقاط نهاية API التي تتعامل مع بيانات المستخدم (مثل `/api/login` أو `/api/search`).
   - السبب: واجهات API قد تمرر مدخلات المستخدم إلى استعلامات LDAP.
   - كيفية الاختبار: استخدم أداة مثل Postman أو Burp Suite لإرسال طلبات مع مدخلات مثل `*)(uid=*` إلى نقطة النهاية.

---


## ملخص الأوامر/الإجراءات للخطوة الأولى
#### 1. **تكوين الوكيل**:
   - اضبط المتصفح لاستخدام Burp Suite أو OWASP ZAP.
   - مثال: في Burp Suite، اذهب إلى Proxy > Options وتأكد من أن الوكيل يعمل (افتراضيًا على `127.0.0.1:8080`).

#### 2. **اختبار تسجيل الدخول**:
   - أدخل: `username=test`، `password=test` في نموذج تسجيل الدخول.
   - تحقق من الطلب في Burp Suite (ابحث عن معايير مثل `uid` أو `userPassword`).
   - تحقق من الاستجابة (ابحث عن كلمات مثل "LDAP" أو "directory").

#### 3. **اختبار أحرف خاصة**:
   - أدخل في حقل اسم المستخدم: `admin*`، `*`، أو `*)(uid=*)`.
   - أدخل في حقل البحث (إن وجد): `*` أو `admin*`.
   - راقب الاستجابة في Burp Suite لأي تغيرات غير متوقعة.

#### 4. **تحليل رسائل الخطأ**:
   - أدخل قيمًا غير صالحة مثل `admin' OR '1'='1` وتحقق من رسائل الخطأ.
   - ابحث عن مصطلحات مثل "LDAP filter" أو "directory error".

---

