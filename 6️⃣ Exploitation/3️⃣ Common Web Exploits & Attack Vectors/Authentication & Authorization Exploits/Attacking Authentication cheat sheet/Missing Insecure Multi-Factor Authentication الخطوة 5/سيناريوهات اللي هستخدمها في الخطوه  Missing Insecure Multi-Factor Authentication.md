## هام جدا 
- السيناريوهات اللي بقولهالك هي فكره ممكن تحصل لكن مش شرط تعمل نفس الخطوات الموجوده يعني مثلا يمكن استخدم نفس التوكين ل email تاني مش شرط تعمل نفس الخطوات اللي مديهالك  لكن ممكن تدور علي طريقه تعمل السيناريو ده 

---

**طريقة الاختبار**: هنختبر نظام تسجيل الدخول، إعدادات MFA، عملية استعادة الحساب، وأي آليات مرتبطة بشكل منهجي عشان نكتشف إذا كان فيه عيوب في تطبيق MFA أو غيابها. تحت هلاقي **كل المحاولات الممكنة** مقسمة حسب الطريقة.

---

#### **المحاولة الأولى: اختبار غياب المصادقة متعددة العوامل**
**الهدف**: نشوف إذا كان الموقع ما بيطلبش MFA أصلاً أثناء تسجيل الدخول.
- **الخطوات**:
  1. حاول تسجل دخول للموقع بحساب تحت سيطرتك (مثل `https://target.com/login`) باستخدام اسم مستخدم وكلمة مرور.
  2. لاحظ إذا كان الموقع طلب خطوة تحقق إضافية (مثل رمز OTP عبر الإيميل/SMS، تطبيق مصادقة، أو سؤال أمان).
  3. لو الموقع سمحلك تدخل مباشرة بعد كلمة المرور بدون أي تحقق إضافي، يبقى MFA غايبة.
  4. جرب تسجيل الدخول من جهاز أو شبكة مختلفة (مثل VPN) عشان تشوف إذا الموقع بيطلب MFA في حالات معينة.
  5. روح لإعدادات الحساب (مثل `https://target.com/settings`) وشوف إذا كان فيه خيار لتفعيل MFA. لو مفيش خيار أصلاً، سجل ده كثغرة.
  6. استخدم Burp Suite عشان تعترض طلبات تسجيل الدخول وتتأكد إن مفيش خطوات MFA في الـ Response أو الـ Redirects.
- **البيانات اللي هنجربها**:
  - حساب: `test@example.com` مع كلمة مرور صحيحة.
  - شبكات: شبكة عادية، VPN، جهاز مختلف.
- **النتيجة المتوقعة**:
  - نجاح: تسجيل الدخول تم بدون طلب MFA، يعني MFA غايبة.
  - فشل: الموقع طلب خطوة تحقق إضافية (مثل OTP)، يعني MFA موجودة.
- **الأدوات**:
  - **متصفح**: سجل دخول يدويًا.
  - **Burp Suite**: اعترض طلبات الـ POST لتسجيل الدخول.
  - **cURL**:
    ```bash
    curl -X POST -d "username=test@example.com&password=password" https://target.com/login
    ```
    - شوف الرد لو فيه إشارة لـ MFA (مثل Redirect لصفحة OTP).
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password" https://target.com/login
    ```
  - Burp Suite:
    - شغل Proxy واعترض طلب تسجيل الدخول.
    - ابحث في الـ Response عن أي إشارة لـ MFA (مثل `mfa_required` أو Redirect).

---

#### **المحاولة التانية: اختبار إمكانية تعطيل أو تخطي MFA**
**الهدف**: نشوف إذا كان المستخدم أو المهاجم يقدر يعطل MFA أو يتخطاها بعد تفعيلها.
- **الخطوات**:
  1. سجل دخول بحساب تحت سيطرتك وقم بتفعيل MFA (لو موجودة) من إعدادات الحساب.
  2. حاول تعطيل MFA من إعدادات الحساب (مثل `https://target.com/settings/security`).
     - لاحظ إذا كان الموقع بيطلب تحقق إضافي (مثل كلمة المرور أو OTP) لتعطيل MFA.
     - لو بيسمح بتعطيل MFA بدون تحقق قوي، يبقى فيه ثغرة.
  3. جرب تخطي خطوة MFA أثناء تسجيل الدخول:
     - أدخل اسم المستخدم وكلمة المرور، وبعدين حاول عدّل الطلب في Burp Suite عشان تتخطى صفحة MFA (مثل إزالة حقل `mfa_required`).
     - أو جرب أرسل طلب تسجيل الدخول بدون حقل الـ OTP (مثل `otp_code`).
  4. تحقق إذا الموقع بيسمح بتسجيل الدخول من خلال آليات بديلة (مثل "تسجيل الدخول عبر Google") بدون MFA.
  5. لو MFA اختيارية (Optional)، جرب تسجيل الدخول بدون تفعيلها وتحقق إذا الموقع بيسمح بالوصول الكامل.
- **البيانات اللي هنجربها**:
  - حساب: `test@example.com` مع MFA مفعلة.
  - طلبات: طلبات معدلة بدون حقل OTP أو مع `mfa_enabled=false`.
- **النتيجة المتوقعة**:
  - نجاح: تعطيل MFA بدون تحقق قوي أو تخطي خطوة MFA، يعني MFA ضعيفة.
  - فشل: الموقع بيفرض تحقق قوي لتعطيل MFA وبيمنع تخطي خطوة MFA.
- **الأدوات**:
  - **Burp Suite**: عدّل طلبات تسجيل الدخول أو تعطيل MFA.
  - **cURL**:
    ```bash
    curl -X POST -d "username=test@example.com&password=password" https://target.com/login
    curl -X POST -d "mfa_enabled=false" https://target.com/settings/security
    ```
  - **متصفح**: جرب تعطيل MFA يدويًا.
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password" https://target.com/login
    ```
  - Burp Suite:
    - اعترض طلب تسجيل الدخول أو تعطيل MFA.
    - أزل حقل `otp_code` أو عدّل `mfa_required` إلى `false`.

### شوف استخدمت السيناريوا ده ازاي في lab في portswigger

##### 1.  اول حاجه ركزت علي شكل ال url بتاع الايميل اللي قدرت اسجل بيه
![[Pasted image 20250427191258.png]]
##### 2.  ثاني حاجه لما دخلت بايميل الضحيه ووصلت الصفحه بتاعت ال login 2 الصفحه الي عايزه كود 
- استخدمت ال burpsuit وعملت للصفحه Drop وحطيت الامتداد بتاع الصفح بتاعت بعد نجاح التسجيل 
#### [شرح للفكره]([Authentication Vulnerabilities - Lab #2 2FA simple bypass | Short Version](https://www.youtube.com/watch?time_continue=196&v=2WpBVanEn3M&embeds_referring_euri=https%3A%2F%2Fportswigger.net%2F&embeds_referring_origin=https%3A%2F%2Fportswigger.net&source_ve_path=Mjg2NjMsMTI3MzAxLDIzODUx))


---

#### **المحاولة التالتة: اختبار ضعف رموز MFA (Weak OTP/Token)**
**الهدف**: نشوف إذا كان رموز MFA (مثل OTP عبر SMS/إيميل) قصيرة، متكررة، أو قابلة للتخمين.
- **الخطوات**:
  1. سجل دخول بحساب تحت سيطرتك واطلب رمز MFA (مثل OTP عبر الإيميل أو SMS).
  2. حلل الرمز:
     - الطول: لو قصير (مثل 4 أرقام)، يبقى قابل للتخمين.
     - النمط: لو أرقام بس (مثل `1234`) أو بيتبع تسلسل، يبقى ضعيف.
     - التكرار: اطلب رموز متعددة وشوف إذا كانت بتتكرر.
  3. جرب تخمين الرمز يدويًا أو باستخدام Burp Suite Intruder:
     - أرسل طلبات بأكواد مختلفة (مثل `0000` إلى `9999` لو الرمز 4 أرقام).
  4. تحقق من صلاحية الرمز:
     - جرب استخدام نفس الرمز بعد فترة (مثل 10 دقايق) عشان تشوف إذا كان لسه صالح.
     - لو الرمز بيظل صالح لمدة طويلة (مثل ساعة)، يبقى فيه ثغرة.
  5. استخدم Burp Suite Sequencer عشان تحلل عشوائية الرموز (Randomness/Entropy).
- **البيانات اللي هنجربها**:
  - حساب: `test@example.com`.
  - رموز: `1234`، `0000`، أو تسلسل (مثل `0000` إلى `9999`).
- **النتيجة المتوقعة**:
  - نجاح: رمز قصير (مثل 4 أرقام) أو متكرر أو صالح لمدة طويلة، يعني MFA ضعيفة.
  - فشل: رمز طويل (مثل 6-8 أحرف عشوائية) وصلاحيته قصيرة (مثل 5 دقايق).
- **الأدوات**:
  - **Burp Suite Intruder**: جرب رموز متعددة.
  - **Burp Suite Sequencer**: تحليل عشوائية الرموز.
  - **cURL**:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
  - **Python Script** (لاختبار رموز متعددة):
    ```python
    import requests

    url = "https://target.com/mfa/verify"
    credentials = {"username": "test@example.com", "password": "password"}
    otps = ["0000", "0001", "0002"]

    for otp in otps:
        data = {**credentials, "otp_code": otp}
        response = requests.post(url, data=data)
        print(f"OTP: {otp}, Status: {response.status_code}, Response: {response.text[:50]}")
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
  - Python: `python test_otp_codes.py` (احفظ السكربت فوق).
  - Burp Suite Intruder:
    - اعترض طلب التحقق من OTP.
    - استخدم قائمة أكواد (مثل `0000` إلى `9999`) في حقل `otp_code`.

---

#### **المحاولة الرابعة: اختبار استعادة الحساب (Account Recovery Bypass)**
**الهدف**: نشوف إذا كان عملية استعادة الحساب (مثل إعادة تعيين كلمة المرور) بتتطلب MFA أو بتسمح بتخطيها.
- **الخطوات**:
  1. روح لصفحة إعادة تعيين كلمة المرور (مثل `https://target.com/forgot-password`).
  2. أدخل إيميل حساب تحت سيطرتك (مثل `test@example.com`) واطلب إعادة تعيين.
  3. لاحظ إذا كان الموقع طلب تحقق MFA (مثل OTP أو سؤال أمان) قبل إرسال رابط إعادة التعيين.
  4. لو الموقع بيرسل رابط إعادة التعيين بدون MFA، جرب استخدام الرابط لتغيير كلمة المرور.
  5. تحقق إذا كان فيه آليات بديلة لاستعادة الحساب (مثل أسئلة أمان):
     - جرب تخمين إجابات أسئلة الأمان (مثل "اسم الحيوان الأليف" أو "مدينة الميلاد").
     - لو الأسئلة ضعيفة أو إجاباتها متوقعة (مثل "dog" أو "Cairo")، يبقى فيه ثغرة.
  6. استخدم Burp Suite عشان تعترض طلبات استعادة الحساب وتحلل الردود.
- **البيانات اللي هنجربها**:
  - إيميل: `test@example.com`.
  - أسئلة أمان: إجابات شائعة (مثل `dog`، `123`، `Cairo`).
- **النتيجة المتوقعة**:
  - نجاح: إعادة تعيين كلمة المرور تمت بدون MFA أو بأسئلة أمان ضعيفة، يعني ثغرة.
  - فشل: الموقع طلب MFA أو تحقق قوي لاستعادة الحساب.
- **الأدوات**:
  - **متصفح**: جرب استعادة الحساب يدويًا.
  - **Burp Suite**: اعترض طلبات إعادة التعيين.
  - **cURL**:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
  - Burp Suite:
    - اعترض طلب إعادة التعيين.
    - تحقق من الـ Response لو فيه رابط بدون تحقق MFA.

---

#### **المحاولة الخامسة: اختبار التكرار أو إعادة استخدام رموز MFA**
**الهدف**: نشوف إذا كان رموز MFA بتتكرر أو بتظل صالحة لاستخدامات متعددة.
- **الخطوات**:
  1. سجل دخول بحساب تحت سيطرتك واطلب رمز MFA.
  2. استخدم الرمز لإكمال تسجيل الدخول.
  3. جرب استخدام نفس الرمز مرة تانية في نفس الجلسة أو جلسة مختلفة.
  4. اطلب رموز متعددة (مثل 3-5 رموز) وشوف إذا كان فيه تكرار أو نمط.
  5. لو الرمز بيتكرر أو بيظل صالح لأكتر من استخدام، يبقى فيه ثغرة.
  6. تحقق من قيود المحاولات (Rate Limiting):
     - أرسل طلبات متكررة بأكواد غلط عشان تشوف إذا الموقع بيقفل الحساب أو بيفرض تأخير.
- **البيانات اللي هنجربها**:
  - حساب: `test@example.com`.
  - رموز: نفس الرمز مرتين أو أكواد عشوائية (مثل `1234`، `5678`).
- **النتيجة المتوقعة**:
  - نجاح: الرمز بيتكرر أو بيشتغل أكتر من مرة، يعني MFA ضعيفة.
  - فشل: الرمز للاستخدام مرة واحدة وبيبطل بسرعة.
- **الأدوات**:
  - **Burp Suite**: أرسل طلبات متكررة بنفس الرمز.
  - **cURL**:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
  - Burp Suite Repeater:
    - احفظ طلب التحقق من OTP.
    - كرر الطلب بنفس الرمز.

---

#### **المحاولة السادسة: اختبار هجمات Brute Force على رموز MFA**
**الهدف**: نشوف إذا كان رموز MFA عرضة للتخمين عبر هجمات Brute Force.
- **الخطوات**:
  1. سجل دخول واطلب رمز MFA.
  2. حلل طول الرمز (مثل 4 أرقام أو 6 أرقام).
  3. لو الرمز قصير، استخدم Burp Suite Intruder أو wfuzz عشان تجرب أكواد مختلفة (مثل `0000` إلى `9999`).
  4. أرسل طلبات للتحقق من OTP بأكواد مختلفة:
     - مثل `https://target.com/mfa/verify?otp_code=0000`.
  5. راقب الردود:
     - لو لقيت رمز صالح (رد 200 OK أو Redirect)، يبقى الرمز ضعيف.
     - تحقق إذا الموقع بيفرض Rate Limiting أو CAPTCHA بعد محاولات متكررة.
  6. لو مفيش قيود على المحاولات، يبقى فيه ثغرة خطيرة.
- **البيانات اللي هنجربها**:
  - رموز: `0000` إلى `9999` (لو 4 أرقام) أو أكواد عشوائية.
  - طلب: `https://target.com/mfa/verify?otp_code=[CODE]`.
- **النتيجة المتوقعة**:
  - نجاح: رمز تم تخمينه أو مفيش قيود على المحاولات، يعني MFA ضعيفة.
  - فشل: الموقع بيقفل الحساب أو بيفرض قيود بعد محاولات قليلة.
- **الأدوات**:
  - **Burp Suite Intruder**:
    - حدد حقل `otp_code` كـ Payload Position.
    - استخدم قائمة أكواد (مثل `0000` إلى `9999`).
  - **wfuzz**:
    ```bash
    wfuzz -c -z range,0000-9999 --hc 404 -d "otp_code=FUZZ" https://target.com/mfa/verify
    ```
  - **cURL**:
    ```bash
    curl -X POST -d "otp_code=0000" https://target.com/mfa/verify
    ```
- **الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z range,0000-9999 --hc 404 -d "otp_code=FUZZ" https://target.com/mfa/verify
    ```
  - cURL:
    ```bash
    curl -X POST -d "otp_code=0000" https://target.com/mfa/verify
    ```

---

#### **المحاولة السابعة: اختبار ثغرات في قنوات توصيل MFA**
**الهدف**: نشوف إذا كان قنوات توصيل رموز MFA (مثل SMS أو الإيميل) عرضة للاختراق أو التلاعب.
- **الخطوات**:
  1. اطلب رمز MFA عبر كل القنوات المتاحة (مثل SMS، إيميل، تطبيق مصادقة).
  2. حلل أمان القناة:
     - **SMS**: تحقق إذا كان الموقع بيستخدم قناة SMS مشفرة أو بيسمح بتغيير رقم الهاتف بدون تحقق قوي.
     - **إيميل**: جرب اعتراض الإيميل لو كان غير مشفر أو لو بيسمح بتغيير الإيميل بدون MFA.
     - **تطبيق مصادقة**: تحقق إذا كان التطبيق بيسمح بإعادة استخدام الرموز أو بيخزنها بشكل غير آمن.
  3. جرب هجمات عملية:
     - لو MFA عبر SMS، تحقق إذا كان فيه ثغرة SIM Swapping أو إذا كان رقم الهاتف يتغير بسهولة.
     - لو عبر إيميل، جرب إعادة توجيه الإيميل أو استغلال ثغرات في مزود الإيميل.
  4. استخدم Burp Suite عشان تعترض طلبات تغيير قناة MFA (مثل تغيير رقم الهاتف).
  5. لو الموقع بيسمح بتغيير قناة MFA بدون تحقق قوي (مثل OTP أو كلمة مرور)، يبقى فيه ثغرة.
- **البيانات اللي هنجربها**:
  - إيميل: `test@example.com`.
  - رقم هاتف: رقم تحت سيطرتك.
  - طلبات: تغيير إيميل/رقم هاتف.
- **النتيجة المتوقعة**:
  - نجاح: قناة MFA (مثل SMS أو إيميل) ضعيفة أو يمكن تغييرها بدون تحقق، يعني ثغرة.
  - فشل: القنوات محمية وتتطلب تحقق قوي.
- **الأدوات**:
  - **Burp Suite**: اعترض طلبات تغيير قناة MFA.
  - **cURL**:
    ```bash
    curl -X POST -d "email=newemail@example.com" https://target.com/settings/change-email
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=newemail@example.com" https://target.com/settings/change-email
    ```
  - Burp Suite:
    - اعترض طلب تغيير الإيميل أو رقم الهاتف.
    - تحقق إذا كان فيه طلب MFA.

---

### **ملخص شامل لكل المحاولات والأوامر**

هنا قائمة بكل المحاولات مع الأوامر والأدوات الخاصة بيها لاختبار Missing/Insecure Multi-Factor Authentication:

1. **غياب المصادقة متعددة العوامل**:
   - **البيانات**: حساب (`test@example.com`).
   - **الأدوات**: متصفح، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "username=test@example.com&password=password" https://target.com/login
     ```

2. **تعطيل أو تخطي MFA**:
   - **البيانات**: حساب مع MFA مفعلة.
   - **الأدوات**: Burp Suite، cURL، متصفح.
   - **الأوامر**:
     ```bash
     curl -X POST -d "mfa_enabled=false" https://target.com/settings/security
     ```

3. **ضعف رموز MFA**:
   - **البيانات**: رموز (`1234`، `0000`).
   - **الأدوات**: Burp Suite Intruder، cURL، Python.
   - **الأوامر**:
     ```bash
     curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
     ```
     ```python
     import requests
     url = "https://target.com/mfa/verify"
     credentials = {"username": "test@example.com", "password": "password"}
     otps = ["0000", "0001"]
     for otp in otps:
         data = {**credentials, "otp_code": otp}
         response = requests.post(url, data=data)
         print(f"OTP: {otp}, Status: {response.status_code}")
     ```

4. **استعادة الحساب**:
   - **البيانات**: إيميل (`test@example.com`)، إجابات أسئلة أمان.
   - **الأدوات**: متصفح، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=test@example.com" https://target.com/forgot-password
     ```

5. **تكرار أو إعادة استخدام رموز MFA**:
   - **البيانات**: رمز MFA واحد.
   - **الأدوات**: Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
     ```

6. **Brute Force على رموز MFA**:
   - **البيانات**: أكواد (`0000` إلى `9999`).
   - **الأدوات**: Burp Suite Intruder، wfuzz، cURL.
   - **الأوامر**:
     ```bash
     wfuzz -c -z range,0000-9999 --hc 404 -d "otp_code=FUZZ" https://target.com/mfa/verify
     ```

7. **ثغرات في قنوات توصيل MFA**:
   - **البيانات**: إيميل، رقم هاتف.
   - **الأدوات**: Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=newemail@example.com" https://target.com/settings/change-email
     ```

---

### **نصايح للاختبار**
- **الأخلاقيات**: لازم تكون عندك إذن صريح قبل ما تختبر أي موقع. الاختبار بدون إذن غير قانوني.
- **التجهيز**: استخدم حسابات وأرقام هواتف/إيميلات تحت سيطرتك. جهز قوائم أكواد محتملة لو الرموز قصيرة.
- **إعداد Burp Suite**: شغل Proxy واستخدم Intruder/Sequencer/Repeater لتحليل الرموز والطلبات.
- **التوثيق**: سجل كل الرموز، الردود، والنتايج لتقريرك.
- **فحص الحلول**: لو لقيت ثغرة، تأكد إذا الموقع بيفرض:
  - MFA إجبارية لكل الحسابات.
  - رموز MFA طويلة وعشوائية (مثل 6-8 أحرف).
  - صلاحية قصيرة للرموز (مثل 5 دقايق).
  - تحقق قوي لاستعادة الحساب.
  - Rate Limiting على محاولات إدخال الرموز.

---

### **مثال لنتيجة السيناريو**
- **غياب MFA**: تسجيل الدخول تم بدون أي تحقق إضافي.
- **تخطي MFA**: تعطيل MFA تم بدون OTP.
- **رمز ضعيف**: OTP من 4 أرقام (`1234`) تم تخمينه بسهولة.
- **استعادة الحساب**: رابط إعادة التعيين أُرسل بدون تحقق MFA.

لو محتاج مساعدة في إعداد الأدوات (زي Burp Suite أو wfuzz) أو عايز سكربتات إضافية لأتمتة الاختبار، قولي!



# اختبار غياب أو ضعف المصادقة متعددة العوامل (Missing/Insecure Multi-Factor Authentication)

دليل خطوة بخطوة لاختبار ثغرات غياب أو ضعف المصادقة متعددة العوامل في موقع إلكتروني. كل محاولة تتضمن وصفًا وتعليمات الاختبار وملخص الأوامر/الأدوات.

---

## المحاولة الأولى: غياب المصادقة متعددة العوامل
**الوصف**: اختبار إذا كان الموقع لا يطلب MFA أثناء تسجيل الدخول.
- **الخطوات**:
  1. سجل دخول إلى `https://target.com/login` بحساب تحت سيطرتك.
  2. تحقق إذا طُلب تحقق إضافي (مثل OTP).
  3. افحص إعدادات الحساب لخيار تفعيل MFA.
- **الأدوات/الأوامر**:
  - متصفح: سجل دخول يدويًا.
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password" https://target.com/login
    ```
  - Burp Suite: اعترض طلبات تسجيل الدخول.
- **الملخص**:
  - cURL: `curl -X POST -d "username=test@example.com&password=password" https://target.com/login`

---

## المحاولة الثانية: تعطيل أو تخطي MFA
**الوصف**: اختبار إذا كان يمكن تعطيل أو تخطي MFA بعد تفعيلها.
- **الخطوات**:
  1. فعّل MFA في إعدادات الحساب.
  2. حاول تعطيل MFA أو تخطي خطوة التحقق.
  3. عدّل طلبات تسجيل الدخول لإزالة حقل MFA.
- **الأدوات/الأوامر**:
  - Burp Suite: عدّل الطلبات.
  - cURL:
    ```bash
    curl -X POST -d "mfa_enabled=false" https://target.com/settings/security
    ```
- **الملخص**:
  - cURL: `curl -X POST -d "mfa_enabled=false" https://target.com/settings/security`

---

## المحاولة الثالثة: ضعف رموز MFA
**الوصف**: اختبار إذا كانت رموز MFA قصيرة أو قابلة للتخمين.
- **الخطوات**:
  1. اطلب رمز MFA وحلل طوله ونمطه.
  2. جرب تخمين الرمز أو تحليل عشوائيته.
  3. تحقق من صلاحية الرمز.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
  - Python:
    ```python
    import requests
    url = "https://target.com/mfa/verify"
    credentials = {"username": "test@example.com", "password": "password"}
    otps = ["0000", "0001"]
    for otp in otps:
        data = {**credentials, "otp_code": otp}
        response = requests.post(url, data=data)
        print(f"OTP: {otp}, Status: {response.status_code}")
    ```
  - Burp Suite Intruder: جرب أكواد متعددة.
- **الملخص**:
  - cURL: `curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify`
  - Python: `python test_otp_codes.py`

---

## المحاولة الرابعة: استعادة الحساب
**الوصف**: اختبار إذا كانت عملية استعادة الحساب تتطلب MFA.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور.
  2. تحقق إذا طُلب MFA أو أسئلة أمان.
  3. جرب تخمين إجابات أسئلة الأمان.
- **الأدوات/الأوامر**:
  - متصفح: جرب استعادة الحساب.
  - cURL:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
- **الملخص**:
  - cURL: `curl -X POST -d "email=test@example.com" https://target.com/forgot-password`

---

## المحاولة الخامسة: تكرار أو إعادة استخدام رموز MFA
**الوصف**: اختبار إذا كانت رموز MFA تتكرر أو صالحة لاستخدامات متعددة.
- **الخطوات**:
  1. اطلب رمز MFA واستخدمه.
  2. جرب نفس الرمز مرة أخرى.
  3. اطلب رموز متعددة وتحقق من التكرار.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify
    ```
- **الملخص**:
  - cURL: `curl -X POST -d "username=test@example.com&password=password&otp_code=1234" https://target.com/mfa/verify`

---

## المحاولة السادسة: Brute Force على رموز MFA
**الوصف**: اختبار إذا كانت رموز MFA عرضة للتخمين عبر Brute Force.
- **الخطوات**:
  1. حلل طول الرمز.
  2. جرب أكواد متعددة باستخدام أداة.
  3. تحقق من قيود المحاولات.
- **الأدوات/الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z range,0000-9999 --hc 404 -d "otp_code=FUZZ" https://target.com/mfa/verify
    ```
  - cURL:
    ```bash
    curl -X POST -d "otp_code=0000" https://target.com/mfa/verify
    ```
- **الملخص**:
  - wfuzz: `wfuzz -c -z range,0000-9999 --hc 404 -d "otp_code=FUZZ" https://target.com/mfa/verify`

---

## المحاولة السابعة: ثغرات في قنوات توصيل MFA
**الوصف**: اختبار إذا كانت قنوات توصيل MFA (مثل SMS/إيميل) ضعيفة.
- **الخطوات**:
  1. اطلب رمز MFA عبر القنوات المتاحة.
  2. تحقق من أمان القناة (مثل تشفير SMS/إيميل).
  3. جرب تغيير قناة MFA بدون تحقق.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=newemail@example.com" https://target.com/settings/change-email
    ```
- **الملخص**:
  - cURL: `curl -X POST -d "email=newemail@example.com" https://target.com/settings/change-email`

---

