**طريقة الاختبار**: هنختبر صفحة تسجيل الدخول، صفحة إعادة تعيين كلمة المرور، وصفحة التسجيل بشكل منهجي عشان نكتشف إذا كان الموقع بيفرق بين أسماء المستخدمين الصالحة وغير الصالحة. تحت هلاقي **كل المحاولات الممكنة** مقسمة حسب الطريقة.

---

#### **المحاولة الأولى: اختبار يدوي لصفحة تسجيل الدخول**
**الهدف**: نشوف إذا كان الموقع بيظهر رسايل خطأ مختلفة لأسماء مستخدمين موجودة وغير موجودة.
- **الخطوات**:
  1. افتح صفحة تسجيل الدخول (`https://target.com/login`).
  2. أدخل اسم مستخدم عشوائي (مثل `randomuser123`) مع كلمة مرور أي كلام (مثل `test`) واضغط تسجيل.
  3. سجل رسالة الخطأ اللي ظهرت (مثل "المستخدم غير موجود").
  4. أدخل اسم مستخدم متوقع يكون موجود (مثل `admin`، `user`، `test`) مع نفس كلمة المرور واضغط تسجيل.
  5. قارن رسايل الخطأ. لو الرسايل مختلفة (مثل "كلمة المرور غلط" مقابل "المستخدم غير موجود")، يبقى الموقع معرض للثغرة.
  6. جرب أكتر من اسم مستخدم (مثل `john`، `mary`، `guest`) عشان تتأكد من النمط.
- **أسماء المستخدمين اللي هنجربها**:
  - عشوائية: `randomuser123`، `nonexistent456`، `xyz789`
  - متوقعة: `admin`، `user`، `test`، `guest`، `support`، `john`، `mary`
- **النتيجة المتوقعة**:
  - نجاح: رسايل خطأ مختلفة (مثل "كلمة المرور غلط" لاسم موجود و"المستخدم غير موجود" لاسم غير موجود).
  - فشل: نفس رسالة الخطأ (مثل "بيانات تسجيل الدخول غلط") لكل الحالات، يعني الموقع محمي.
- **الأدوات**:
  - متصفح (مثل Chrome أو Firefox).
  - أدوات المتصفح (DevTools) عشان تتأكد من الردود (response) في تبويب Network.
- **الأوامر**:
  - مفيش أوامر محددة، بس هتكتب يدويًا في النموذج.
  - مثال: أدخل `username: randomuser123`، `password: test`، ثم `username: admin`، `password: test` وقارن الرسايل.

---

#### **المحاولة التانية: اختبار صفحة إعادة تعيين كلمة المرور**
**الهدف**: نشوف إذا كان الموقع بيظهر ردود مختلفة لإيميلات أو أسماء مستخدمين موجودة وغير موجودة في صفحة إعادة تعيين كلمة المرور.
- **الخطوات**:
  1. روح لصفحة إعادة تعيين كلمة المرور (مثل `https://target.com/forgot-password`).
  2. أدخل إيميل أو اسم مستخدم عشوائي (مثل `random@example.com` أو `randomuser123`).
  3. سجل الرسالة اللي ظهرت (مثل "هذا الإيميل غير مسجل").
  4. أدخل إيميل أو اسم مستخدم متوقع (مثل `admin@example.com` أو `admin`).
  5. قارن الرسايل. لو الرسالة مختلفة (مثل "تم إرسال رابط إعادة التعيين" مقابل "الإيميل غير موجود")، يبقى فيه ثغرة.
  6. جرب إيميلات شائعة (مثل `test@example.com`، `user@example.com`) عشان تتأكد.
- **البيانات اللي هنجربها**:
  - إيميلات عشوائية: `random@example.com`، `nonexistent@xyz.com`
  - إيميلات متوقعة: `admin@example.com`، `user@example.com`، `test@example.com`
  - أسماء مستخدمين: `admin`، `user`، `test` (لو الصفحة بتقبل أسماء بدل إيميلات)
- **النتيجة المتوقعة**:
  - نجاح: ردود مختلفة تكشف إذا كان الإيميل/المستخدم موجود.
  - فشل: رسالة عامة زي "لو الإيميل مسجل، هيترسلك رابط"، يعني الموقع محمي.
- **الأدوات**:
  - متصفح: أدخل البيانات يدويًا.
  - Burp Suite: عشان تعترض الطلبات وتشوف الردود في الـ Response.
- **الأوامر**:
  - **cURL** (لاختبار الطلب يدويًا):
    ```bash
    curl -X POST -d "email=random@example.com" https://target.com/forgot-password
    curl -X POST -d "email=admin@example.com" https://target.com/forgot-password
    ```
    - قارن الردود (Responses) لكل طلب.
  - لو بتستخدم Burp Suite:
    - شغل Proxy واعترض طلب إعادة التعيين.
    - استخدم Intruder عشان ترسل إيميلات متعددة وتحلل الردود (مثل طول الـ Response أو كلمات معينة).

---

#### **المحاولة التالتة: اختبار صفحة التسجيل**
**الهدف**: نشوف إذا كان الموقع بيكشف إذا كان الإيميل أو اسم المستخدم مسجل بالفعل أثناء التسجيل.
- **الخطوات**:
  1. روح لصفحة التسجيل (مثل `https://target.com/register`).
  2. حاول تسجل بإيميل عشوائي (مثل `random@example.com`) ولاحظ الرد.
  3. حاول تسجل بإيميل متوقع (مثل `admin@example.com` أو `user@example.com`).
  4. لو الموقع قال "الإيميل مسجل بالفعل" للإيميل المتوقع و"إيميل صالح" للعشوائي، يبقى فيه ثغرة.
  5. جرب أسماء مستخدمين لو النموذج بيطلبها (مثل `admin`، `test`).
  6. استخدم DevTools أو Burp Suite عشان تحلل ردود السيرفر (مثل رسايل JSON).
- **البيانات اللي هنجربها**:
  - إيميلات: `random@example.com`، `admin@example.com`، `user@example.com`
  - أسماء مستخدمين: `admin`، `test`، `randomuser123`
- **النتيجة المتوقعة**:
  - نجاح: رسايل زي "الإيميل مسجل" تكشف إيميلات موجودة.
  - فشل: رسالة عامة زي "تم التسجيل أو خطأ عام"، يعني الموقع محمي.
- **الأدوات**:
  - متصفح: أدخل البيانات يدويًا.
  - DevTools: شوف ردود الـ AJAX في تبويب Network.
  - Burp Suite: عشان تعترض طلبات التسجيل.
- **الأوامر**:
  - **cURL**:
    ```bash
    curl -X POST -d "email=random@example.com&username=randomuser123" https://target.com/register
    curl -X POST -d "email=admin@example.com&username=admin" https://target.com/register
    ```
    - قارن الردود لكشف الفرق.
  - Burp Intruder:
    - حمل قائمة إيميلات (مثل `emails.txt`) واستخدمها في حقل `email`.
    - حلل الردود بناءً على الكلمات (مثل "registered") أو طول الـ Response.

---

#### **المحاولة الرابعة: اختبار API Endpoints**
**الهدف**: نشوف إذا كان الـ API بتاع الموقع (لو موجود) بيكشف أسماء مستخدمين صالحة.
- **الخطوات**:
  1. حدد نقاط الـ API لتسجيل الدخول أو إعادة تعيين كلمة المرور (مثل `/api/login` أو `/api/forgot-password`) باستخدام وثائق الموقع أو Burp Suite Site Map.
  2. أرسل طلبات للـ API بأسماء مستخدمين أو إيميلات عشوائية ومتوقعة.
  3. حلل الردود (مثل JSON أو أكواد HTTP) عشان تشوف إذا فيه فرق.
  4. جرب أدوات زي Postman أو cURL لإرسال الطلبات.
  5. لو الـ API بيدي ردود مختلفة (مثل `{"error": "Invalid password"}` مقابل `{"error": "User not found"}`)، يبقى فيه ثغرة.
- **البيانات اللي هنجربها**:
  - JSON:
    ```json
    {"username": "randomuser123", "password": "test"}
    {"username": "admin", "password": "test"}
    ```
  - إيميلات: `random@example.com`، `admin@example.com`
- **النتيجة المتوقعة**:
  - نجاح: ردود الـ API تكشف أسماء مستخدمين موجودة.
  - فشل: ردود عامة زي `{"error": "Invalid credentials"}`، يعني الـ API محمي.
- **الأدوات**:
  - **Postman**: أرسل طلبات API.
  - **cURL**:
    ```bash
    curl -X POST -H "Content-Type: application/json" -d '{"username":"randomuser123","password":"test"}' https://target.com/api/login
    curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"test"}' https://target.com/api/login
    ```
  - **Burp Suite**: اعترض واختبر ردود الـ API.
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -H "Content-Type: application/json" -d '{"username":"randomuser123","password":"test"}' https://target.com/api/login
    curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"test"}' https://target.com/api/login
    ```
  - Burp Intruder: استخدم قائمة أسماء مستخدمين وحلل الردود.

---

#### **المحاولة الخامسة: اختبار التوقيت (Timing-Based Enumeration)**
**الهدف**: نشوف إذا كان الموقع بيستغرق وقت أطول في معالجة أسماء مستخدمين موجودة مقارنة بغير الموجودة.
- **الخطوات**:
  1. استخدم أداة زي Burp Suite أو سكربت Python عشان ترسل طلبات تسجيل دخول بأسماء مستخدمين مختلفة.
  2. قيس وقت الرد (Response Time) لكل طلب باستخدام أدوات زي `curl` مع `--write-out` أو Burp Suite.
  3. جرب اسم مستخدم عشوائي (مثل `randomuser123`) واسم متوقع (مثل `admin`).
  4. لو فيه فرق واضح في وقت الرد (مثل 200ms لاسم موجود مقابل 50ms لاسم غير موجود)، يبقى فيه ثغرة.
  5. كرر الاختبار كذا مرة عشان تتأكد من النتايج وتتجنب تأثير الشبكة.
- **البيانات اللي هنجربها**:
  - أسماء مستخدمين: `randomuser123`، `admin`، `user`، `test`
- **النتيجة المتوقعة**:
  - نجاح: وقت رد أطول لأسماء موجودة، يعني الموقع بيعمل فحص إضافي.
  - فشل: وقت الرد ثابت تقريبًا، يعني الموقع محمي.
- **الأدوات**:
  - **cURL**:
    ```bash
    curl -w "Time: %{time_total}s\n" -X POST -d "username=randomuser123&password=test" https://target.com/login
    curl -w "Time: %{time_total}s\n" -X POST -d "username=admin&password=test" https://target.com/login
    ```
  - **Python Script** (باستخدام `requests`):
    ```python
    import requests
    import time

    url = "https://target.com/login"
    users = ["randomuser123", "admin", "user"]

    for user in users:
        start = time.time()
        response = requests.post(url, data={"username": user, "password": "test"})
        end = time.time()
        print(f"User: {user}, Time: {end - start:.3f}s, Response: {response.text[:50]}")
    ```
  - **Burp Suite**: استخدم Intruder وقيس وقت الرد في عمود Response Time.
- **الأوامر**:
  - cURL:
    ```bash
    curl -w "Time: %{time_total}s\n" -X POST -d "username=randomuser123&password=test" https://target.com/login
    curl -w "Time: %{time_total}s\n" -X POST -d "username=admin&password=test" https://target.com/login
    ```
  - Python: `python timing_enumeration.py` (احفظ السكربت فوق).

---

#### **المحاولة السادسة: اختبار ردود HTTP Status Codes**
**الهدف**: نشوف إذا كان الموقع بيرد بأكواد HTTP مختلفة (مثل 200، 403، 404) بناءً على وجود اسم المستخدم.
- **الخطوات**:
  1. استخدم Burp Suite أو cURL عشان ترسل طلبات تسجيل دخول بأسماء مستخدمين مختلفة.
  2. سجل كود الـ HTTP Status (مثل 200 OK، 401 Unauthorized) لكل طلب.
  3. جرب اسم مستخدم عشوائي (مثل `randomuser123`) واسم متوقع (مثل `admin`).
  4. لو فيه فرق في الأكواد (مثل 200 لاسم موجود و404 لاسم غير موجود)، يبقى فيه ثغرة.
  5. تحقق من الردود في الـ API أو صفحات أخرى (زي `/forgot-password`).
- **البيانات اللي هنجربها**:
  - أسماء مستخدمين: `randomuser123`، `admin`، `user`
  - إيميلات: `random@example.com`، `admin@example.com`
- **النتيجة المتوقعة**:
  - نجاح: أكواد HTTP مختلفة تكشف أسماء موجودة.
  - فشل: نفس الكود (مثل 401 لكل الحالات)، يعني الموقع محمي.
- **الأدوات**:
  - **cURL**:
    ```bash
    curl -i -X POST -d "username=randomuser123&password=test" https://target.com/login
    curl -i -X POST -d "username=admin&password=test" https://target.com/login
    ```
    - الـ `-i` بيظهر الـ Headers، بما فيها كود الـ Status.
  - **Burp Suite**: اعترض الطلبات وشوف كود الـ Status في الـ Response.
- **الأوامر**:
  - cURL:
    ```bash
    curl -i -X POST -d "username=randomuser123&password=test" https://target.com/login
    curl -i -X POST -d "username=admin&password=test" https://target.com/login
    ```

---

#### **المحاولة السابعة: أتمتة الاختبار باستخدام أدوات**
**الهدف**: أتمتة عملية Username Enumeration عشان تختبر عدد كبير من أسماء المستخدمين بسرعة.
- **الخطوات**:
  1. جهز قائمة بأسماء مستخدمين محتملة (مثل `usernames.txt`) تحتوي على أسماء شائعة (زي `admin`، `user`) وأسماء عشوائية.
  2. استخدم Burp Suite Intruder أو سكربت Python عشان ترسل طلبات متعددة.
  3. حلل الردود بناءً على:
     - نص الرسالة (مثل "Invalid password" مقابل "User not found").
     - طول الـ Response (Response Length).
     - وقت الرد (Response Time).
     - كود الـ HTTP Status.
  4. لو لقيت نمط في الردود (مثل رسايل مختلفة أو أطوال مختلفة)، يبقى فيه ثغرة.
  5. سجل الأسماء الصالحة لاستخدامها في هجمات لاحقة (زي Brute Force).
- **البيانات اللي هنجربها**:
  - ملف `usernames.txt`:
    ```
    admin
    user
    test
    guest
    randomuser123
    nonexistent456
    ```
  - إيميلات (لو الموقع بيستخدم إيميلات):
    ```
    admin@example.com
    user@example.com
    random@example.com
    ```
- **النتيجة المتوقعة**:
  - نجاح: قائمة بأسماء مستخدمين صالحة بناءً على الردود.
  - فشل: ردود متشابهة لكل الأسماء، يعني الموقع محمي.
- **الأدوات**:
  - **Burp Suite Intruder**:
    - اعترض طلب تسجيل الدخول.
    - حدد حقل `username` كـ Payload Position.
    - حمل ملف `usernames.txt` وابدأ الهجوم.
    - حلل الردود في عمود Response Length أو ابحث عن كلمات زي "invalid" أو "not found".
  - **Python Script**:
    ```python
    import requests

    url = "https://target.com/login"
    usernames = ["randomuser123", "admin", "user", "test"]

    for username in usernames:
        response = requests.post(url, data={"username": username, "password": "test"})
        print(f"Username: {username}, Response Length: {len(response.text)}, Text: {response.text[:50]}")
    ```
  - **wfuzz** (أداة أتمتة):
    ```bash
    wfuzz -c -z file,usernames.txt --hc 404 -d "username=FUZZ&password=test" https://target.com/login
    ```
    - `-z file,usernames.txt`: استخدم قائمة أسماء المستخدمين.
    - `--hc 404`: إخفاء الردود بكود 404.
    - `-d`: البيانات المرسلة في الطلب.
- **الأوامر**:
  - Python: `python enumerate_usernames.py` (احفظ السكربت فوق).
  - wfuzz:
    ```bash
    wfuzz -c -z file,usernames.txt --hc 404 -d "username=FUZZ&password=test" https://target.com/login
    ```
  - Burp Intruder: استخدم قائمة `usernames.txt` وحلل الردود.

---

### **ملخص شامل لكل المحاولات والأوامر**

هنا قائمة بكل المحاولات مع الأوامر والأدوات الخاصة بيها لاختبار Username Enumeration:

1. **اختبار يدوي لصفحة تسجيل الدخول**:
   - **البيانات**: أسماء عشوائية (`randomuser123`) ومتوقعة (`admin`، `user`).
   - **الأداة**: متصفح، DevTools.
   - **الأمر**: مفيش؛ أدخل يدويًا وقارن رسايل الخطأ.

2. **اختبار صفحة إعادة تعيين كلمة المرور**:
   - **البيانات**: إيميلات (`random@example.com`، `admin@example.com`)، أسماء (`admin`، `test`).
   - **الأدوات**: متصفح، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=random@example.com" https://target.com/forgot-password
     curl -X POST -d "email=admin@example.com" https://target.com/forgot-password
     ```

3. **اختبار صفحة التسجيل**:
   - **البيانات**: إيميلات (`random@example.com`، `admin@example.com`)، أسماء (`admin`، `randomuser123`).
   - **الأدوات**: متصفح، DevTools، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=random@example.com&username=randomuser123" https://target.com/register
     curl -X POST -d "email=admin@example.com&username=admin" https://target.com/register
     ```

4. **اختبار API Endpoints**:
   - **البيانات**: `{"username": "randomuser123", "password": "test"}`، `{"username": "admin", "password": "test"}`.
   - **الأدوات**: Postman، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -X POST -H "Content-Type: application/json" -d '{"username":"randomuser123","password":"test"}' https://target.com/api/login
     curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"test"}' https://target.com/api/login
     ```

5. **اختبار التوقيت (Timing-Based)**:
   - **البيانات**: أسماء (`randomuser123`، `admin`).
   - **الأدوات**: cURL، Burp Suite، Python.
   - **الأوامر**:
     ```bash
     curl -w "Time: %{time_total}s\n" -X POST -d "username=randomuser123&password=test" https://target.com/login
     curl -w "Time: %{time_total}s\n" -X POST -d "username=admin&password=test" https://target.com/login
     ```
     ```python
     import requests
     import time
     url = "https://target.com/login"
     users = ["randomuser123", "admin"]
     for user in users:
         start = time.time()
         response = requests.post(url, data={"username": user, "password": "test"})
         end = time.time()
         print(f"User: {user}, Time: {end - start:.3f}s")
     ```

6. **اختبار ردود HTTP Status Codes**:
   - **البيانات**: أسماء (`randomuser123`، `admin`).
   - **الأدوات**: cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -i -X POST -d "username=randomuser123&password=test" https://target.com/login
     curl -i -X POST -d "username=admin&password=test" https://target.com/login
     ```

7. **أتمتة الاختبار**:
   - **البيانات**: ملف `usernames.txt` (`admin`، `user`، `randomuser123`).
   - **الأدوات**: Burp Suite Intruder، Python، wfuzz.
   - **الأوامر**:
     ```python
     import requests
     url = "https://target.com/login"
     usernames = ["randomuser123", "admin"]
     for username in usernames:
         response = requests.post(url, data={"username": username, "password": "test"})
         print(f"Username: {username}, Length: {len(response.text)}")
     ```
     ```bash
     wfuzz -c -z file,usernames.txt --hc 404 -d "username=FUZZ&password=test" https://target.com/login
     ```

---

### **مثال لنتيجة السيناريو**
- **ثغرة في تسجيل الدخول**: رد "كلمة المرور غلط" لـ `admin` و"المستخدم غير موجود" لـ `randomuser123`.
- **ثغرة في إعادة التعيين**: رسالة "تم إرسال الرابط" لـ `admin@example.com` و"الإيميل غير مسجل" لـ `random@example.com`.
- **ثغرة API**: الـ API بيرد بـ `{"error": "Invalid password"}` لـ `admin` و`{"error": "User not found"}` لـ `randomuser123`.
- **توقيت**: رد `admin` استغرق 300ms بينما `randomuser123` استغرق 100ms.

