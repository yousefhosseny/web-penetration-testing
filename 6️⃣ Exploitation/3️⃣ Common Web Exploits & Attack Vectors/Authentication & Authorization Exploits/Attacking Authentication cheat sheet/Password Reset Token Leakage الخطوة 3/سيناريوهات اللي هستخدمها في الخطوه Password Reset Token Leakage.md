## هام جدا 
- السيناريوهات اللي بقولهالك هي فكره ممكن تحصل لكن مش شرط تعمل نفس الخطوات الموجوده يعني مثلا يمكن استخدم نفس التوكين ل email تاني مش شرط تعمل نفس الخطوات اللي مديهالك  لكن ممكن تدور علي طريقه تعمل السيناريو ده 




**طريقة الاختبار**: هنختبر خاصية إعادة تعيين كلمة المرور بشكل منهجي عشان نكتشف إذا كان التوكن بيتسرّب أو ممكن يتخمن أو يُستخدم بطريقة غلط. هنركز على صفحة طلب إعادة التعيين، رابط التوكن، وردود السيرفر. تحت هلاقي **كل المحاولات الممكنة** مقسمة حسب الطريقة.

---

#### **المحاولة الأولى: اختبار تسريب التوكن في ردود السيرفر**
**الهدف**: نشوف إذا كان الموقع بيعرض رمز إعادة التعيين (Token) في رد السيرفر (Response) لما نطلب إعادة تعيين كلمة المرور.
- **الخطوات**:
  1. روح لصفحة إعادة تعيين كلمة المرور (مثل `https://target.com/forgot-password`).
  2. أدخل إيميل مستخدم صالح (مثل `test@example.com`) أو اسم مستخدم (لو النظام بيستخدم أسماء).
  3. استخدم Burp Suite عشان تعترض طلب إعادة التعيين (عادةً طلب POST).
  4. حلل رد السيرفر (Response) في Burp Suite أو DevTools (تبويب Network).
  5. ابحث عن أي بيانات حساسة في الـ Response، زي:
     - رمز التوكن نفسه (مثل `reset_token=abc123`).
     - رابط إعادة التعيين كامل (مثل `https://target.com/reset?token=abc123`).
     - JSON بيحتوي على التوكن (مثل `{"token": "abc123"}`).
  6. لو التوكن موجود في الـ Response، يبقى فيه ثغرة، لأن أي مهاجم يقدر يعترض الطلب ويستخدم التوكن.
- **البيانات اللي هنجربها**:
  - إيميلات: `test@example.com`، `admin@example.com`
  - أسماء مستخدمين (لو النظام بيستخدمها): `test`، `admin`
- **النتيجة المتوقعة**:
  - نجاح: التوكن أو رابط إعادة التعيين موجود في رد السيرفر، يعني فيه تسريب.
  - فشل: الـ Response عام (مثل "تم إرسال رابط إعادة التعيين") ومافيهوش بيانات حساسة.
- **الأدوات**:
  - **Burp Suite**: عشان تعترض الطلب وتحلل الـ Response.
  - **DevTools**: تابع طلبات الـ POST في تبويب Network.
  - **cURL**:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
    - شوف الرد (Response) لو فيه توكن أو رابط.
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
  - Burp Suite:
    - شغل Proxy واعترض طلب الـ POST.
    - ابحث في الـ Response عن كلمات زي `token`، `reset`، أو رابط.

---

#### **المحاولة التانية: اختبار توكن قابل للتخمين (Predictable Token)**
**الهدف**: نشوف إذا كان التوكن اللي بيتبعت في رابط إعادة التعيين قصير أو متوقع أو بيتبع نمط يسهل تخمينه.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور لإيميل تحت سيطرتك (مثل `youremail@example.com`).
  2. استلم رابط إعادة التعيين في الإيميل (مثل `https://target.com/reset?token=abc123`).
  3. حلل التوكن:
     - طول التوكن: لو قصير جدًا (مثل 4-6 أحرف)، يبقى قابل للتخمين.
     - نمط التوكن: لو أرقام بس (مثل `123456`) أو حروف متكررة، يبقى ضعيف.
     - تنسيق التوكن: لو بيستخدم Base64 أو MD5 لمعلومات متوقعة (زي اسم المستخدم أو تاريخ)، يبقى قابل للتخمين.
  4. جرب طلب توكنات متعددة بنفس الإيميل أو إيميلات مختلفة (مثل `test1@example.com`، `test2@example.com`).
  5. قارن التوكنات:
     - لو التوكنات متشابهة أو بتتغير بشكل متوقع (مثل زيادة رقم بـ 1)، يبقى فيه ثغرة.
     - لو التوكن بيتكرر لنفس الإيميل، يبقى فيه مشكلة في التوليد.
  6. استخدم أداة زي Burp Suite Sequencer عشان تحلل عشوائية التوكنات (Randomness).
- **البيانات اللي هنجربها**:
  - إيميلات: `youremail@example.com`، `test1@example.com`، `test2@example.com`
  - أسماء مستخدمين: `test`، `admin`
- **النتيجة المتوقعة**:
  - نجاح: توكن قصير (مثل `1234`) أو متوقع (مثل `user1_001`) أو متكرر، يعني قابل للتخمين.
  - فشل: توكن طويل (مثل 32 حرف عشوائي) وعشوائي تمامًا (مثل UUID)، يعني محمي.
- **الأدوات**:
  - **Burp Suite Sequencer**: عشان تحلل عشوائية التوكنات.
  - **cURL**:
    ```bash
    curl -X POST -d "email=youremail@example.com" https://target.com/forgot-password
    ```
    - كرر الطلب كذا مرة واستلم التوكنات من الإيميل.
  - **Python Script** (لطلب توكنات متعددة):
    ```python
    import requests

    url = "https://target.com/forgot-password"
    emails = ["youremail@example.com", "test1@example.com"]

    for email in emails:
        response = requests.post(url, data={"email": email})
        print(f"Email: {email}, Response: {response.text[:100]}")
    ```
    - استخدم الإيميل عشان تستلم التوكنات وتحللها يدويًا.
- **الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=youremail@example.com" https://target.com/forgot-password
    ```
  - Python: `python request_tokens.py` (احفظ السكربت فوق).
  - Burp Suite Sequencer:
    - اجمع توكنات متعددة (من الإيميلات).
    - استخدم Sequencer عشان تحلل Entropy (العشوائية).

---

#### **المحاولة التالتة: اختبار إعادة استخدام التوكن أو عدم انتهاء صلاحيته**
**الهدف**: نشوف إذا كان التوكن بيتكرر أو بيظل صالح لمدة طويلة جدًا (مثل أيام أو إلى الأبد).
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور لإيميل تحت سيطرتك (مثل `youremail@example.com`).
  2. استلم رابط إعادة التعيين (مثل `https://target.com/reset?token=abc123`).
  3. حاول استخدام الرابط/التوكن مباشرة في المتصفح.
  4. اطلب إعادة تعيين مرة تانية بنفس الإيميل وشوف إذا كان التوكن اتغير أو لسه نفس التوكن.
  5. جرب استخدام التوكن الأول بعد فترة (مثل ساعة، يوم، يومين) عشان تشوف إذا كان لسه صالح.
  6. لو التوكن بيتكرر أو ما بيبطلش صلاحيته بسرعة (مثل خلال 10-15 دقيقة)، يبقى فيه ثغرة.
  7. استخدم Burp Suite عشان ترسل طلبات متكررة للتحقق من التوكن.
- **البيانات اللي هنجربها**:
  - إيميل: `youremail@example.com`
  - توكنات: التوكن الأول والتوكنات الجديدة من طلبات متكررة.
- **النتيجة المتوقعة**:
  - نجاح: التوكن بيتكرر أو بيظل صالح لمدة طويلة (مثل يوم)، يعني معرض للاستغلال.
  - فشل: التوكن بيبطل صلاحيته بسرعة (مثل 10 دقايق) أو بيتغير مع كل طلب جديد.
- **الأدوات**:
  - **متصفح**: جرب الرابط يدويًا.
  - **Burp Suite Repeater**: أرسل طلبات متكررة للتحقق من التوكن.
  - **cURL**:
    ```bash
    curl https://target.com/reset?token=abc123
    ```
    - جرب الرابط بعد فترات زمنية مختلفة.
- **الأوامر**:
  - cURL:
    ```bash
    curl https://target.com/reset?token=abc123
    ```
  - Burp Suite Repeater:
    - احفظ طلب التوكن (GET أو POST) وكرره بعد فترات.
    - راقب الردود (مثل 200 OK لتوكن صالح أو 403/404 لتوكن باطل).

---

#### **المحاولة الرابعة: اختبار التوكن عبر استبدال الإيميل (Email Parameter Tampering)**
**الهدف**: نشوف إذا كان التوكن بيعتمد على إيميل المستخدم وبيسمح باستخدامه مع إيميل تاني.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور لإيميل تحت سيطرتك (مثل `youremail@example.com`).
  2. استلم رابط التوكن (مثل `https://target.com/reset?token=abc123&email=youremail@example.com`).
  3. عدّل الإيميل في الرابط لإيميل مستخدم تاني (مثل `victim@example.com`):
     - `https://target.com/reset?token=abc123&email=victim@example.com`
  4. افتح الرابط المعدل في المتصفح أو استخدم cURL/Burp Suite.
  5. لو الرابط المعدل سمحلك تغير كلمة مرور الحساب التاني (`victim@example.com`)، يبقى فيه ثغرة.
  6. جرب نفس التوكن مع إيميلات مختلفة عشان تتأكد من النطاق.
- **البيانات اللي هنجربها**:
  - إيميل أصلي: `youremail@example.com`
  - إيميلات معدلة: `victim@example.com`، `admin@example.com`
  - توكن: التوكن الأصلي (مثل `abc123`)
- **النتيجة المتوقعة**:
  - نجاح: التوكن بيشتغل مع إيميلات تانية، يعني الموقع ما بيربطش التوكن بالإيميل بشكل صحيح.
  - فشل: الرابط المعدل بيطلع خطأ (مثل "Token invalid")، يعني التوكن مربوط بالإيميل.
- **الأدوات**:
  - **متصفح**: عدّل الرابط يدويًا.
  - **cURL**:
    ```bash
    curl https://target.com/reset?token=abc123&email=victim@example.com
    ```
  - **Burp Suite**: عدّل الـ Parameter في الطلب وشوف الرد.
- **الأوامر**:
  - cURL:
    ```bash
    curl https://target.com/reset?token=abc123&email=victim@example.com
    ```
  - Burp Suite:
    - اعترض طلب الـ GET للرابط.
    - عدّل حقل `email` في الـ Query String وأرسل الطلب.

---

#### **المحاولة الخامسة: اختبار تسريب التوكن عبر الـ Referer Header**
**الهدف**: نشوف إذا كان رابط إعادة التعيين (اللي فيه التوكن) بيتسرّب عبر الـ Referer Header لما المستخدم يضغط على لينكات خارجية.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور لإيميل تحت سيطرتك.
  2. استلم رابط إعادة التعيين (مثل `https://target.com/reset?token=abc123`).
  3. افتح الرابط في المتصفح.
  4. من صفحة إعادة التعيين، اضغط على لينك خارجي (مثل زر "Contact Us" أو لينك لموقع تاني زي Twitter).
  5. استخدم Burp Suite عشان تعترض الطلب للرابط الخارجي وتشوف الـ Referer Header.
  6. لو الـ Referer Header فيه رابط إعادة التعيين بالتوكن (مثل `Referer: https://target.com/reset?token=abc123`)، يبقى فيه ثغرة، لأن التوكن ممكن يتسرّب لمواقع خارجية.
  7. جرب نفس العملية مع لينكات مختلفة في الصفحة.
- **البيانات اللي هنجربها**:
  - رابط إعادة التعيين: `https://target.com/reset?token=abc123`
  - لينكات خارجية: أي لينك في صفحة إعادة التعيين (زي "Contact Us" أو روابط وسائل التواصل).
- **النتيجة المتوقعة**:
  - نجاح: الـ Referer Header بيحتوي على التوكن، يعني ممكن يتسرّب.
  - فشل: الـ Referer Header فاضي أو مافيهوش التوكن، يعني الموقع محمي.
- **الأدوات**:
  - **Burp Suite**: عشان تعترض الطلبات وتشوف الـ Referer Header.
  - **DevTools**: تابع الطلبات في تبويب Network وشوف الـ Headers.
- **الأوامر**:
  - Burp Suite:
    - شغل Proxy واضغط على لينك خارجي من صفحة إعادة التعيين.
    - ابحث في الـ Request عن حقل `Referer`.
  - **cURL** (لاختبار يدوي):
    ```bash
    curl -I -e "https://target.com/reset?token=abc123" https://external.com
    ```
    - الـ `-e` بيحدد الـ Referer، و`-I` بيجيب الـ Headers بس.

---

#### **المحاولة السادسة: اختبار التوكن عبر هجمات Brute Force**
**الهدف**: نشوف إذا كان التوكن قصير أو ضعيف لدرجة إن المهاجم يقدر يخمنه باستخدام Brute Force.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور واستلم رابط التوكن.
  2. حلل طول التوكن وتنسيقه (مثل `123456` أو `abc123`).
  3. لو التوكن قصير (مثل 4-6 أحرف)، استخدم أداة زي Burp Suite Intruder أو wfuzz عشان تجرب توكنات مختلفة.
  4. جهز قائمة توكنات محتملة (مثل أرقام من `000000` لـ `999999` لو التوكن أرقام بس).
  5. أرسل طلبات للرابط مع توكنات مختلفة (مثل `https://target.com/reset?token=000001`).
  6. لو نجحت في إيجاد توكن صالح (رد 200 OK أو صفحة إعادة تعيين)، يبقى التوكن ضعيف جدًا.
  7. راقب إذا الموقع بيفرض قيود على المحاولات (مثل Rate Limiting أو CAPTCHA).
- **البيانات اللي هنجربها**:
  - توكنات: `000001`، `000002`، ... (لو أرقام)، أو `aaaa`، `aaab` (لو حروف).
  - رابط: `https://target.com/reset?token=[TOKEN]`
- **النتيجة المتوقعة**:
  - نجاح: توكن صالح تم اكتشافه بسهولة، يعني التوكن ضعيف.
  - فشل: ردود خطأ (مثل 403 أو 404) أو قيود على المحاولات، يعني التوكن محمي.
- **الأدوات**:
  - **Burp Suite Intruder**:
    - اعترض طلب الرابط.
    - حدد حقل `token` كـ Payload Position.
    - استخدم قائمة توكنات (مثل أرقام أو حروف).
  - **wfuzz**:
    ```bash
    wfuzz -c -z range,000000-999999 --hc 404 https://target.com/reset?token=FUZZ
    ```
  - **cURL**:
    ```bash
    curl https://target.com/reset?token=000001
    ```
- **الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z range,000000-999999 --hc 404 https://target.com/reset?token=FUZZ
    ```
  - cURL:
    ```bash
    curl https://target.com/reset?token=000001
    ```
  - Burp Suite Intruder:
    - استخدم Payload Type زي Numeric أو Brute Forcer.
    - حلل الردود (مثل 200 OK لتوكن صالح).

---

#### **المحاولة السابعة: اختبار سوء إعداد التوكن عبر الـ Session أو الـ Cookies**
**الهدف**: نشوف إذا كان التوكن بيتخزن في الـ Cookies أو الـ Session بطريقة تجعله عرضة للتسريب أو الاستغلال.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور واستلم رابط التوكن.
  2. افتح الرابط في المتصفح.
  3. استخدم DevTools (تبويب Application) أو Burp Suite عشان تتفقد الـ Cookies المرتبطة بالطلب.
  4. ابحث عن أي Cookies فيها التوكن أو بيانات مشابهة (مثل `reset_token=abc123`).
  5. لو لقيت التوكن في الـ Cookies، جرب استخدامه في متصفح تاني أو جلسة مختلفة.
  6. تحقق إذا كان التوكن مربوط بـ Session ID معين:
     - غيّر الـ Session ID في الـ Cookie وجرب التوكن تاني.
     - لو التوكن اشتغل مع Session مختلف، يبقى فيه ثغرة.
  7. جرب اعتراض الطلبات أثناء إعادة التعيين عشان تشوف إذا التوكن بيتخزن في مكان غير آمن.
- **البيانات اللي هنجربها**:
  - رابط: `https://target.com/reset?token=abc123`
  - Cookies: أي Cookie بيحتوي على `reset_token` أو بيانات مشابهة.
- **النتيجة المتوقعة**:
  - نجاح: التوكن موجود في الـ Cookies أو بيشتغل مع جلسات مختلفة، يعني معرض للتسريب.
  - فشل: التوكن مربوط بـ Session معين أو مش موجود في الـ Cookies، يعني محمي.
- **الأدوات**:
  - **DevTools**: تفقد الـ Cookies في تبويب Application.
  - **Burp Suite**: اعترض الطلبات وتفقد الـ Cookies في الـ Request/Response.
  - **cURL**:
    ```bash
    curl -b "session=abc123" https://target.com/reset?token=abc123
    ```
    - عدّل الـ Cookie وجرب الطلب.
- **الأوامر**:
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/reset?token=abc123
    ```
  - Burp Suite:
    - اعترض طلب الرابط.
    - تفقد الـ Cookies في الـ Request.
    - عدّل الـ Session ID وأرسل الطلب تاني.

---

### **ملخص شامل لكل المحاولات والأوامر**

هنا قائمة بكل المحاولات مع الأوامر والأدوات الخاصة بيها لاختبار Password Reset Token Leakage:

1. **تسريب التوكن في ردود السيرفر**:
   - **البيانات**: إيميلات (`test@example.com`).
   - **الأدوات**: Burp Suite، DevTools، cURL.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=test@example.com" https://target.com/forgot-password
     ```

2. **توكن قابل للتخمين**:
   - **البيانات**: إيميلات (`youremail@example.com`).
   - **الأدوات**: Burp Suite Sequencer، cURL، Python.
   - **الأوامر**:
     ```bash
     curl -X POST -d "email=youremail@example.com" https://target.com/forgot-password
     ```
     ```python
     import requests
     url = "https://target.com/forgot-password"
     emails = ["youremail@example.com"]
     for email in emails:
         response = requests.post(url, data={"email": email})
         print(f"Email: {email}, Response: {response.text[:100]}")
     ```

3. **إعادة استخدام التوكن أو عدم انتهاء صلاحيته**:
   - **البيانات**: رابط التوكن (`https://target.com/reset?token=abc123`).
   - **الأدوات**: متصفح، Burp Suite Repeater، cURL.
   - **الأوامر**:
     ```bash
     curl https://target.com/reset?token=abc123
     ```

4. **التوكن عبر استبدال الإيميل**:
   - **البيانات**: رابط مع إيميل معدل (`https://target.com/reset?token=abc123&email=victim@example.com`).
   - **الأدوات**: متصفح، cURL، Burp Suite.
   - **الأوامر**:
     ```bash
     curl https://target.com/reset?token=abc123&email=victim@example.com
     ```

5. **تسريب التوكن عبر الـ Referer Header**:
   - **البيانات**: رابط إعادة التعيين (`https://target.com/reset?token=abc123`).
   - **الأدوات**: Burp Suite، DevTools.
   - **الأوامر**:
     ```bash
     curl -I -e "https://target.com/reset?token=abc123" https://external.com
     ```

6. **Brute Force على التوكن**:
   - **البيانات**: توكنات محتملة (`000001`، `000002`).
   - **الأدوات**: Burp Suite Intruder، wfuzz، cURL.
   - **الأوامر**:
     ```bash
     wfuzz -c -z range,000000-999999 --hc 404 https://target.com/reset?token=FUZZ
     ```
     ```bash
     curl https://target.com/reset?token=000001
     ```

7. **سوء إعداد التوكن عبر الـ Session أو الـ Cookies**:
   - **البيانات**: رابط التوكن وCookies.
   - **الأدوات**: DevTools، Burp Suite، cURL.
   - **الأوامر**:
     ```bash
     curl -b "session=abc123" https://target.com/reset?token=abc123
     ```

---

### **نصايح للاختبار**
- **الأخلاقيات**: لازم تكون عندك إذن صريح قبل ما تختبر أي موقع. الاختبار بدون إذن غير قانوني.
- **التجهيز**: استخدم إيميل تحت سيطرتك عشان تستلم التوكنات. جهز قوائم توكنات محتملة لو التوكن قصير.
- **إعداد Burp Suite**: شغل Proxy واستخدم Intruder/Sequencer/Repeater لتحليل التوكنات والردود.
- **التوثيق**: سجل كل التوكنات، الردود، والنتايج لتقريرك.
- **فحص الحلول**: لو لقيت ثغرة، تأكد إذا الموقع بيفرض:
  - توكنات طويلة وعشوائية (مثل UUID).
  - صلاحية قصيرة للتوكن (مثل 10-15 دقيقة).
  - ربط التوكن بالإيميل أو الـ Session.
  - حماية ضد تسريب الـ Referer (زي إعداد `Referrer-Policy`).

---

### **مثال لنتيجة السيناريو**
- **تسريب في الـ Response**: رد السيرفر بيحتوي على `{"token": "abc123"}`.
- **توكن ضعيف**: توكن زي `123456` تم تخمينه بسهولة عبر Brute Force.
- **عدم انتهاء صلاحية**: التوكن لسه صالح بعد يوم.
- **تسريب عبر Referer**: الـ Referer Header بيحتوي على `https://target.com/reset?token=abc123`.

لو محتاج مساعدة في إعداد الأدوات (زي Burp Suite أو wfuzz) أو عايز سكربتات إضافية لأتمتة الاختبار، قولي!



# استغلال خاصية Password Reset Token Leakage

دليل خطوة بخطوة لاختبار ثغرة تسريب رمز إعادة تعيين كلمة المرور (Password Reset Token) في موقع إلكتروني. كل محاولة تتضمن وصفًا وتعليمات الاختبار وملخص الأوامر/الأدوات.

---

## المحاولة الأولى: تسريب التوكن في ردود السيرفر
**الوصف**: اختبار إذا كان الموقع يكشف رمز إعادة التعيين في رد السيرفر عند طلب إعادة تعيين كلمة المرور.
- **الخطوات**:
  1. انتقل إلى `https://target.com/forgot-password`.
  2. أدخل إيميل صالح (مثل `test@example.com`) وأرسل الطلب.
  3. اعترض الطلب باستخدام Burp Suite وافحص الـ Response.
  4. ابحث عن التوكن أو رابط إعادة التعيين في الـ Response.
- **الأدوات/الأوامر**:
  - Burp Suite: اعترض الطلب وافحص الـ Response.
  - cURL:
    ```bash
    curl -X POST -d "email=test@example.com" https://target.com/forgot-password
    ```
- **الملخص**:
  - cURL: `curl -X POST -d "email=test@example.com" https://target.com/forgot-password`
  - Burp Suite: ابحث عن `token` أو رابط في الـ Response.

---

## المحاولة الثانية: توكن قابل للتخمين
**الوصف**: اختبار إذا كان التوكن قصيرًا أو متوقعًا بحيث يمكن تخمينه.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور لإيميل تحت سيطرتك.
  2. افحص التوكن في رابط الإيميل (مثل `https://target.com/reset?token=abc123`).
  3. حلل طول التوكن ونمطه.
  4. اطلب توكنات متعددة وقارنها.
- **الأدوات/الأوامر**:
  - cURL:
    ```bash
    curl -X POST -d "email=youremail@example.com" https://target.com/forgot-password
    ```
  - Python:
    ```python
    import requests
    url = "https://target.com/forgot-password"
    emails = ["youremail@example.com"]
    for email in emails:
        response = requests.post(url, data={"email": email})
        print(f"Email: {email}, Response: {response.text[:100]}")
    ```
  - Burp Suite Sequencer: تحليل عشوائية التوكنات.
- **الملخص**:
  - cURL: `curl -X POST -d "email=youremail@example.com" https://target.com/forgot-password`
  - Python: `python request_tokens.py`

---

## المحاولة الثالثة: إعادة استخدام التوكن أو عدم انتهاء صلاحيته
**الوصف**: اختبار إذا كان التوكن يتكرر أو يظل صالحًا لفترة طويلة.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور واستلم التوكن.
  2. جرب التوكن بعد فترات زمنية (ساعة، يوم).
  3. اطلب توكن جديد بنفس الإيميل وتحقق إذا كان التوكن القديم لسه صالح.
- **الأدوات/الأوامر**:
  - متصفح: جرب الرابط يدويًا.
  - cURL:
    ```bash
    curl https://target.com/reset?token=abc123
    ```
  - Burp Suite Repeater: كرر طلب التوكن.
- **الملخص**:
  - cURL: `curl https://target.com/reset?token=abc123`

---

## المحاولة الرابعة: التوكن عبر استبدال الإيميل
**الوصف**: اختبار إذا كان التوكن يعمل مع إيميلات أخرى غير المقصودة.
- **الخطوات**:
  1. اطلب إعادة تعيين كلمة المرور واستلم التوكن.
  2. عدّل الإيميل في الرابط (مثل `https://target.com/reset?token=abc123&email=victim@example.com`).
  3. جرب الرابط المعدل.
- **الأدوات/الأوامر**:
  - متصفح: عدّل الرابط يدويًا.
  - cURL:
    ```bash
    curl https://target.com/reset?token=abc123&email=victim@example.com
    ```
  - Burp Suite: عدّل حقل `email`.
- **الملخص**:
  - cURL: `curl https://target.com/reset?token=abc123&email=victim@example.com`

---

## المحاولة الخامسة: تسريب التوكن عبر Referer Header
**الوصف**: اختبار إذا كان التوكن يتسرّب عبر الـ Referer Header عند النقر على روابط خارجية.
- **الخطوات**:
  1. افتح رابط إعادة التعيين.
  2. اضغط على رابط خارجي (مثل "Contact Us").
  3. اعترض الطلب وافحص الـ Referer Header.
- **الأدوات/الأوامر**:
  - Burp Suite: افحص الـ Referer Header.
  - cURL:
    ```bash
    curl -I -e "https://target.com/reset?token=abc123" https://external.com
    ```
- **الملخص**:
  - cURL: `curl -I -e "https://target.com/reset?token=abc123" https://external.com`

---

## المحاولة السادسة: Brute Force على التوكن
**الوصف**: اختبار إذا كان التوكن ضعيفًا لدرجة يمكن تخمينه بسهولة.
- **الخطوات**:
  1. حلل التوكن (طول، تنسيق).
  2. استخدم أداة لتجربة توكنات مختلفة.
  3. راقب الردود وقيود المحاولات.
- **الأدوات/الأوامر**:
  - wfuzz:
    ```bash
    wfuzz -c -z range,000000-999999 --hc 404 https://target.com/reset?token=FUZZ
    ```
  - cURL:
    ```bash
    curl https://target.com/reset?token=000001
    ```
  - Burp Suite Intruder: استخدم قائمة توكنات.
- **الملخص**:
  - wfuzz: `wfuzz -c -z range,000000-999999 --hc 404 https://target.com/reset?token=FUZZ`

---

## المحاولة السابعة: سوء إعداد التوكن عبر Session أو Cookies
**الوصف**: اختبار إذا كان التوكن يُخزن في Cookies أو Session بطريقة غير آمنة.
- **الخطوات**:
  1. افتح رابط التوكن وافحص الـ Cookies.
  2. تحقق إذا كان التوكن موجود في الـ Cookies.
  3. جرب التوكن مع Session مختلف.
- **الأدوات/الأوامر**:
  - DevTools: افحص الـ Cookies.
  - cURL:
    ```bash
    curl -b "session=abc123" https://target.com/reset?token=abc123
    ```
  - Burp Suite: عدّل الـ Cookies.
- **الملخص**:
  - cURL: `curl -b "session=abc123" https://target.com/reset?token=abc123`

---

